REPORT  zmm_po_status_new MESSAGE-ID zmbol.

TYPE-POOLS: slis.

TABLES: ekko, ekpo, eket, ekpa, ekes, ekki, konv, t024, lfa1,vbup,
        mara, mvke, t001w, t683s, marc, ztbrand, ztbrgrp, ztseasn,
        zroycodes, ztfabrn, t163i, t163y,zdirshpval,cdhdr.

*ALV data declarations
DATA : i_fieldcatalog TYPE slis_t_fieldcat_alv WITH HEADER LINE,
       wa_layout      TYPE slis_layout_alv,
       v_repid        LIKE sy-repid.
DATA : wa_grid_set    TYPE lvc_s_glay.
DATA : i_sortcat TYPE slis_sortinfo_alv OCCURS 1,
       wa_sort   LIKE LINE OF i_sortcat.

DATA : v_repname      LIKE sy-repid.
DATA : v_x_variant    LIKE disvariant.
DATA : v_exit(1)      TYPE c.
DATA : v_save(1)      TYPE c.
DATA : v_variant      LIKE disvariant.
DATA : v_var      TYPE char20.                        "Insert CH-2451-ECDK926220-27-Apr-2023

TYPES: BEGIN OF t_data,
         ebeln          LIKE ekko-ebeln,           "Po No.
         ebelp          LIKE ekpo-ebelp,           "Line number
         matnr          LIKE ekpo-matnr,           "Material
         j_3asize       LIKE eket-j_3asize,        "Material Size
         eindt          LIKE eket-eindt,           "Due Date
         etenr          LIKE eket-etenr,           "Delivery Schedule Line Counter
         werks          LIKE ekpo-werks,           "Plant
         ekunnr         LIKE ekpo-kunnr,           "Customer Number
         emlif          LIKE ekpo-emlif,
         lblkz          LIKE ekpo-lblkz,
         knttx          LIKE t163i-knttx,
         ptext          LIKE t163y-ptext,
         zterm          LIKE ekko-zterm,
         ekgrp          LIKE ekko-ekgrp,           "Purch. Group
         eknam          LIKE t024-eknam,           "Purch. Group name
         lifnr          LIKE ekko-lifnr,           "Vendor Code
         ven_nam        LIKE lfa1-name1,           "Vendor Name
         lifn2          LIKE ekpa-lifn2,           "Goods Supplier Code
         sup_nam        LIKE lfa1-name1,           "Goods Supplier Name
         land1          LIKE lfa1-land1,           "Country of origin (GS Partner)
         zzxportdat     LIKE ekpo-zzxportdat,    "Ship Date
         zzkunnr        LIKE ekpo-zzkunnr,         "Customer PTO SO account code
         pto_nam        LIKE kna1-name1,           "Ref. Number PTO So account Name
         bstnk          LIKE vbak-bstnk,           "Cust PO #
         zzvgbel        LIKE ekpo-zzvgbel,         "Order No.
* Begin of Addition For CH-2237 315873 Add SO PO type in Material PO report.
         bsark          LIKE vbak-bsark,           "SO PO TYPE
* End of Addition For CH-2237 315873 Add SO PO type in Material PO report.
         lgort          LIKE ekpo-lgort,           "Ship-to
         j_4kscat       LIKE eket-j_4kscat,
         lbl(3)         TYPE c,                    "(EKET-J_4KSCAT)Label
         maktx          LIKE makt-maktx,           "Material Name
         normt          LIKE mara-normt,           "Color Description
         spart          LIKE mara-spart,    "Insert ECDK927161-CH-2948-14-Nov-2023
         kposn          TYPE konv-kposn,          "line item "Add Nilakshi_09/11/09
         netpr          TYPE ekpo-netpr,          "FOB price  "Add Nilakshi_09/11/09
         qty_book       LIKE eket-menge,           "Tot Qty Booked
         amnt_book      LIKE ekpo-effwr,          "Tot Amt Booked
         j_3aelikz      LIKE eket-j_3aelikz,
         elikz          LIKE ekpo-elikz,
         meins          LIKE ekpo-meins,          "Unit of Measure LJ20090403
         qty_cnc        LIKE eket-menge,   "Total Canceled(qty booked - qty rcv)
         qty_intra      LIKE ekes-menge,   "Tot Qty In tran
         amnt_intra     LIKE konv-kwert,  "Tot Amt InTran(KWERT/Qty Bkd*Qty intra)
         qty_rcv        LIKE eket-wemng,   "Tot Qty  Rcv
         amnt_rcv       LIKE konv-kwert,   "Tot Amt Rcv (sum KWERT/Qty Booked*QtyRcv)
         qty_wip        LIKE eket-menge,   "WIP Bal (Tot Qty Booked-Tot Qty  Rcv)
         amnt_wip       LIKE konv-kwert,   "WIP Amt (KWERT/Tot Qty Booked*TotQtyWIP)
         qty_var        LIKE eket-menge,   "Var PO vs Shipped WIP Bal-Qty In tran
         loekz          LIKE ekpo-loekz,
         knumv          LIKE ekko-knumv,
         zcmsno         LIKE ekko-zcmsno,
         ihrez          TYPE ekko-ihrez,
         evers          LIKE ekpo-evers,        "Ship Mode/Shipping Instructions.
         evtxt          LIKE t027b-evtxt,       "Ship Mode Text
         zzportentry    LIKE ekpo-zzportentry,  "Port of Entry.
         zzportentry2   LIKE ekko-zzportentry,  "Port of Entry from EKKO LJ24AUG2010.
         stprs          LIKE mbew-stprs,        "Standard Cost.
         vdatu          LIKE vbak-vdatu,        "Customer Due Date.
         zzeindt        LIKE ekko-zzeindt,      "Arrival Date.
         zzolla         LIKE ekpo-zzolla,       "Port of Exit.
         zzolla2        LIKE ekko-zzolla,       "Port of Exit from EKKO LJ24AUG2010
         gueen          LIKE vbak-gueen,     "Customer SO Cancel Date
         prctr          LIKE marc-prctr,        "Profit Center
         volum          LIKE mara-volum,        "Volume
         wip_vol        LIKE eket-menge,        "Total WIP Volume
         tot_ctn        LIKE eket-menge,        " total no of cartons   gajaba 20090819
         unsez          LIKE ekko-unsez,        "Factory No
         aedat          LIKE ekko-aedat,        "Purchase Order Creation Date
         ernam          LIKE ekko-ernam,        "Purchase Order Created By
* MahendraP added to get ordering address and invoicing party.
         ord_lifn2      LIKE ekpa-lifn2,           "Ordering Address Code
         ord_name1      LIKE lfa1-name1,           "Ordering Address Name
         pi_lifn2       LIKE ekpa-lifn2,           "Invoicing Partty Code
         pi_name1       LIKE lfa1-name1,           "Invoicing Partty Name
* End of modification.
* chandimaw - 24/05/2012 - freight forwarder
         cr_lifn2       LIKE ekpa-lifn2,           "Freight Forwarder Code
         cr_name1       LIKE lfa1-name1,           "Freight Forwarder Name
         zkunnr         LIKE mara-zzkunnr,      "Customer Number
         zpre_pack_qty  LIKE mara-zpre_pack_qty, "Pre-Pack Quantity
         wrkst          LIKE mara-wrkst,       "PLM Product Number
         bismt          LIKE mara-bismt,       "Style Number
         inco1          LIKE ekko-inco1,        "Incoterms (Part 1)
         submi          LIKE ekko-submi,        "Collective Number
         cost_inco1     LIKE ekpo-inco1,        "Costing inco term - chandimaw - 13/07/2012 - add costing inco term to the report
         zzofferdat     LIKE ekpo-zzofferdat,   "Original Delivery date
         zzexfact       LIKE ekpo-zzexfact,     "Original Ex factory date
         j_3aexfcm      LIKE ekpo-j_3aexfcm,    "AFS Manual Ex Factory Date
         pstyp          LIKE ekpo-pstyp,        "Item Category <-- PJDK925334:24/05/2012:MW
         knttp          LIKE ekpo-knttp,        "Account Assignment Category <-- PJDK925334:24/05/2012:MW
         mvgr1          LIKE mvke-mvgr1,        "Sub Profit Center
         mvgr1_desc     TYPE tvm1t-bezei,       "SPC Description "attSam added on 31.10.2011
         mtpos_mara     LIKE mara-mtpos_mara,   "General item category group
         kbetr          LIKE konv-kbetr,        "Sales Price
         qty_book_pc    LIKE eket-menge,
         qty_cnc_pc     LIKE eket-menge,
         qty_intra_pc   LIKE eket-menge,
         qty_rcv_pc     LIKE eket-menge,
         qty_wip_pc     LIKE eket-menge,
         qty_var_pc     LIKE eket-menge,             " Var. Po Vs shiped
         zznrfdesc      TYPE mara-zznrfdesc,         "NRF Size Description
         zzhanger       TYPE mara-zzhanger,          "attSam added on 31.10.2011
         zzhangerdesc   TYPE zhanger-zzhangerdesc,   "attSam added on 31.10.2011
         j_3apqty       TYPE /afs/mvke-j_3apqty,     "AFS Pack Quantity
         zzolla_desc    TYPE vtadd01t-bezei,         "Description
         zport_desc     TYPE vtadd02t-bezei,         "Port of entry name
         bednr          LIKE ekpo-bednr,             " Added by mahendrap on 2011-03-18.
         afnam          LIKE ekpo-afnam,             " Requisitioner                                         "Added by Sri Ram
         mstae          LIKE  mara-mstae,            "asangad 04112011
         mtstb          LIKE  t141t-mtstb,            "asangad 11112011
         j_3akord1      LIKE  j_3apgen-j_3akord1,
         j_3akord2      LIKE  j_3apgen-j_3akord2,
         msrp           TYPE  konv-kbetr, " J_3AVAST-J_3AFIELD1 - we need it in a currency field - YasanthaJ 17/02/2011 - Ver 17
         waers          LIKE  ekko-waers,    " YasanthaJ 17/02/2011 - Ver 17
         j_3anetp       LIKE  eket-j_3anetp, " YasanthaJ 17/02/2011 - Ver 17
*{  INSERT  PJDK926501  14.08.2012  MP
         menge          TYPE ekpo-menge,
         mtart          TYPE mara-mtart,
         comp_matnr     TYPE zpocomp-matnr,
         comp_j_3asize  TYPE zpocomp-j_3asize,
         comp_netpr     TYPE zpocomp-netpr,
         comp_qty       TYPE zpocomp-menge,
         comp_val       TYPE zpocomp-netpr,
         ccasin         TYPE j_3acustf1,      "Component Chile ASIN
         zzfrsl         TYPE ekko-zzfrsl,     " First Sales Flag
         konwa          TYPE konp-konwa,        "Sales Price Currency
*}  INSERT
         insmk          TYPE ekpo-insmk,         "PJDK928062 26.11.2012  MPf
         ddtext         TYPE dd07t-ddtext,      "PJDK928062 26.11.2012  MP
*{  INSERT  PJDK930237  03.05.2013  NR
         xblnr          TYPE ekes-xblnr,
         erdat          TYPE ekes-erdat,
         eindt_s        TYPE ekes-eindt,
         menge_s        TYPE ekes-menge,
*}  INSERT
         zzngendr       TYPE mara-zzngendr,
         zzngendrtxt    TYPE ztgendr-zzngendrtxt,
         zznaggrp       TYPE mara-zznaggrp,
         zznaggrptxt    TYPE ztaggrp-zznaggrptxt,
         zzngszgp       TYPE mara-zzngszgp,
         zzngszgptxt    TYPE ztgszgp-zzngszgptxt,
         zznseasn       TYPE mara-zznseasn,
         zznseasntxt    TYPE ztseasn-zznseasntxt,
         zyear          TYPE ztseasn-zyear,
         zzsnyrtxt      TYPE ztseasn-zzsnyrtxt,
         zznprdct       TYPE mara-zznprdct,
         zznprdcttxt    TYPE ztprdct-zznprdcttxt,
         zznprdsc       TYPE mara-zznprdsc,
         zznprdsctxt    TYPE ztprdsc-zznprdsctxt,
         zznfabct       TYPE mara-zznfabct,
         zznfabcttxt    TYPE ztfabct-zznfabcttxt,
         zznfabrn       TYPE mara-zznfabrn,        "PIYUSH PAYASI -9999011257
         zznfabrntxt    TYPE ztfabrn-zznfabrntxt,  "PIYUSH PAYASI -9999011257
         zznrpmnt       TYPE mara-zznrpmnt,        "SRIRAM -9999012212
         zzncoltp       TYPE mara-zzncoltp,
         zzncoltptxt    TYPE ztcoltp-zzncoltptxt,
         zzncuftp       TYPE mara-zzncuftp,
         zzncuftptxt    TYPE ztcuftp-zzncuftptxt,
         zznfapyr       TYPE mara-zznfapyr,
         zznfapyrtxt    TYPE ztfapyr-zznfapyrtxt,
         zznsilht       TYPE mara-zznsilht,
         zznsilhttxt    TYPE ztsilht-zznsilhttxt,
         zzncolln       TYPE mara-zzncolln,
         zzncollntxt    TYPE ztcolln-zzncollntxt,
         zznbrand       TYPE mara-zznbrand,
         zznbrandtxt    TYPE ztbrand-zznbrandtxt,
         zznbrgrp       TYPE ztbrgrp-zznbrgrp,
         zznbrgrptxt    TYPE ztbrgrp-zznbrgrptxt,
         zznbrgtp       TYPE ztbrgtp-zznbrgtp,
         zznbrgtptxt    TYPE ztbrgtp-zznbrgtptxt,
         zprdha         TYPE zroyalty-zprdha,
         zzlicdesc      TYPE zroycodes-zzlicdesc,
         zzprdesc       TYPE zroycodes-zzprdesc,
         zznstmth       TYPE mara-zznstmth,
         zznevent       TYPE mara-zznevent,
         zzneventtxt    TYPE ztevent-zzneventtxt,
         custname       TYPE kna1-name1,
         zzdirort       TYPE ekpo-zzdirort,
         mwaer          TYPE t000-mwaer,
         reswk          TYPE ekko-reswk, "Supplying (Issuing) Plant in Stock Transport Order
         kunnr          TYPE ekpv-kunnr, "Customer Number
         vstel          TYPE ekpv-vstel, "Shipping Point/Receiving Point
         ladgr          TYPE ekpv-ladgr, "Loading Group
         reslo          TYPE ekpo-reslo, "Issuing Storage Location for Stock Transport Order
         bsgru          TYPE ekpo-bsgru, " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
         bezei          TYPE bezei40, " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
         zzlatecd       TYPE ekpo-zzlatecd,
         zzlatecd1      TYPE ekko-zzlatecd,
         zlatedesc      TYPE zlatecode-zlatedesc,
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
         zexempt        TYPE zexempt,
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967

* BCBG additional fields for Wafai
         ean11          TYPE mean-ean11,
         col_desc_fr    TYPE zzdesc,
         msrpcad        TYPE j_3avast-j_3afield1,
         msrp_compat    TYPE j_3avast-j_3afield1,
         herkl          TYPE mara-herkl,
         zzhanger_po    TYPE ekpo-zzhanger,
* END BCBG
* BOC by DGHOSAL on 4/20/2018 for BCBG
         j_3acol        TYPE j_3acol,
         vkorg          TYPE mvke-vkorg,
* EOC by DGHOSAL on 4/20/2018 for BCBG
         zzfcrdat       TYPE ekpo-zzfcrdat,
         zzonbdat       TYPE ekpo-zzonbdat,
         ibd_date       TYPE bbein,
* BOC by DGHOSAL on 5/21/2018
         ebtyp          TYPE ebtyp, " Confirmation Category
         ebtxt          TYPE ebtxt, " Confirmation Category: Description
         knref          TYPE knref, " Ship-to Partner Description
         kname_sh       TYPE name1, " Ship to name
         dirshp         TYPE zdirlbl, " Direct Ship Label
         pasin          TYPE j_3acustf1, "Parent ASIN
         casin          TYPE j_3acustf1, "Child ASIN
* EOC by DGHOSAL on 5/21/2018
* BOC by PFERNANDO on 7/23/2018
         tot_po_fob     TYPE konv-kwert,
         tot_po_std     TYPE konv-kwert,
* EOC by PFERNANDO on 7/23/2018
* Begin of changes - ECDK915177 - Pio Fernando
         msrp_01        TYPE kbetr,
         msrp_02        TYPE kbetr,
         msrp_03        TYPE kbetr,
         msrp_04        TYPE kbetr,
         msrp_05        TYPE kbetr,
         msrp_06        TYPE kbetr,
         msrp_07        TYPE kbetr,
         msrp_08        TYPE kbetr,
         msrp_09        TYPE kbetr,
         msrp_10        TYPE kbetr,
* End of changes - ECDK915177 - Pio Fernando

         frgke          TYPE ekko-frgke,    "" AP 12/06/2020
         frgzu          TYPE ekko-frgzu,    " + SQ 9/28/2020
         redat          TYPE ekpo-aedat,    " + SQ 9/28/2020 - Latest Release Date
         eaedat         TYPE ekpo-aedat, " +ECDK920591 by SQADIR on 6/12/2020
* Begin of changes - ECDK922248  Ruchira Sampath
         eindt_pb       TYPE ekes-eindt,  " PB - Pre-booking date
         eindt_ab       TYPE ekes-eindt,  " AB - Confirmed booking date
         erdat_pb       TYPE ekes-erdat,  " PB Created Date
         erdat_ab       TYPE ekes-erdat,  " AB Created Date
         xblnr_pb       TYPE ekes-xblnr,  " PB Reference
         xblnr_ab       TYPE ekes-xblnr,  " AB Reference
         xblnr_la       TYPE ekes-xblnr,  " LA Reference
* End of changes - ECDK922248 Ruchira Sampath

* Begin of changes - ECDK922316  Ruchira Sampath
         zzhts1         TYPE mara-zzhts1,
         zzhts1desc     TYPE mara-zzhts1desc,
* End of changes - ECDK922316  Ruchira Sampath

* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
         zznopdcl       TYPE mara-zznopdcl,
         zznopdcltxt    TYPE ztopdcl-zznopdcltxt,
* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

* BoC : CH-1778 : Ruchira : 05/09/2022 Add Component UPC
         comp_ean11     TYPE mean-ean11,
* EoC : CH-1778 : Ruchira : 05/09/2022 Add Component UPC

*Add AP. 03/02/2022,ECDK923295
**         docnum        TYPE  edids-docnum,
**         status        TYPE  edids-status,
**         statxt        TYPE  edids-statxt,
**         credat        TYPE  edids-credat,
*End Add


         zznactvt       TYPE mara-zznactvt,
         zznactvtxt     TYPE ztactvt-zznactvtxt,
         zzntheme       TYPE mara-zzntheme,
         zznthemetxt    TYPE zttheme-zznthemetxt,
         zznbkpkd       TYPE mara-zznbkpkd,
         zznbkpkdtxt    TYPE ztbkpkd-zznbkpkdtxt,
         zznbdftn       TYPE mara-zznbdftn,
         zznbdftntxt    TYPE ztbdftn-zznbdftntxt,
         zznbusun       TYPE mara-zznbusun,
         ztbusuntxt     TYPE ztbusun-ztbusuntxt,
         zznchorg       TYPE mara-zznchorg,
         zznchorgtxt    TYPE ztchorg-zznchorgtxt,
         zznchar2       TYPE mara-zznchar2,
         zznchar2txt    TYPE ztchar2-zznchar2txt,
         zznclass       TYPE mara-zznclass,
         zznclasstxt    TYPE ztclass-zznclasstxt,
         zzndenft       TYPE mara-zzndenft,
         zzndenfttxt    TYPE ztdenft-zzndenfttxt,
         zzndepmt       TYPE mara-zzndepmt,
         zzndepmtxt     TYPE ztdepmt-zzndepmtxt,
         zznfabat       TYPE mara-zznfabat,
         zznfabatxt     TYPE ztfabat-zznfabatxt,
         zznfabnm       TYPE mara-zznfabnm,
         zznfabnmtxt    TYPE ztfabnm-zznfabnmtxt,
         zznfabst       TYPE mara-zznfabst,
         zznfabstxt     TYPE ztfabst-zznfabstxt,
         zznftacc       TYPE mara-zznftacc,
         zznftacctxt    TYPE ztftacc-zznftacctxt,
         zznhwtrt       TYPE mara-zznhwtrt,
         zznhwtrttxt    TYPE zthwtrt-zznhwtrttxt,
         zznhemfn       TYPE mara-zznhemfn,
         zznhemfntxt    TYPE zthemfn-zznhemfntxt,
         zznlengt       TYPE mara-zznlengt,
         zznlengtxt     TYPE ztlengt-zznlengtxt,
         zznmettp       TYPE mara-zznmettp,
         zznmettptxt    TYPE ztmettp-zznmettptxt,
         zznpatrn       TYPE mara-zznpatrn,
         zznpatrntxt    TYPE ztpatrn-zznpatrntxt,
         zznpresn       TYPE mara-zznpresn,
         zznpresntxt    TYPE ztpresn-zznpresntxt,
         zznprcpt       TYPE mara-zznprcpt,
         zznprcptxt     TYPE ztprcpt-zznprcptxt,
         zznprdgr       TYPE mara-zznprdgr,
         zznprdgrtxt    TYPE ztprdgr-zznprdgrtxt,
         zznstone       TYPE mara-zznstone,
         zznstonetxt    TYPE ztstone-zznstonetxt,
         zznsclas       TYPE mara-zznsclas,
         zznsclastxt    TYPE ztsclas-zznsclastxt,
         zznwaist       TYPE mara-zznwaist,
         zznwaistxt     TYPE ztwaist-zznwaistxt,
         zznwashy       TYPE mara-zznwashy,
         zznwashytxt    TYPE ztwashy-zznwashytxt,
         zznwashs       TYPE mara-zznwashs,
         zznwashstxt    TYPE ztwashs-zznwashstxt,
         zznwasht       TYPE mara-zznwasht,
         zznwashtxt     TYPE ztwasht-zznwashtxt,
         zznlgopn       TYPE mara-zznlgopn,
         zznlgopntxt    TYPE ztlgopn-zznlgopntxt,
         zznchars       TYPE mara-zznchars,
         zzncharstxt    TYPE ztchars-zzncharstxt,
         zzconstype     TYPE mara-zzconstype,
         zzconstypedesc TYPE zconstype-zzconstypedesc,
*ZZNFABRN TYPE mara-ZZNFABRN,
*ZZNFABRNTXT TYPE ZTFABRN-ZZNFABRNTXT,
*ZZNFAPYR TYPE mara-ZZNFAPYR,
*ZZNFAPYRTXT TYPE ZTFAPYR-ZZNFAPYRTXT,
         zzhlht         TYPE mara-zzhlht,
         zzhlhtdesc     TYPE zhlht-zzhlhtdesc,
*ZZNSTMTH TYPE mara-ZZNSTMTH,
*ZZNSTMTHTXT TYPE ZTSTMTH-ZZNSTMTHTXT,
         zznitplt       TYPE mara-zznitplt,
         zznitplttxt    TYPE ztitplt-zznitplttxt,
         zznnctyp       TYPE mara-zznnctyp,
         zznnctyptxt    TYPE ztnctyp-zznnctyptxt,
         zznsetct       TYPE mara-zznsetct,
         zznsetcttxt    TYPE ztsetct-zznsetcttxt,
*ZZNRPMNT TYPE mara-ZZNRPMNT,
*ZZNRPMNTTXT TYPE ZTRPMNT-ZZNRPMNTTXT,
         zzshaftht      TYPE mara-zzshaftht,
         zzshafthtdesc  TYPE zshaftht-zzshafthtdesc,
         zznslvtp       TYPE mara-zznslvtp,
         zznslvtptxt    TYPE ztslvtp-zznslvtptxt,
         zzstdet        TYPE mara-zzstdet,
         zzstdetdesc    TYPE zstdet-zzstdetdesc,
         zznstfsh       TYPE mara-zznstfsh,
         zznstfshtxt    TYPE ztstfsh-zznstfshtxt,
         zzinvstat      TYPE mara-zzinvstat,
         zzinvdesc      TYPE zinvstatus-zzinvdesc,

*Add AP , 10/11/2022
         offer_date     TYPE zofferdate,
*End Add
         zzgohflag      TYPE ekpo-zzgohflag, " Added for CH-2221 315873 GOH Flag
         goh_text       TYPE char3,          " Added for CH-2221 315873 GOH text

*Add AP 31/03/2023
**         ZZLATECD       TYPE ekpo-zzlatecd,  " Add AP 31/03/2023
         vtext          TYPE tspat-vtext,        "Insert ECDK927161-CH-2948-14-Nov-2023

*End Add
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button.
         sonet          TYPE vbap-netpr,    "SO Net Price
         soval          TYPE vbap-netpr,    "SO Value
         delno          TYPE ekes-vbeln,    "Delivery No
         conid          TYPE ekes-xblnr,    "Container ID
         cusst          TYPE vbak-vdatu,    "Customer Start Date
         cusca          TYPE vbap-j_3acada, "Customer Cancel Date
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
         fob_std        TYPE ck_twt,          "FOB XB00 (Std.)
         freight_po     TYPE ck_twt,          "Freight XR01( PO)
         freight_std    TYPE ck_twt,          "Freight XR01( Std.)
         markup_po      TYPE ck_twt,          "Mark-Up,XCOM(PO)
         markup_std     TYPE ck_twt,          "Mark-Up,XCOM(Std.)
         markup_po_per  TYPE konv-kbetr,      "Mark-Up, XCOM (PO)%   Added By SriRam  11/06/2015
         markup_std_per TYPE konv-kbetr,      " Mar-Up, XCOM(Std.)% - Added By SriRam  11/06/2015
         duty_po        TYPE ck_twt,          "Duty, XDTY (PO)
         duty_std       TYPE ck_twt,          "Duty, XDTY (Std.)
         duty_var_svp   TYPE ck_twt,          "Duty Var. (Std vs PO)
         misc_po        TYPE ck_twt,          "Miscellaneous, XMSC (PO)
         misc_std       TYPE ck_twt,          "Miscellaneous, XMSC (Std.)
         others_po      TYPE ck_twt,          "Others, XOTH (PO)
         others_std     TYPE ck_twt,          "Others, XOTH (Std.)
         drayage_po     TYPE ck_twt,          "Drayage XDRY (PO)
         drayage_std    TYPE ck_twt,          "Drayage XDRY (Std.)
         tot_po_prc     TYPE ck_twt,          "Total PO Price per UOM
         fob_po         TYPE ck_twt,          "FOB XB00 (PO)
         tot_stdprc     TYPE ck_twt,          "Total Standard Price
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
       END OF t_data,

*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
*Note this should be the same structure as in final output table of report zmm_cost_variance.
       BEGIN OF t_final,
         werks           TYPE werks_d,           "Plant
         ekgrp           TYPE ekgrp,           "Purchasing Group
         eknam           TYPE eknam,           "Purchasing Group Name
         eindt           TYPE eindt,           "Delivery Date
         ebeln           TYPE ebeln,           "PO No.
         ebelp           TYPE ebelp,           "PO Line number
         matnr           TYPE matnr,           "Material Number           "attSam - added on 03 June 2012
         maktx           TYPE maktx,           "Material Description      "attSam - added on 03 June 2012
         ekunnr          LIKE ekpo-kunnr,           "Customer Number
         emlif           LIKE ekpo-emlif,
         lblkz           LIKE ekpo-lblkz,
         knttx           LIKE t163i-knttx,
         ptext           LIKE t163y-ptext,
         zterm           LIKE ekko-zterm,
         pstyp           LIKE ekpo-pstyp,        "Item Category <-- PJDK925334:24/05/2012:MW
         knttp           LIKE ekpo-knttp,        "Account Assignment Category <-- PJDK925334:24/05/2012:MW
         zznbrand        TYPE zznbrand,        "Brand
         zznbrandtxt     TYPE zznbrandtxt,     "Brand Description
         zznseasn        TYPE zznseasn,        "Season
         lifnr           TYPE lifnr,           "Vendor Code
         ven_nam         TYPE name1,           "Vendor Name
         llief           TYPE llief,           "Goods Supplier Code
         sup_name        TYPE name1,           "Goods Supplier Name
         land1           TYPE land1,           "Country of Origin
         tot_po_qty      TYPE menge_d,         "Tot PO Qty
         tot_cancel      TYPE menge_d,         "Total Canceled
         tot_rcv_qty     TYPE menge_d,         "Tot Qty  Rcv
         uom             TYPE meins,           "UOM
         elikz           TYPE elikz,
         ppk_qty         TYPE zpre_pack_qty,   "PPK Qty
         inco1           TYPE inco1,           "Incoterms
         fob_std         TYPE ck_twt,          "FOB XB00 (Std.)
         tool_cost       TYPE ck_twt,          "Tooling Cost
         tool_cost_incl  TYPE ck_twt,          "FOB Incl. Tooling Cost
         freight_std     TYPE ck_twt,          "Freight XR01( Std.)
         markup_std      TYPE ck_twt,          "Mark-Up,XCOM(Std.)
         markup_std_per  TYPE konv-kbetr,      " Mar-Up, XCOM(Std.)% - Added By SriRam  11/06/2015
         duty_std        TYPE ck_twt,          "Duty, XDTY (Std.)
         misc_std        TYPE ck_twt,          "Miscellaneous, XMSC (Std.)
         others_std      TYPE ck_twt,          "Others, XOTH (Std.)
         drayage_std     TYPE ck_twt,          "Drayage XDRY (Std.)                      "Lokesh - added on 14 April 2014
         tot_stdprc      TYPE ck_twt,          "Total Standard Price
         std_curr        TYPE waers,           "Std.Currency
         fob_po          TYPE ck_twt,          "FOB XB00 (PO)
         freight_po      TYPE ck_twt,          "Freight XR01( PO)
         markup_po       TYPE ck_twt,          "Mark-Up,XCOM(PO)
         markup_po_per   TYPE konv-kbetr,      "Mark-Up, XCOM (PO)%   Added By SriRam  11/06/2015
         duty_po         TYPE ck_twt,          "Duty, XDTY (PO)
         misc_po         TYPE ck_twt,          "Miscellaneous, XMSC (PO)
         others_po       TYPE ck_twt,          "Others, XOTH (PO)
         drayage_po      TYPE ck_twt,          "Drayage XDRY (PO)                       "Lokesh - added on 14 April 2014
         tot_po_prc      TYPE ck_twt,          "Total PO Price per UOM
         po_curr         TYPE waers,           "PO Currency
         mwaer           TYPE t000-mwaer,      "Group Currency                        "TD
         fob_inv         TYPE ck_twt,          "FOB XB00 (Invoice)
         freight_inv     TYPE ck_twt,          "Freight XR01( Invoice)
         markup_inv      TYPE ck_twt,          "Mark-Up,XCOM(Invoice)
         markup_inv_per  TYPE konv-kbetr,      "Mark-Up,XCOM (Invoice)%  Added By SriRam  11/06/2015
         duty_inv        TYPE ck_twt,          "Duty, XDTY (Invoice)
         misc_inv        TYPE ck_twt,          "Miscellaneous, XMSC (Invoice)
         others_inv      TYPE ck_twt,          "Others, XOTH (Invoice)
         drayage_inv     TYPE ck_twt,          "Drayage XDRY (Invoice)                  "Lokesh - added on 14 April 2014
         tot_inv_prc     TYPE ck_twt,          "Total Invoice Price
         inv_curr        TYPE waers,           "Invoice Currency
         variance_svp    TYPE ck_twt,          "Variance (Std. vs PO)
         variance_svi    TYPE ck_twt,          "Variance (Std.vs Invoice)
         variance_pvi    TYPE ck_twt,          "Variance (PO vs Invoice)
         fob_var_svp     TYPE ck_twt,          "FOB Var. (Std vs PO)
         fre_var_svp     TYPE ck_twt,          "Freight Var.(Std vs PO)
         markup_var_svp  TYPE ck_twt,          "Mark-Up Var.(Std vs PO)
         duty_var_svp    TYPE ck_twt,          "Duty Var. (Std vs PO)
         misc_var_svp    TYPE ck_twt,          "Misc. Var (Std vs PO)
         othrs_var_svp   TYPE ck_twt,          "Others Var.(Std vs PO)
         drayage_var_svp TYPE ck_twt,         "Drayage Var. (Std vs PO)                "Lokesh - added on 14 April 2014
         fob_var_pvi     TYPE ck_twt,          "FOB Var. (PO vs Inv.)
         fre_var_pvi     TYPE ck_twt,          "Freight Var. (PO vs Inv.)
         markup_var_pvi  TYPE ck_twt,          "Mark-Up Var. (PO vs Inv.)
         duty_var_pvi    TYPE ck_twt,          "Duty Var.  (PO vs Inv.)
         misc_var_pvi    TYPE ck_twt,          "Misc. Var (PO vs Inv.)
         othrs_var_pvi   TYPE ck_twt,          "Others Var. (PO vs Inv.)
         drayage_var_pvi TYPE ck_twt,         "Drayage Var.(PO vs Inv.)               "Lokesh - added on 14 April 2014
         fob_var_svi     TYPE ck_twt,          "FOB Var. (Std. vs Inv.)
         fre_var_svi     TYPE ck_twt,          "Freight Var. (Std. vs Inv.)
         markup_var_svi  TYPE ck_twt,          "Mark-Up Var. (Std vs Inv.)
         duty_var_svi    TYPE ck_twt,          "Duty Var.(Std vs Inv.)
         misc_var_svi    TYPE ck_twt,          "Misc. Var (Std vs Inv.)
         othrs_var_svi   TYPE ck_twt,          "Others Var.(Std vs Inv.)
         drayage_var_svi TYPE ck_twt,         "Drayage Var.(Std vs Inv.)               "Lokesh - added on 14 April 2014
         exchng_rate_po  TYPE wkurs,           "Exchange Rate of PO
         exchng_rate_in  TYPE kursf,           "Exchange Rate on Invoice
         tot_stdprc_cc   TYPE ck_twt,          "Total Standard Price in currency value given in the selection screen  "+PJDK923359  16.02.2012  MP
         zzkunnr         TYPE mara-zzkunnr,
         name1           TYPE kna1-name1,
         zzdirort        TYPE ekpo-zzdirort,   "Direct ship type                      "TD
* Start FNt Change NF 01/18/2017
         reswk           TYPE ekko-reswk,              "Supplying Plant in Stock Transport Order
         kunnr           TYPE ekpv-kunnr,              "Customer
         vstel           TYPE ekpv-vstel,              "Shipping point
         ladgr           TYPE ekpv-ladgr,              "Loading Group
         reslo           TYPE ekpo-reslo,              "Issuing Storage Location for STO
* End FNt Change NF 01/18/2017
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
         zexempt         TYPE zexempt,
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
* BoC RUCHIRA : CH-1071 07/21/2021
         zzhts1          TYPE mara-zzhts1,
         zzhts1desc      TYPE mara-zzhts1desc,
* EoC RUCHIRA : CH-1071 07/21/2021

* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
         zznopdcl        TYPE mara-zznopdcl,
         zznopdcltxt     TYPE ztopdcl-zznopdcltxt,
* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

* BoC : Ruchira : CH-1919 : Add Profic Center
         prctr           TYPE marc-prctr,
         prctr_txt       TYPE cepct-ktext,
* EoC : Ruchira : CH-1919 : Add Profic Center
       END OF t_final.
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.


*-- Begin of changes - ECDK920847 - SQADIR
TYPES: BEGIN OF ty_cdpos,
         objectclas TYPE cdobjectcl,
         objectid   TYPE cdobjectv,
         fname      TYPE fieldname,
         changenr   TYPE cdchangenr,
       END OF ty_cdpos.

TYPES: BEGIN OF ty_cdhdr,
         objectid TYPE cdobjectv,
*         objectclas TYPE cdobjectcl,
*         changenr   TYPE cdchangenr,
         udate    TYPE cddatum,
       END OF ty_cdhdr.

TYPES: BEGIN OF ty_relpo,
         objectid TYPE cdobjectv,
         frgzu    TYPE ekko-frgzu,    " + SQ 9/28/2020
       END OF ty_relpo.


DATA: gt_cdpos    TYPE TABLE OF ty_cdpos,
      gs_cdpos    TYPE ty_cdpos,
      gt_cdhdr    TYPE TABLE OF ty_cdhdr,
      gs_cdhdr    TYPE ty_cdhdr,
      w_data_temp TYPE t_data,
      gt_relpo    TYPE TABLE OF ty_relpo, " List of released PO
      gs_relpo    TYPE ty_relpo.
*-- End of changes - ECDK920847 - SQADIR

DATA : wa_data        TYPE t_data,
       wa_data_t      TYPE t_data,
       i_data         TYPE STANDARD TABLE OF t_data,
       i_data_mat     TYPE STANDARD TABLE OF t_data,
       i_data_size    TYPE STANDARD TABLE OF t_data,
       i_data_size2   TYPE STANDARD TABLE OF t_data,
       i_data_t       TYPE STANDARD TABLE OF t_data,
       i_data_mat2    TYPE STANDARD TABLE OF t_data,
       i_data_sal     TYPE STANDARD TABLE OF t_data,
       i_data_null_so TYPE STANDARD TABLE OF t_data,
       i_data_temp    TYPE STANDARD TABLE OF t_data.


TYPES: BEGIN OF t_a905,
         vkorg TYPE a905-vkorg,
         matnr TYPE a905-matnr,
         knumh TYPE a905-knumh,
       END OF t_a905.

DATA:  "i_a905   TYPE HASHED TABLE OF t_a905 WITH UNIQUE KEY matnr,
  i_a905  TYPE TABLE OF t_a905,
  wa_a905 TYPE t_a905.

FIELD-SYMBOLS: <f_data> LIKE wa_data,
               <f_a905> TYPE t_a905.

* get purch gro (division)
TYPES: BEGIN OF t_t024,
         ekgrp LIKE t024-ekgrp,
         eknam LIKE t024-eknam,
       END OF t_t024.
DATA : wa_t024  TYPE t_t024,
       i_t024_h TYPE HASHED TABLE OF t_t024 WITH UNIQUE KEY ekgrp.

* get GS code
TYPES: BEGIN OF t_ekpa,
         ebeln LIKE ekpa-ebeln,
         parvw LIKE ekpa-parvw,
         lifn2 LIKE ekpa-lifn2,
       END OF t_ekpa.
DATA : wa_ekpa    TYPE t_ekpa,
       i_ekpa     TYPE STANDARD TABLE OF t_ekpa,
       i_ekpa_tmp TYPE STANDARD TABLE OF t_ekpa,
       i_ekpa_h   TYPE HASHED TABLE OF t_ekpa WITH UNIQUE KEY ebeln parvw.

* get vendor numbers
TYPES: BEGIN OF t_lifnr,
         lifnr LIKE lfa1-lifnr,
       END OF t_lifnr.
DATA : wa_lifnr TYPE t_lifnr,
       i_lifnr  TYPE STANDARD TABLE OF t_lifnr.

* get vendor name
TYPES: BEGIN OF t_lfa1,
         lifnr LIKE lfa1-lifnr,
         name1 LIKE lfa1-name1,
         land1 LIKE lfa1-land1,
       END OF t_lfa1.
DATA : wa_lfa1    TYPE t_lfa1,
       i_lfa1     TYPE STANDARD TABLE OF t_lfa1,
       i_lfa1_tmp TYPE STANDARD TABLE OF t_lfa1,
       i_lfa1_h   TYPE HASHED TABLE OF t_lfa1 WITH UNIQUE KEY lifnr.

* get so acc name
TYPES: BEGIN OF t_kna1,
         kunnr LIKE kna1-kunnr,
         name1 LIKE kna1-name1,
       END OF t_kna1.
DATA : wa_kna1  TYPE t_kna1,
       i_kna1_h TYPE HASHED TABLE OF t_kna1 WITH UNIQUE KEY kunnr.

* get material text
TYPES: BEGIN OF t_makt,
         matnr LIKE makt-matnr,
         maktx LIKE makt-maktx,
       END OF t_makt.
DATA : wa_makt    TYPE t_makt,
       i_makt     TYPE STANDARD TABLE OF t_makt,
       i_makt_tmp TYPE STANDARD TABLE OF t_makt,
       i_makt_h   TYPE HASHED TABLE OF t_makt WITH UNIQUE KEY matnr.

* get color des
TYPES: BEGIN OF t_mara,
         matnr LIKE mara-matnr,
         normt LIKE mara-normt,
         werks TYPE marc-werks,
* BOC by DGHOSAL on 5/21/2018
         vkorg TYPE mvke-vkorg,
* EOC by DGHOSAL on 5/21/2018
       END OF t_mara.
DATA : wa_mara    TYPE t_mara,
       i_mara     TYPE STANDARD TABLE OF t_mara,
       i_mara_tmp TYPE STANDARD TABLE OF t_mara,
       i_mara_h   TYPE HASHED TABLE OF t_mara WITH UNIQUE KEY matnr.

* get customer po
TYPES: BEGIN OF t_vbak,
         vbeln LIKE vbak-vbeln,
         bstnk LIKE vbak-bstnk,
         vdatu LIKE vbak-vdatu,
         gueen TYPE vbak-gueen,
* BOC by DGHOSAL on 5/21/2018
         vkorg TYPE vkorg,
         vtweg TYPE vtweg,
         spart TYPE spart,
* EOC by DGHOSAL on 5/21/2018
         bsark TYPE bsark, " Added for CH-2237 315873 Add SO PO type in Material PO report
       END OF t_vbak.
DATA : wa_vbak  TYPE t_vbak,
       i_vbak_h TYPE HASHED TABLE OF t_vbak WITH UNIQUE KEY vbeln.

* BOC by DGHOSAL on 5/21/2018
TYPES : BEGIN OF ty_knvp,
          kunnr TYPE kunnr,
          vkorg TYPE vkorg,
          vtweg TYPE vtweg,
          spart TYPE spart,
          kunn2 TYPE kunnr,
          knref TYPE knref,
        END OF ty_knvp.

DATA : gt_knvp TYPE STANDARD TABLE OF ty_knvp INITIAL SIZE 0,
       gs_knvp TYPE ty_knvp.

TYPES : BEGIN OF ty_edicon,
          kunnr  TYPE kunnr,
          vkorg  TYPE vkorg,
          vtweg  TYPE vtweg,
          spart  TYPE spart,
          dirshp TYPE zdirlbl,
        END OF ty_edicon.
DATA : gt_edicon TYPE STANDARD TABLE OF ty_edicon INITIAL SIZE 0,
       gs_edicon TYPE ty_edicon.

* EOC by DGHOSAL on 5/21/2018

* get konv-kwert
TYPES: BEGIN OF t_konv,
         knumv LIKE konv-knumv,
         kposn LIKE konv-kposn,
         "j_3aetenr LIKE konv-j_3aetenr, " YasanhaJ - Ver 17 - 17/02/2012
         kwert LIKE konv-kwert,
       END OF t_konv.
FIELD-SYMBOLS : <f_konv> TYPE t_konv.
DATA : wa_konv TYPE t_konv,
       i_konv  TYPE SORTED TABLE OF t_konv WITH NON-UNIQUE KEY knumv kposn. " j_3aetenr.

* get qty in trans
TYPES: BEGIN OF t_ekes,
         ebeln    LIKE ekes-ebeln,
         ebelp    LIKE ekes-ebelp,
* BOC by DGHOSAL on 6/9/2018 for SAP-75
         etens    TYPE etens,
         ebtyp    TYPE ebtyp,
         eindt    TYPE eindt,
* EOC by DGHOSAL on 6/9/2018 for SAP-75
         j_3asize LIKE ekes-j_3asize,
         menge    LIKE ekes-menge,
         dabmg    LIKE ekes-dabmg,
       END OF t_ekes.

*  BoC:Ruchira Sampath:06/08/2021-CH1343
TYPES: BEGIN OF t_ekes_size,
         ebeln    LIKE ekes-ebeln,
         ebelp    LIKE ekes-ebelp,
         j_3asize LIKE ekes-j_3asize,

         etens    TYPE etens,
         ebtyp    TYPE ebtyp,
         eindt    TYPE eindt,
         menge    LIKE ekes-menge,
         dabmg    LIKE ekes-dabmg,
       END OF t_ekes_size.
*  EoC:Ruchira Sampath:06/08/2021-CH1343

TYPES : BEGIN OF t_mat,
          ebeln TYPE ekko-ebeln,           "Po No.
          ebelp TYPE ekpo-ebelp,           "Line number
          knumv TYPE ekki-knumv,
          kwert TYPE konv-kwert,
        END OF t_mat.

FIELD-SYMBOLS : <f_mat> TYPE t_mat.

DATA  : i_mat     TYPE STANDARD TABLE OF t_mat,
        i_mat_tmp TYPE STANDARD TABLE OF t_mat,
        i_mat_h   TYPE HASHED TABLE OF t_mat WITH UNIQUE KEY ebeln ebelp,
        i_mat2    TYPE STANDARD TABLE OF t_mat,
        wa_mat    TYPE t_mat,
        wa_data2  TYPE t_data.

TYPES: BEGIN OF t_mvke,
         matnr LIKE mvke-matnr, "Material
         vkorg LIKE mvke-vkorg, "Sales Org.
         vtweg LIKE mvke-vtweg, "Dist.Chnl.
         dwerk LIKE mvke-dwerk, "Plant.
         mvgr1 LIKE mvke-mvgr1, "Sub Profit Center +SP13May2010
       END OF t_mvke.

FIELD-SYMBOLS: <f_mvke> TYPE t_mvke.
DATA : i_mvke TYPE STANDARD TABLE OF t_mvke.

TYPES: BEGIN OF t_t027b,
         spras LIKE t027b-spras, "Language Key
         evers LIKE t027b-evers, "Shipping Instructions
         evtxt LIKE t027b-evtxt, "Shipping Instructions: Description
       END OF t_t027b.
FIELD-SYMBOLS: <f_t027b> TYPE t_t027b.
DATA : i_t027b_h TYPE HASHED TABLE OF t_t027b WITH UNIQUE KEY spras evers.

TYPES: BEGIN OF t_mbew,
         matnr LIKE mbew-matnr, "Material Number
         bwkey LIKE mbew-bwkey, "Valuation Area
         bwtar LIKE mbew-bwtar, "Valuation Type
         stprs LIKE mbew-stprs, "Standard price
       END OF t_mbew.
FIELD-SYMBOLS: <f_mbew> TYPE t_mbew.
DATA : i_mbew   TYPE STANDARD TABLE OF t_mbew,
       i_mbew_h TYPE HASHED TABLE OF t_mbew WITH UNIQUE KEY matnr bwkey.

TYPES: BEGIN OF t_marc,
         matnr LIKE marc-matnr, "Material Number
         werks LIKE marc-werks, "Plant
         prctr LIKE marc-prctr, "Profit Center
         herkl LIKE marc-herkl,
       END OF t_marc.

TYPES: BEGIN OF t_eket,
         ebeln LIKE ekko-ebeln,
         ebelp LIKE ekpo-ebelp,
         wemng LIKE eket-wemng,
       END OF t_eket.

FIELD-SYMBOLS: <f_marc> TYPE t_marc.
DATA : i_marc_h TYPE HASHED TABLE OF t_marc WITH UNIQUE KEY matnr werks.

DATA : wa_ekes      TYPE t_ekes,
       wa_ekes_t    TYPE t_ekes,
       i_ekes       TYPE STANDARD TABLE OF t_ekes,
       i_ekes_ibd   TYPE STANDARD TABLE OF t_ekes,
       i_eket       TYPE STANDARD TABLE OF t_eket,
       i_eket1      TYPE STANDARD TABLE OF t_eket,
       wa_eket      TYPE t_eket,
       i_ekes_m     TYPE STANDARD TABLE OF t_ekes,
       i_ekes_m_tmp TYPE STANDARD TABLE OF t_ekes,
       i_ekes_m_h   TYPE HASHED TABLE OF t_ekes WITH UNIQUE KEY ebeln ebelp,
       i_ekes_m_h2  TYPE HASHED TABLE OF t_ekes WITH UNIQUE KEY ebeln ebelp j_3asize.

DATA : v_qty_book   LIKE eket-menge,         "Tot Qty Booked
       v_qty_rcv    LIKE eket-wemng,          "Tot Qty  Rcv
       v_ekes_menge LIKE ekes-menge,
       v_ekes_dabmg LIKE ekes-dabmg.
DATA : v_kwert LIKE konv-kwert.

DATA : v_input   LIKE ekpa-parvw VALUE 'GS',
       v_output  LIKE ekpa-parvw,
       v_input2  LIKE ekpa-parvw VALUE 'OA',   "MahendraP added on 2011-02-24
       v_output2 LIKE ekpa-parvw,             "MahendraP added on 2011-02-24
       v_input3  LIKE ekpa-parvw VALUE 'PI',   "MahendraP added on 2011-02-24
       v_output3 LIKE ekpa-parvw,             "MahendraP added on 2011-02-24
       v_input4  LIKE ekpa-parvw VALUE 'CR',   "ChandimaW - 2012-05-24 - freight forwarder
       v_output4 LIKE ekpa-parvw.             "ChandimaW - 2012-05-24 - freight forwarder

TYPES : ls_size TYPE j_3asosi_s.
DATA  : lw_size LIKE j_3asosi_s,
        lt_size TYPE STANDARD TABLE OF ls_size.

*** get afs sales data************************
TYPES : BEGIN OF t_saldata,
          matnr    TYPE matnr,
          vkorg    TYPE vkorg,
          vtweg    TYPE vtweg,
          j_3asize TYPE j_3asize,
          j_4krcat TYPE /afs/mvke-j_4krcat,
        END OF t_saldata.
DATA : wa_saldata TYPE t_saldata,
       i_saldata  TYPE TABLE OF t_saldata.
FIELD-SYMBOLS : <f_saldata> TYPE t_saldata.

TYPES : BEGIN OF t_afsmvke,
          matnr      TYPE matnr,
          vkorg      TYPE vkorg,
*         vtweg type vtweg,
          j_3asize   TYPE j_3asize,
          j_4krcat   TYPE /afs/mvke-j_4krcat,
          /afs/refpq TYPE /afs/mvke-/afs/refpq,
          j_3apqty   TYPE /afs/mvke-j_3apqty,
        END OF t_afsmvke.
DATA : wa_afsmvke  TYPE t_afsmvke,
       i_afsmvke   TYPE TABLE OF t_afsmvke,
       i_afsmvke_s TYPE SORTED TABLE OF t_afsmvke WITH NON-UNIQUE KEY matnr. " j_3asize.

TYPES : BEGIN OF t_konv_fob,
          knumv     TYPE konv-knumv,
          kposn     TYPE konv-kposn,
          stunr     TYPE konv-stunr,
          zaehk     TYPE konv-zaehk,
          j_3aetenr TYPE konv-j_3aetenr,
          kbetr     TYPE konv-kbetr,
        END OF t_konv_fob.

"$ Region - attSam added on 31.10.2011 - TVM1T to get description
TYPES : BEGIN OF t_tvm1t,
          mvgr1 TYPE tvm1t-mvgr1, "Sub Profit center
          bezei TYPE tvm1t-bezei, "SPS description
        END OF t_tvm1t.

TYPES : BEGIN OF t_zhanger,
          zzhanger     TYPE zhanger-zzhanger,
          zzhangerdesc TYPE zhanger-zzhangerdesc,
        END OF t_zhanger.
"$ Endregion - attSam added on 31.10.2011 - TVM1T to get description

DATA : i_konv_fob   TYPE STANDARD TABLE OF t_konv_fob,
       i_konv_fob_h TYPE HASHED TABLE OF t_konv_fob
       WITH UNIQUE KEY knumv kposn j_3aetenr,
       wa_konv_fob  TYPE t_konv_fob,
       "$ Region - attSam added on 31.10.2011
       i_tvm1t_h    TYPE HASHED TABLE OF t_tvm1t WITH UNIQUE KEY mvgr1,
       wa_tvm1t     TYPE t_tvm1t,
       i_zhanger_h  TYPE HASHED TABLE OF t_zhanger WITH UNIQUE KEY zzhanger,
       i_zhanger    TYPE STANDARD TABLE OF t_zhanger,
       wa_zhanger   TYPE t_zhanger.
"$ Endregion - attSam added on 31.10.2011

TYPES : BEGIN OF ty_sales,
          vbeln    TYPE vbak-vbeln,
          posnr    TYPE vbap-posnr,
          etenr    TYPE vbep-etenr,
          abgru    TYPE vbap-abgru , "chandimaw - 23/11/2011 - sales price issue when SO lines rejected
          knumv    TYPE vbak-knumv,
          matnr    TYPE vbap-matnr,
          j_3asize TYPE vbep-j_3asize,
          kschl    TYPE konv-kschl,
          kbetr    TYPE konv-kbetr,
          waers    TYPE konv-waers,
          vdatu    TYPE vbak-vdatu,    " Added CH-3155-315873-ECDK927707-New fields in purchase order status radio button
          j_3acada TYPE vbap-j_3acada, " Added CH-3155-315873-ECDK927707-New fields in purchase order status radio button
        END OF ty_sales.

DATA  : i_sales       TYPE STANDARD TABLE OF ty_sales,
*      HASHED TABLE OF ty_salesWITH UNIQUE KEY vbeln posnr etenr,
        i_sales_knumv TYPE HASHED TABLE OF ty_sales
                    WITH UNIQUE KEY vbeln posnr etenr,
*        i_sales_final TYPE STANDARD TABLE OF ty_sales,
        wa_sales      TYPE ty_sales.


*Add by Amith 12/06/2020
TYPES: BEGIN OF ty_release,
         ebeln TYPE ekko-ebeln,
         frgke TYPE ekko-frgke,
         frgzu TYPE ekko-frgzu,
       END OF ty_release.

DATA:i_release  TYPE STANDARD TABLE OF ty_release,
     wa_release TYPE ty_release.

*End Add

TYPES : BEGIN OF ty_sales_konv,
          knumv     TYPE konv-knumv,
          kposn     TYPE konv-kposn,
          kschl     TYPE konv-kschl,
          j_3aetenr TYPE konv-j_3aetenr,
          kbetr     TYPE konv-kbetr,
          kpein     TYPE konv-kpein,
          kinak     TYPE konv-kinak , "<-- PJDK925986:02/07/2012:MalindaW
          waers     TYPE konv-waers,
        END OF ty_sales_konv.

DATA  : i_sales_konv  TYPE STANDARD TABLE OF ty_sales_konv, "<-- PJDK926146:17/07/2012:MalindaW
        wa_sales_konv TYPE ty_sales_konv.

TYPES:  BEGIN OF t_konp,
          knumh TYPE konp-knumh,
*          kopos TYPE konp-kopos,
*          kschl TYPE konp-kschl,
          kbetr TYPE konp-kbetr,
          konwa TYPE konp-konwa,   "Added by Sriram 8/1/2015 9999013477
        END OF t_konp.
*DATA: i_sales_4_a905  TYPE STANDARD TABLE OF t_konp,
*      wa_sales_4_a905 TYPE t_konp.

DATA: i_sales_4_a905  TYPE HASHED TABLE OF t_konp WITH UNIQUE KEY knumh,
      wa_sales_4_a905 TYPE t_konp.

RANGES : r_del_sch FOR eket-j_3aelikz.
RANGES : r_kschl   FOR t683s-kschl.

RANGES : s_vkorg FOR mvke-vkorg. " YasanthaJ - 12/12/2010

TYPES :  BEGIN OF t_zzolla,
           zzolla TYPE vtadd01t-add_info,
           bezei  TYPE vtadd01t-bezei,
         END OF t_zzolla.
DATA : it_zzolla      TYPE HASHED TABLE OF t_zzolla WITH UNIQUE KEY zzolla,
       it_zzolla_copy TYPE STANDARD TABLE OF t_zzolla,
       wa_zzolla      TYPE t_zzolla.

TYPES :  BEGIN OF t_zport,
           zport TYPE vtadd02t-add_info,
           bezei TYPE vtadd02t-bezei,
         END OF t_zport.
DATA : it_zport TYPE HASHED TABLE OF t_zport WITH UNIQUE KEY zport.
FIELD-SYMBOLS: <f_zport> TYPE t_zport.

TYPES : BEGIN OF t_ebeln,
          ebeln TYPE ekko-ebeln,
        END OF t_ebeln.
DATA : it_ebeln TYPE STANDARD TABLE OF t_ebeln,
       wa_ebeln TYPE t_ebeln.

TYPES : BEGIN OF t_zzkunnr,
          zzkunnr TYPE ekpo-zzkunnr,
        END OF t_zzkunnr.
DATA : it_zzkunnr TYPE STANDARD TABLE OF t_zzkunnr,
       wa_zzkunnr TYPE t_zzkunnr.
*++
TYPES : BEGIN OF t_zkunnr,
          zkunnr TYPE mara-zzkunnr,
        END OF t_zkunnr.
*
DATA : it_zkunnr TYPE TABLE OF t_zkunnr,
       wa_zkunnr TYPE t_zkunnr.
*
TYPES : BEGIN OF ty_cname,
          kunnr TYPE kna1-kunnr,
          name1 TYPE kna1-name1,
        END OF ty_cname.
*
DATA : it_cname TYPE TABLE OF ty_cname.
*
FIELD-SYMBOLS : <fs_cname> TYPE ty_cname.
*
*++
TYPES : BEGIN OF t_zzvgbel,
          zzvgbel TYPE ekpo-zzvgbel,
        END OF t_zzvgbel.
DATA : it_zzvgbel TYPE STANDARD TABLE OF t_zzvgbel,
       wa_zzvgbel TYPE t_zzvgbel.

TYPES : BEGIN OF t_knumv,
          knumv TYPE ekko-knumv,
          kposn TYPE konv-kposn,
          etenr TYPE eket-etenr,
        END OF t_knumv.
DATA : it_knumv TYPE STANDARD TABLE OF t_knumv,
       wa_knumv TYPE t_knumv.

DATA: gt_t141t   TYPE TABLE OF t141t,
      gt_tvko  TYPE STANDARD TABLE OF tvkwz, "CH-3449-ECDK928571-315873-26.July.2024-Calculation of number cartons
      gt_t141t_h TYPE HASHED TABLE OF t141t WITH UNIQUE KEY mmsta,
      gs_t141t   TYPE t141t.

TYPES:  BEGIN OF t_j_3avast,
          knumh      TYPE j_3avast-knumh,
          j_3asize   TYPE j_3avast-j_3asize,
          j_3atltyp  TYPE j_3avast-j_3atltyp,
          j_3afield1 TYPE j_3avast-j_3afield1,
        END OF t_j_3avast.

DATA: gi_j_3avast  TYPE TABLE OF t_j_3avast,
      gwa_j_3avast TYPE t_j_3avast,
*     gi_kotk984_h TYPE HASHED TABLE OF kotk984 WITH UNIQUE KEY matnr, "vkorg,          9999013477
      gi_kotk984_h TYPE HASHED TABLE OF kotk984 WITH UNIQUE KEY matnr vkorg, "9999013477
      gwa_kotk984  TYPE kotk984.

*INSERT:PJDK925380:29/05/2012:MW - {
DATA: gi_rsparams      TYPE TABLE OF rsparams,
      gs_rsparams      TYPE rsparams,
      print_parameters TYPE pri_params.
* chandimaw - 24/05/2012 - undo report merging
** INSERT:PJDK925334:24/05/2012:MW - {

*{  INSERT  PJDK926501  14.08.2012  MP
TYPES : BEGIN OF gt_zpocomp,
          ebeln    TYPE zpocomp-ebeln,
          ebelp    TYPE zpocomp-ebelp,
          matnr    TYPE zpocomp-matnr,
          j_3asize TYPE zpocomp-j_3asize,
          netpr    TYPE zpocomp-netpr,
          menge    TYPE zpocomp-menge,
        END OF gt_zpocomp.

DATA : gi_zpocomp   TYPE TABLE OF gt_zpocomp,
       gwa_zpocomp  TYPE gt_zpocomp,
       gwa_zpocomp2 TYPE gt_zpocomp.

*}  INSERT

*{  INSERT  PJDK928062 26.11.2012  MP
TYPES : BEGIN OF gt_dd07t,
          ddtext     TYPE dd07t-ddtext,
          domvalue_l TYPE dd07t-domvalue_l,
        END OF gt_dd07t.

DATA : gi_dd07t  TYPE TABLE OF gt_dd07t,
       gwa_dd07t TYPE gt_dd07t.
*}  INSERT
**Start of changes done by SRIRAM. "9999012212
TYPES : BEGIN OF gt_nrpmnt,
          zznrpmnt TYPE mara-zznrpmnt,
        END OF gt_nrpmnt.
**End of changes done by SRIRAM. "9999012212

TYPES: BEGIN OF gt_shppln,
         ebeln     LIKE ekes-ebeln,
         ebelp     LIKE ekes-ebelp,
         etens     LIKE ekes-etens,
         ebtyp     LIKE ekes-ebtyp,
         eindt     LIKE ekes-eindt,
         erdat     LIKE ekes-erdat,
         menge     LIKE ekes-menge,
         xblnr     LIKE ekes-xblnr,
         j_3asize  LIKE ekes-j_3asize,
         j_3aetenr LIKE ekes-j_3aetenr,
         vbeln     LIKE ekes-vbeln, "CH-3155-315873-ECDK927707-New fields in purchase order status radio button
       END OF gt_shppln.

* Start of Addition 9999013477
TYPES : BEGIN OF ty_ekpo,
          ebeln TYPE zpocomp-ebeln,
          ebelp TYPE zpocomp-ebelp,
          matnr TYPE zpocomp-matnr,
          werks TYPE vkorg,
          lgort TYPE ekpo-lgort,    "Added By sriram
          afnam TYPE ekpo-afnam,    "Added By SriRam
        END OF ty_ekpo.
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
TYPES : BEGIN OF ty_ekkn,
          ebeln TYPE ekkn-ebeln,
          ebelp TYPE ekkn-ebelp,
          vbeln TYPE ekkn-vbeln,
          vbelp TYPE ekkn-vbelp,
        END OF ty_ekkn,
        BEGIN OF ty_sonet,
          vbeln TYPE vbap-vbeln,
          posnr TYPE vbap-posnr,
          netpr TYPE vbap-netpr,
        END OF ty_sonet.
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
TYPES:BEGIN OF ty_data,
*         werks TYPE ekpo-werks,
        lgort TYPE ekpo-lgort,
      END OF ty_data.
DATA: lt_data TYPE TABLE OF ty_data.

DATA: lw_ekpo     TYPE ty_ekpo,
      lt_ekpo     TYPE TABLE OF ty_ekpo,
      lw_tvkwz    TYPE tvkwz,
      lt_tvkwz    TYPE TABLE OF tvkwz,
      lt_kotk984  TYPE TABLE OF kotk984,
      lt_j_3avast TYPE TABLE OF t_j_3avast.
*  End of Addition 9999013477

DATA:  gi_shppln  TYPE STANDARD TABLE OF gt_shppln,
       gw_shppln  TYPE gt_shppln,
* Begin of changes - ECDK922248  Ruchira Sampath
       gi_bkdates TYPE STANDARD TABLE OF gt_shppln,
* End of changes - ECDK922248 Ruchira Sampath
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
       gi_ekkn    TYPE STANDARD TABLE OF ty_ekkn,
       gi_sonet   TYPE STANDARD TABLE OF ty_sonet.
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button

* BOC by DGHOSAL on 5/21/2018
DATA:  gi_shpp_aa TYPE STANDARD TABLE OF gt_shppln,
       gw_shpp_aa TYPE gt_shppln.
* EOC by DGHOSAL on 5/21/2018

TYPES : BEGIN OF lt_mvke,
          matnr TYPE matnr,
          vkorg TYPE vkorg,
        END OF lt_mvke.

DATA: li_mvke  TYPE STANDARD TABLE OF lt_mvke,
      li_mvke1 TYPE STANDARD TABLE OF lt_mvke,
      wa_mvke  TYPE lt_mvke.

TYPES : BEGIN OF lt_ekpv,
          ebeln TYPE ebeln,
          ebelp TYPE ebelp,
          kunnr TYPE kunnr,
          vstel TYPE vstel,
          ladgr TYPE ladgr,
        END OF lt_ekpv.
DATA : i_ekpv TYPE SORTED TABLE OF lt_ekpv WITH NON-UNIQUE KEY ebeln ebelp.

TYPES: BEGIN OF t_compat,
         matnr      LIKE kotk980-matnr,
         knumh      LIKE kotk980-knumh,
         j_3asize   LIKE j_3avast-j_3asize,
         j_3atltyp  LIKE j_3avast-j_3atltyp,
         vkorg      LIKE kotk980-vkorg,
         j_3afield1 LIKE j_3avast-j_3afield1,
         kunnr      LIKE kotk980-kunnr, " CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
       END OF t_compat.
DATA:  gt_compat TYPE STANDARD TABLE OF t_compat,
       wa_compat TYPE t_compat.
* BOC by DGHOSAL on 5/21/2018
TYPES: BEGIN OF t_msrp,
         matnr      LIKE kotk980-matnr,
         kunnr      LIKE kotk980-kunnr,
         knumh      LIKE kotk980-knumh,
         j_3asize   LIKE j_3avast-j_3asize,
         j_3atltyp  LIKE j_3avast-j_3atltyp,
         vkorg      LIKE kotk980-vkorg,
         j_3afield1 LIKE j_3avast-j_3afield1,
         j_3afield2 LIKE j_3avast-j_3afield2,
       END OF t_msrp.

DATA:  gt_msrp  TYPE STANDARD TABLE OF t_msrp INITIAL SIZE 0,
       gt_msrp1 TYPE STANDARD TABLE OF t_msrp INITIAL SIZE 0,
       gs_msrp  TYPE t_msrp.

TYPES: BEGIN OF t_knvv,
         vkorg     LIKE kotk980-vkorg,
         kunnr     LIKE kotk980-kunnr,
         j_3akvgr8 TYPE knvv-j_3akvgr8,
       END OF t_knvv.
DATA:  gt_knvv TYPE STANDARD TABLE OF t_knvv INITIAL SIZE 0,
       gs_knvv TYPE t_knvv.
* EOC by DGHOSAL on 5/21/2018

TYPES: BEGIN OF t_color_desc,
         spart  LIKE zmlangdesc-spart,
         matnr  LIKE zmlangdesc-zzval,
         spras  LIKE zmlangdesc-spras,
         zzdesc LIKE zmlangdesc-zzdesc,
       END OF t_color_desc.
DATA:  gi_color_desc TYPE STANDARD TABLE OF t_color_desc,
       wa_color_desc TYPE t_color_desc.

TYPES : BEGIN OF ty_marc_hts,
          matnr      TYPE marc-matnr,
          werks      TYPE marc-werks,
          zzhts1     TYPE marc-zzhts1,
          zzhts1desc TYPE marc-zzhts1desc,
        END OF ty_marc_hts.

DATA gi_marc_hts TYPE STANDARD TABLE OF ty_marc_hts.


DATA: itgendr          TYPE SORTED TABLE OF ztgendr WITH UNIQUE KEY zzngendr,
      wagendr          TYPE ztgendr,
      itaggrp          TYPE SORTED TABLE OF ztaggrp WITH UNIQUE KEY zznaggrp,
      waaggrp          TYPE ztaggrp,
      itbrgrp          TYPE SORTED TABLE OF ztbrgrp WITH UNIQUE KEY zznbrgrp,
      wabrgrp          TYPE ztbrgrp,
      itbrgtp          TYPE SORTED TABLE OF ztbrgtp WITH UNIQUE KEY zznbrgtp,
      wabrgtp          TYPE ztbrgtp,
      itgszgp          TYPE SORTED TABLE OF ztgszgp WITH UNIQUE KEY zzngszgp,
      wagszgp          TYPE ztgszgp,
      itprdct          TYPE SORTED TABLE OF ztprdct WITH UNIQUE KEY zznprdct,
      waprdct          TYPE ztprdct,
      itprdsc          TYPE SORTED TABLE OF ztprdsc WITH UNIQUE KEY zznprdsc,
      waprdsc          TYPE ztprdsc,
      itfabct          TYPE SORTED TABLE OF ztfabct WITH UNIQUE KEY zznfabct,
      wafabct          TYPE ztfabct,
      itevent          TYPE SORTED TABLE OF ztevent WITH UNIQUE KEY zznevent,
      waevent          TYPE ztevent,
      itcolln          TYPE SORTED TABLE OF ztcolln WITH UNIQUE KEY zzncolln,
      wacolln          TYPE ztcolln,
      itprdha          TYPE STANDARD TABLE OF zroycodes,
      waprdha          TYPE zroycodes,
      itadesc          TYPE STANDARD TABLE OF t163i,
      wadesc           TYPE t163i,
      itcat            TYPE STANDARD TABLE OF t163y,
      itcoltp          TYPE STANDARD TABLE OF ztcoltp,
      wacoltp          TYPE ztcoltp,
      itcuftp          TYPE STANDARD TABLE OF ztcuftp,
      wacuftp          TYPE ztcuftp,
      itfapyr          TYPE STANDARD TABLE OF ztfapyr,
      wafapyr          TYPE ztfapyr,
      itsilht          TYPE STANDARD TABLE OF ztsilht,
      wasilht          TYPE ztsilht,
      wacat            TYPE t163y,
      gt_latecode      TYPE STANDARD TABLE OF zlatecode,
      gw_latecode      TYPE zlatecode,
      gv_factory       TYPE kna1-kunnr,
      i_mean           TYPE STANDARD TABLE OF mean,
      i_mean_c         TYPE STANDARD TABLE OF mean,
      wa_mean          TYPE mean,
      gt_msrp_rates    TYPE STANDARD TABLE OF zmsrp_rates,
      wa_msrp_rates    TYPE zmsrp_rates,
      gv_msrpcad       TYPE konv-kbetr,
      gt_plant_control TYPE STANDARD TABLE OF zplant_control,
      gw_plant_control TYPE zplant_control,
      gt_lines         TYPE TABLE OF tline WITH HEADER LINE,
      gw_lines         TYPE tline,
      gv_tdname        TYPE thead-tdname,
      gv_split1(40),
      gv_split2(40),

      it_ztopdcl       TYPE STANDARD TABLE OF ztopdcl
      .

* BOC by DGHOSAL on 5/21/2018
DATA : gt_t163f TYPE STANDARD TABLE OF t163f INITIAL SIZE 0,
       gs_t163f TYPE t163f.
DATA : gt_zats_sorg_lbl TYPE STANDARD TABLE OF zats_sorg_lbl INITIAL SIZE 0,
       gs_zats_sorg_lbl TYPE zats_sorg_lbl.
DATA : gt_zats_cust_lbl TYPE STANDARD TABLE OF zats_cust_lbl INITIAL SIZE 0,
       gs_zats_cust_lbl TYPE zats_cust_lbl.
* EOC by DGHOSAL on 5/21/2018

* BOC by PFERNANDO on 7/23/2018
DATA: BEGIN OF gwa_fob,
        kschl TYPE kschl,
        kbetr TYPE kbetr,
      END OF gwa_fob.
* EOC by PFERNANDO on 7/23/2018

* Begin of changes - ECDK915177 - Pio Fernando
DATA : gv_vkorg        TYPE vkorg,
       gv_msrp_control TYPE xfeld,
       gt_curr         TYPE TABLE OF zcl_msrp_pricing=>gty_curr,
       gv_var(30).
FIELD-SYMBOLS: <gv_var> TYPE any.
* End of changes - ECDK915177 - Pio Fernando

*      itnrpmnt TYPE SORTED TABLE OF ztnrpmnt WITH UNIQUE KEY zznrpmnt,
*      wanrpmnt TYPE ztnrpmnt.
DATA:   i_fabrn TYPE SORTED TABLE OF ztfabrn WITH UNIQUE KEY zznfabrn
        WITH HEADER LINE.                              "PIYUSH PAYASI -9999011257
DATA: i_nrpmnt TYPE SORTED TABLE OF gt_nrpmnt WITH UNIQUE KEY zznrpmnt
      WITH HEADER LINE.                                   "SRIRAM -9999012212

"sw1
DATA :    lt_ztactvt    TYPE STANDARD TABLE OF ztactvt,
          lt_zttheme    TYPE STANDARD TABLE OF zttheme,
          lt_ztbkpkd    TYPE STANDARD TABLE OF ztbkpkd,
          lt_ztbdftn    TYPE STANDARD TABLE OF ztbdftn,
          lt_ztbusun    TYPE STANDARD TABLE OF ztbusun,
          lt_ztchorg    TYPE STANDARD TABLE OF ztchorg,
          lt_ztchar2    TYPE STANDARD TABLE OF ztchar2,
          lt_ztclass    TYPE STANDARD TABLE OF ztclass,
          lt_ztdenft    TYPE STANDARD TABLE OF ztdenft,
          lt_ztdepmt    TYPE STANDARD TABLE OF ztdepmt,
          lt_ztfabat    TYPE STANDARD TABLE OF ztfabat,
          lt_ztfabnm    TYPE STANDARD TABLE OF ztfabnm,
          lt_ztfabst    TYPE STANDARD TABLE OF ztfabst,
          lt_ztftacc    TYPE STANDARD TABLE OF ztftacc,
          lt_zthwtrt    TYPE STANDARD TABLE OF zthwtrt,
          lt_zthemfn    TYPE STANDARD TABLE OF zthemfn,
          lt_ztlengt    TYPE STANDARD TABLE OF ztlengt,
          lt_ztmettp    TYPE STANDARD TABLE OF ztmettp,
          lt_ztpatrn    TYPE STANDARD TABLE OF ztpatrn,
          lt_ztpresn    TYPE STANDARD TABLE OF ztpresn,
          lt_ztprcpt    TYPE STANDARD TABLE OF ztprcpt,
          lt_ztprdgr    TYPE STANDARD TABLE OF ztprdgr,
          lt_ztstone    TYPE STANDARD TABLE OF ztstone,
          lt_ztsclas    TYPE STANDARD TABLE OF ztsclas,
          lt_ztwaist    TYPE STANDARD TABLE OF ztwaist,
          lt_ztwashy    TYPE STANDARD TABLE OF ztwashy,
          lt_ztwashs    TYPE STANDARD TABLE OF ztwashs,
          lt_ztwasht    TYPE STANDARD TABLE OF ztwasht,
          lt_ztlgopn    TYPE STANDARD TABLE OF ztlgopn,
          lt_ztsilht    TYPE STANDARD TABLE OF ztsilht,
          lt_ztchars    TYPE STANDARD TABLE OF ztchars,
          lt_zconstype  TYPE STANDARD TABLE OF zconstype,
          lt_ztfabrn    TYPE STANDARD TABLE OF ztfabrn,
          lt_ztfapyr    TYPE STANDARD TABLE OF ztfapyr,
          lt_zhlht      TYPE STANDARD TABLE OF zhlht,
          lt_ztitplt    TYPE STANDARD TABLE OF ztitplt,
          lt_ztnctyp    TYPE STANDARD TABLE OF ztnctyp,
          lt_ztsetct    TYPE STANDARD TABLE OF ztsetct,
          lt_ztrpmnt    TYPE STANDARD TABLE OF ztrpmnt,
          lt_zshaftht   TYPE STANDARD TABLE OF zshaftht,
          lt_ztslvtp    TYPE STANDARD TABLE OF ztslvtp,
          lt_zstdet     TYPE STANDARD TABLE OF zstdet,
          lt_ztstfsh    TYPE STANDARD TABLE OF ztstfsh,
          lt_zinvstatus TYPE STANDARD TABLE OF zinvstatus.
"
*  BoC : CH-1778  :Ruchira : 05/06/2022
TYPES : BEGIN OF ty_compupc,
*  matnr TYPE mara-matnr,
*  ean11 TYPE mara-ean11,
          matnr     TYPE mean-matnr,
          meinh     TYPE mean-meinh,
          lfnum     TYPE mean-lfnum,
          ean11     TYPE mean-ean11,
          eantp     TYPE mean-eantp,
          hpean     TYPE mean-hpean,
          sgt_catv  TYPE mean-sgt_catv,
          j_3akordx TYPE mean-j_3akordx,
        END OF ty_compupc.

DATA : gi_compupc TYPE STANDARD TABLE OF ty_compupc.
*  EoC : CH-1778  :Ruchira : 05/06/2022


SELECTION-SCREEN BEGIN OF BLOCK b4 WITH FRAME TITLE text-100.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS: p_postat TYPE c RADIOBUTTON GROUP rbg1 USER-COMMAND uc2 DEFAULT 'X'.
SELECTION-SCREEN COMMENT 3(21) text-139.
SELECTION-SCREEN POSITION 24.
PARAMETERS: p_pocpan TYPE c RADIOBUTTON GROUP rbg1.
SELECTION-SCREEN COMMENT 26(25) text-138.

*Add AP ,26/07/2022, ED1K900279
SELECTION-SCREEN POSITION 52.
PARAMETERS: p_pocha TYPE c RADIOBUTTON GROUP rbg1 .
SELECTION-SCREEN COMMENT 54(19) text-t04.  " BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic-25 to 19
**End Add

*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
SELECTION-SCREEN POSITION 73.
PARAMETERS: p_polac TYPE c RADIOBUTTON GROUP rbg1.
SELECTION-SCREEN COMMENT 76(15) text-t05.
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.

SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK b4.
** INSERT:PJDK925334:24/05/2012:MW - }
*INSERT:PJDK925380:29/05/2012:MW - }

SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE text-119.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS : p_mat  RADIOBUTTON  GROUP g1 USER-COMMAND uc1 DEFAULT 'X' MODIF ID zr1.
SELECTION-SCREEN COMMENT 3(21) text-140 MODIF ID zr1.
SELECTION-SCREEN POSITION 24.
PARAMETERS : p_size RADIOBUTTON  GROUP g1 MODIF ID zr1.
SELECTION-SCREEN COMMENT 26(25) text-141 MODIF ID zr1.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN SKIP 1.  " chandimaw - 04/03/2011

*Code commented by SriRam
*PARAMETERS : p_del     AS CHECKBOX MODIF ID zr1.
*PARAMETERS : p_d_only  AS CHECKBOX MODIF ID zr1.  " chandimaw - 04/03/2011 - option to display deleted orders only
*PARAMETERS : p_ppk_br  AS CHECKBOX MODIF ID zr1  USER-COMMAND uc3.     "+PJDK926501  14.08.2012  MP
*PARAMETERS : p_sh_pln  AS CHECKBOX MODIF ID zsh USER-COMMAND uc4.

*Begin of changes by SriRam - 10/06/2015   9999014435
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS : p_del AS CHECKBOX MODIF ID zr1.
SELECTION-SCREEN COMMENT 3(9) text-114 MODIF ID zr1.
SELECTION-SCREEN POSITION 14.
PARAMETERS : p_d_only  AS CHECKBOX MODIF ID zr1.  " chandimaw - 04/03/2011 - option to display deleted orders only
SELECTION-SCREEN COMMENT 16(12) text-115 MODIF ID zr1.
SELECTION-SCREEN POSITION 28.
PARAMETERS : p_ppk_br  AS CHECKBOX MODIF ID zr1 USER-COMMAND uc3.     "+PJDK926501  14.08.2012  MP
SELECTION-SCREEN COMMENT 30(17) text-116 MODIF ID zr1.
SELECTION-SCREEN POSITION 47.
PARAMETERS : p_sh_pln  AS CHECKBOX MODIF ID zsh USER-COMMAND uc4.
SELECTION-SCREEN COMMENT 49(15) text-117 MODIF ID zr1.
SELECTION-SCREEN POSITION 65.
PARAMETERS : p_msrp  AS CHECKBOX MODIF ID zsh USER-COMMAND uc4.
SELECTION-SCREEN COMMENT 67(4) text-137 MODIF ID zr1.
SELECTION-SCREEN POSITION 73.
PARAMETERS : p_asin  AS CHECKBOX MODIF ID zsh USER-COMMAND uc4.
SELECTION-SCREEN COMMENT 75(12) text-143 MODIF ID zr1.
SELECTION-SCREEN END OF LINE.

*End of changes by SriRam  - 10/06/2015    9999014435
SELECTION-SCREEN END OF BLOCK b1.

SELECTION-SCREEN BEGIN OF BLOCK b2 WITH FRAME TITLE text-002.
*SELECT-OPTIONS s_ekorg FOR ekko-ekorg.          " Purch Org. <-- PJDK925334:24/05/2012:MW
SELECT-OPTIONS s_werks FOR ekpo-werks MODIF ID zr1.         " Plant  "ekpo-werks
SELECT-OPTIONS s_busun    FOR mara-zznbusun MODIF ID zr1.
SELECT-OPTIONS s_prdgp    FOR mara-zznprdgr MODIF ID zr1.
SELECT-OPTIONS s_prdct    FOR mara-zznprdct MODIF ID zr1.
SELECT-OPTIONS s_dempt    FOR mara-zzndepmt MODIF ID zr1.
SELECT-OPTIONS s_class    FOR mara-zznclass MODIF ID zr1.
SELECT-OPTIONS s_sclass   FOR mara-zznsclas MODIF ID zr1.
SELECT-OPTIONS s_lgort FOR ekpo-lgort MODIF ID zr1.          " Storage Location <-- PJDK925334:24/05/2012:MW
SELECT-OPTIONS s_ekgrp FOR ekko-ekgrp MODIF ID zr1.          " Purch Group
SELECT-OPTIONS s_eindt FOR eket-eindt MODIF ID zr1.          " Due Date
SELECT-OPTIONS s_ebeln FOR ekko-ebeln MODIF ID zr1.          " PO Number
SELECT-OPTIONS s_aedat FOR ekko-aedat MODIF ID zr1.          " PO Creation Date
SELECT-OPTIONS s_ernam FOR ekko-ernam MODIF ID zr1.          " PO Creation Date
SELECT-OPTIONS s_exfcm FOR ekpo-j_3aexfcm MODIF ID zr1.      " PO Ex Factory Date <-- PJDK926297:27/07/2012:MalindaW
SELECT-OPTIONS s_lifnr FOR ekko-lifnr MODIF ID zr1.          " Vendor Coded
SELECT-OPTIONS s_inpty FOR ekpa-lifn2 MODIF ID zr1.          "
SELECT-OPTIONS s_gsupp FOR ekpa-lifn2 MODIF ID zr1.          "
SELECT-OPTIONS s_ordar FOR ekpa-lifn2 MODIF ID zr1.          " Ordering Address
SELECT-OPTIONS s_frfor FOR ekpa-lifn2 MODIF ID zr1.          " Freight Forwarder
SELECT-OPTIONS s_evers FOR ekpo-evers MODIF ID zr1.          " Ship Method
SELECT-OPTIONS s_shpdt FOR ekpo-zzxportdat MODIF ID zr1.     " Ship Date
SELECT-OPTIONS s_matnr FOR mara-matnr MODIF ID zr1.          " Material
SELECT-OPTIONS s_bismt FOR mara-bismt MODIF ID zr1.          " Style Number
SELECT-OPTIONS s_wrkst FOR mara-wrkst MODIF ID zr1.
SELECT-OPTIONS s_land1 FOR lfa1-land1 NO INTERVALS MODIF ID zr1.
SELECT-OPTIONS s_herkl FOR mara-herkl NO INTERVALS MODIF ID zr1.
SELECT-OPTIONS s_ihrez FOR ekko-ihrez MODIF ID zr1.
SELECT-OPTIONS s_pstyp    FOR ekpo-pstyp MODIF ID zr1.
SELECT-OPTIONS s_zkunnr   FOR mara-zzkunnr MODIF ID zr1.
SELECT-OPTIONS s_inco1    FOR ekko-inco1 MODIF ID zr1.
SELECT-OPTIONS s_cinco1   FOR ekpo-inco1 MODIF ID zr1.           "chandimaw - 13/07/2012 - add costing incoterm
SELECT-OPTIONS s_collec   FOR ekko-submi MODIF ID zr1.
*SELECT-OPTIONS s_mvgr1    FOR mvke-mvgr1 MODIF ID zr1.          " NF 04/24/2017  commented - sub profit ctr filtering isssue
SELECT-OPTIONS s_bednr    FOR ekpo-bednr MODIF ID zr1.      "Tracking Number     "Added By SriRam - 10/06/2015     9999014435
SELECT-OPTIONS s_afnam    FOR ekpo-afnam MODIF ID zr1.      "Requisitioner       "Added By SriRam - 10/06/2015     9999014435
SELECT-OPTIONS s_dirshp FOR ekpo-zzdirort MODIF ID zr1.           "TD
SELECT-OPTIONS s_reswk  FOR ekko-reswk MODIF ID zr1. "FNT Change 01/17/2017 NF
SELECT-OPTIONS s_bsgru FOR ekpo-bsgru MODIF ID zr1. " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
SELECT-OPTIONS s_zdiort FOR zdirshpval-zdirort NO INTERVALS MODIF ID zr1.   "CH:911:AB:MM:ZPORPT Changes

*Standardization: New fields from material master
SELECT-OPTIONS s_erdat    FOR ekes-erdat MODIF ID zr3.
SELECT-OPTIONS s_eindt2   FOR ekes-eindt MODIF ID zr3.
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
SELECT-OPTIONS s_exempt   FOR ekpo-zexempt MODIF ID zr1.
* BOC by DGHOSAL on 5/21/2018
SELECT-OPTIONS s_kunnr    FOR ekpo-zzkunnr MODIF ID zr1.
* EOC by DGHOSAL on 5/21/2018
SELECT-OPTIONS s_zbstnk   FOR ekpo-zzbstnk MODIF ID zr1.
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967

**Add AP, 31/03/2023
SELECT-OPTIONS s_zlcd    FOR ekpo-zzlatecd  MODIF ID zr1. " Add AP, ECDK925994
*End Add
SELECTION-SCREEN END OF BLOCK b2.

"Addition of code by SriRam - 10/06/2015
SELECTION-SCREEN BEGIN OF BLOCK b7 WITH FRAME TITLE text-118.
SELECT-OPTIONS s_aggrp    FOR mara-zznaggrp MODIF ID zr1.
SELECT-OPTIONS s_brand    FOR mara-zznbrand MODIF ID zr1.
SELECT-OPTIONS s_brgrp    FOR ztbrand-zznbrgrp MODIF ID zr1 MATCHCODE OBJECT ztbrgrp.
SELECT-OPTIONS s_brgtp    FOR ztbrgrp-zznbrgtp MODIF ID zr1 MATCHCODE OBJECT ztbrgtp.
SELECT-OPTIONS s_colln    FOR mara-zzncolln MODIF ID zr1.
SELECT-OPTIONS s_event    FOR mara-zznevent MODIF ID zr1.
SELECT-OPTIONS s_fabct    FOR mara-zznfabct MODIF ID zr1.
SELECT-OPTIONS s_nfabrn   FOR mara-zznfabrn MODIF ID zr1. "Fabrication - PIYUSH"9999011257
SELECT-OPTIONS s_gendr    FOR mara-zzngendr MODIF ID zr1.
SELECT-OPTIONS s_stmth    FOR mara-zznstmth MODIF ID zr1.
"SELECT-OPTIONS s_prdsc    FOR mara-zznprdsc MODIF ID zr1.
SELECT-OPTIONS s_prctr    FOR marc-prctr MODIF ID zr1.
SELECT-OPTIONS s_nrpmnt   FOR mara-zznrpmnt MODIF ID zr1. "Replenishment - SRIRAM "9999012212
SELECT-OPTIONS s_prdha    FOR zroycodes-zzrcode MODIF ID zr1.
SELECT-OPTIONS s_seasn    FOR mara-zznseasn MODIF ID zr1.
SELECT-OPTIONS s_gszgp    FOR mara-zzngszgp MODIF ID zr1.
SELECT-OPTIONS s_mvgr12   FOR mvke-mvgr1 MODIF ID zr1.
SELECT-OPTIONS s_mstae    FOR mara-mstae MODIF ID zr1.           "asangad 04112011 sw1
SELECTION-SCREEN END OF BLOCK b7.

*INSERT:PJDK925380:29/05/2012:MW - {
SELECTION-SCREEN:BEGIN OF BLOCK b5 WITH FRAME TITLE text-001."text-001.
PARAMETERS:p_povsc  TYPE char1 RADIOBUTTON GROUP rb1 USER-COMMAND uc5 DEFAULT 'X' MODIF ID zr2,
           p_povin  TYPE char1 RADIOBUTTON GROUP rb1 MODIF ID zr2,
           p_compan TYPE char1 RADIOBUTTON GROUP rb1 MODIF ID zr2.
SELECTION-SCREEN:END OF BLOCK b5.

SELECTION-SCREEN:BEGIN OF BLOCK b6 WITH FRAME TITLE text-002.
SELECT-OPTIONS:s_werks1  FOR ekpo-werks MODIF ID zr2,
               s_ebeln1  FOR ekko-ebeln MODIF ID zr2,
               s_aedat1  FOR ekko-aedat MODIF ID zr2,          " PO Creation Date
               s_ekgrp1  FOR ekko-ekgrp MODIF ID zr2,
               s_eindt1  FOR eket-eindt MODIF ID zr2,
               s_matnr1  FOR ekpo-matnr MODIF ID zr2,
               s_gsupp1  FOR ekpa-lifn2 MODIF ID zr2,
               s_inco11  FOR ekko-inco1 MODIF ID zr2,
               s_evers1  FOR ekpo-evers MODIF ID zr2,
               s_land11  FOR lfa1-land1 MODIF ID zr2,
               s_name1   FOR lfa1-name1 MODIF ID zr2,
               s_mvgr11  FOR mvke-mvgr1 MODIF ID zr2,
               s_prctr1  FOR marc-prctr MODIF ID zr2,      "Added By SriRam  - 10/06/2015    9999014435
               s_seasn1  FOR mara-zznseasn MODIF ID zr2,
               s_brand1  FOR mara-zznbrand MODIF ID zr2,
               s_pstyp1  FOR ekpo-pstyp MODIF ID zr2,
               s_exfcm1  FOR ekpo-j_3aexfcm MODIF ID zr2,
               s_reswk1  FOR ekko-reswk MODIF ID zr2. "FNT Change 01/17/2017 NF
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
SELECT-OPTIONS s_exemp   FOR ekpo-zexempt MODIF ID zr2.
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
SELECTION-SCREEN:END OF BLOCK b6.
*INSERT:PJDK925380:29/05/2012:MW - }

*Add AP ,26/07/2022, ED1K900279
SELECTION-SCREEN BEGIN OF BLOCK b11 WITH FRAME TITLE text-t04.
SELECT-OPTIONS: s1_werks FOR ekpo-werks MODIF ID zr4,
                s1_ebeln FOR ekpo-ebeln MODIF ID zr4,
                s1_user  FOR cdhdr-username MODIF ID zr4,
                sl_matnr FOR ekpo-matnr,
                s1_date  FOR  cdhdr-udate MODIF ID zr4.

SELECTION-SCREEN END OF BLOCK b11.

*End Add

SELECTION-SCREEN BEGIN OF BLOCK b3 WITH FRAME TITLE text-003.
PARAMETERS: p_vari LIKE disvariant-variant.
SELECTION-SCREEN END OF BLOCK b3.

*Add By Amith 12/06/2020
SELECTION-SCREEN BEGIN OF BLOCK b10 WITH FRAME TITLE text-s10.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 2(15) text-s11.
PARAMETERS: r_alv RADIOBUTTON GROUP g2 DEFAULT 'X'.
SELECTION-SCREEN COMMENT 25(15) text-s12.
PARAMETERS: r_app RADIOBUTTON GROUP g2.
SELECTION-SCREEN END OF LINE.
PARAMETERS p_file LIKE  rlgrap-filename."""  DEFAULT  '/usr/sap/ECD/SYS/src/ZSTOCKRPT.csv'.
PARAMETERS : p_check AS CHECKBOX MODIF ID zr5.                       "Insert CH-2451-ECDK926220-27-Apr-2023
SELECTION-SCREEN END OF BLOCK b10.

*End Add


AT SELECTION-SCREEN OUTPUT.

**  CHECK sy-batch IS NOT INITIAL.
*CLEAR p_varnt.
*MOVE sy-slset TO p_varnt.

*INSERT:PJDK925380:29/05/2012:MW - {
  IF p_postat = 'X' OR p_polac = 'X'. "CH-3245-ECDK927942-315873-Added Po landed cost logic.

    LOOP AT SCREEN.
      CASE screen-group1.
        WHEN 'ZR1' OR 'ZSH' OR 'ZR3'
          OR 'ZR5' .                  "Insert CH-2451-ECDK926220-27-Apr-2023
          screen-active = 1.

*         IF ( screen-group1 = 'ZSH' ) AND ( p_size = 'X' ).
*           screen-active = 0.
*         ENDIF.

          IF screen-group1 = 'ZR3'.
*           IF ( p_sh_pln IS INITIAL ) OR ( p_size = 'X' ).
            IF p_sh_pln IS INITIAL.
              screen-active = 0.
            ENDIF.
          ENDIF.
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
* Deactivate Size radio button alone and the corresponding text field.
          IF ( screen-group1 = 'ZR1' AND p_polac = 'X').
            IF ( screen-name = 'P_SIZE' OR screen-name = '%C141021_1000' ).
              screen-active = 0 .
            ENDIF.
            IF ( screen-name = '%_S_EBELN_%_APP_%-TEXT').
              %_s_ebeln_%_app_%-text = 'Purchase Order Number *'.
            ENDIF.
          ENDIF.
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.

        WHEN 'ZR2'
*Add AP ,26/07/2022, ED1K900279
          OR  'ZR4' .
*End Add
          screen-active = 0.
      ENDCASE.
      MODIFY SCREEN.
    ENDLOOP.
    SET TITLEBAR 'PO Status Report'.

*   IF p_size = 'X'.
*     CLEAR p_sh_pln.
*   ENDIF.

  ELSEIF p_pocpan = 'X'.
    LOOP AT SCREEN.
      CASE screen-group1.
        WHEN 'ZR1' OR 'ZSH' OR 'ZR3'

*Add AP ,26/07/2022, ED1K900279
          OR  'ZR4' OR 'ZR5' .         "Insert CH-2451-ECDK926220-27-Apr-2023
*End Add
          screen-active = 0.
        WHEN 'ZR2'.
          screen-active = 1.
      ENDCASE.
      MODIFY SCREEN.
    ENDLOOP.
    SET TITLEBAR 'PO Cost Analysis Report'.


*Add AP, 26/07/2022,  ED1K900279
  ELSEIF p_pocha  = 'X'.

    LOOP AT SCREEN.
      CASE screen-group1.
        WHEN 'ZR1' OR 'ZSH' OR 'ZR3' OR 'ZR2'
          OR 'ZR5' .                    "Insert CH-2451-ECDK926220-27-Apr-2023
          screen-active = 0.

      ENDCASE.
      MODIFY SCREEN.
    ENDLOOP.
    SET TITLEBAR 'PO Changes Analysis'.
*End Add
  ENDIF.
*INSERT:PJDK925380:29/05/2012:MW - }

  PERFORM f_initialize_variant.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_vari.
  PERFORM f_f4_for_variant.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_zdiort-low.
  PERFORM f_f4_for_po_type.



AT SELECTION-SCREEN.
*  Validating selection screen fields
  PERFORM f_at_selection_screen.
  PERFORM authorization_check.
  IF p_postat = 'X' OR p_polac = 'X'. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
    IF sy-ucomm = 'UC3'.
      IF p_ppk_br = 'X'.
        CLEAR p_sh_pln.
      ENDIF.
    ELSEIF sy-ucomm = 'UC4'.
      IF p_sh_pln = 'X'.
        CLEAR p_ppk_br.
      ENDIF.
    ENDIF.
  ENDIF.


START-OF-SELECTION.
*INSERT:PJDK925380:29/05/2012:MW - {
  IF p_pocpan = 'X'.

    IF s_werks1 EQ '' OR s_ebeln1 EQ ''.
      MESSAGE s016(rp) WITH text-t03 .
      SET SCREEN 0.
      EXIT.
    ELSE.
      PERFORM f_call_cost_variance_rep.
    ENDIF.

  ELSEIF p_postat = 'X'.
*INSERT:PJDK925380:29/05/2012:MW - }
    IF s_werks EQ ''.
      MESSAGE s016(rp) WITH text-t03 .
      SET SCREEN 0.
      EXIT.
    ELSE.
      REFRESH r_del_sch.
      IF p_del = 'X'.
        r_del_sch-low  = ''.
        r_del_sch-sign = 'I'.
        r_del_sch-option = 'EQ'.
        APPEND r_del_sch.
      ENDIF.

      PERFORM clear_data.
      PERFORM fetch_data.

* Begin of changes - ECDK915177 - Pio Fernando
      READ TABLE i_data INTO DATA(lwa_data) INDEX 1.

      SELECT SINGLE spart INTO @DATA(lv_spart)   " can be fetched above
      FROM mara WHERE matnr = @lwa_data-matnr.

      SELECT SINGLE bukrs INTO @DATA(lv_bukrs)   " can be fetched above
      FROM ekko WHERE ebeln = @lwa_data-ebeln.

      zcl_msrp_pricing=>get_salesorg_from_plant(
        EXPORTING
          iv_werks = lwa_data-werks
          iv_matnr = lwa_data-matnr
          iv_bukrs = lv_bukrs
        IMPORTING
          ev_vkorg = gv_vkorg ).

      zcl_msrp_pricing=>check_msrp_change_control(
        EXPORTING
          iv_vkorg  = gv_vkorg
          iv_spart  = lv_spart
        IMPORTING
          ev_active = gv_msrp_control ).
* End of changes - ECDK915177 - Pio Fernando

      IF p_mat = 'X'.
        PERFORM data_material_wise.
        READ TABLE i_data_mat INTO wa_data INDEX 1.
        IF sy-subrc EQ 0.

*Add by Amith 12/06/2020
          IF r_alv = 'X'. "" Default aLV Display
            PERFORM build_layout_rev.
            PERFORM build_field_catalog_rev.
            PERFORM build_sortcat_rev.
            PERFORM display_alv_report_mat.

          ELSE.         "" App. Server Down laod

            IF sy-batch = 'X'.
              IF p_file IS INITIAL.
                MESSAGE 'Please select the layout on the selection screen' TYPE 'I'.
              ELSE.
                PERFORM build_field_catalog_rev.
                PERFORM load_format.
              ENDIF.

            ELSE.
              MESSAGE 'You are not authorized to run the report with download option' TYPE 'I'.
            ENDIF.
          ENDIF.


        ELSE.
          MESSAGE s016(rp) WITH text-t02.
          SET SCREEN 0.
          EXIT.
        ENDIF.
      ELSE.
        PERFORM data_size_wise.
        READ TABLE i_data_size INTO wa_data INDEX 1.
        IF sy-subrc EQ 0.
          PERFORM build_layout_rev.
          PERFORM build_field_catalog_rev.
          PERFORM build_sortcat_rev.
          PERFORM display_alv_report_rev.
        ELSE.
          MESSAGE s016(rp) WITH text-t02.
          SET SCREEN 0.
          EXIT.
        ENDIF.
      ENDIF.
    ENDIF.


*Add AP, 26/07/2022,  ED1K900279
  ELSEIF p_pocha EQ 'X'.

    TYPES: BEGIN OF ty_itab,
             bukrs    LIKE ekko-bukrs,
             ebeln    LIKE eket-ebeln,
             ebelp    LIKE eket-ebelp,
             matnr    LIKE ekpo-matnr,
             etenr    LIKE eket-etenr,
             changenr LIKE cdhdr-changenr,
             udate    LIKE cdhdr-udate,
             utime    LIKE cdhdr-utime,
             username LIKE cdhdr-username,
             chngind  LIKE cdshw-chngind,
             ftext    LIKE cdshw-ftext,
             outlen   LIKE cdshw-outlen,
             fname    LIKE cdshw-fname,
             f_old    LIKE cdshw-f_old,
             f_new    LIKE cdshw-f_new,
           END OF ty_itab.

    DATA: gt_itab TYPE TABLE OF ty_itab,
          gs_itab TYPE ty_itab.
**    PERFORM get_po_changes.

    "" Add AP 20/09/2022, ED1K900503
    IF sl_matnr[] IS NOT INITIAL AND s1_date[] IS INITIAL.
      MESSAGE 'PO creation date can not be blanked' TYPE 'I'.
    ELSE.

*End Add
      PERFORM get_po_changes.
      IF gt_itab[] IS NOT INITIAL.

        IF r_alv = 'X'. "" Default aLV Display
          PERFORM build_layout_poans.
          PERFORM build_field_catalog_poans.
          PERFORM build_sortcat_poans.
          PERFORM display_alv_report_poans.

        ELSE.         "" App. Server Downlaod

          IF sy-batch = 'X'.
            IF p_file IS INITIAL.
              MESSAGE 'Please select the layout on the selection screen' TYPE 'I'.
            ELSE.
              PERFORM build_field_catalog_poans.
              PERFORM load_format_poans.
            ENDIF.

          ELSE.
            MESSAGE 'You are not authorized to run the report with download option' TYPE 'I'.
          ENDIF.
        ENDIF.

      ELSE.
        MESSAGE s016(rp) WITH text-t02.
        SET SCREEN 0.
        EXIT.

      ENDIF.

    ENDIF.

*End Add
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
  ELSEIF p_polac = 'X'.
    IF s_werks EQ '' OR s_ebeln EQ ''.
      MESSAGE s016(rp) WITH text-t03 .
      SET SCREEN 0.
      EXIT.
* Step 1: First fetch for merging data to display PO landed cost
    ELSE.
      REFRESH r_del_sch.
      IF p_del = 'X'.
        r_del_sch-low  = ''.
        r_del_sch-sign = 'I'.
        r_del_sch-option = 'EQ'.
        APPEND r_del_sch.
      ENDIF.

      PERFORM clear_data.
      PERFORM fetch_data.

* Begin of changes - ECDK915177 - Pio Fernando
      READ TABLE i_data INTO DATA(lwa_data_lac) INDEX 1.

      SELECT SINGLE spart INTO @DATA(lv_spart_lac)   " can be fetched above
      FROM mara WHERE matnr = @lwa_data_lac-matnr.

      SELECT SINGLE bukrs INTO @DATA(lv_bukrs_lac)   " can be fetched above
      FROM ekko WHERE ebeln = @lwa_data_lac-ebeln.

      zcl_msrp_pricing=>get_salesorg_from_plant(
        EXPORTING
          iv_werks = lwa_data_lac-werks
          iv_matnr = lwa_data_lac-matnr
          iv_bukrs = lv_bukrs_lac
        IMPORTING
          ev_vkorg = gv_vkorg ).

      zcl_msrp_pricing=>check_msrp_change_control(
        EXPORTING
          iv_vkorg  = gv_vkorg
          iv_spart  = lv_spart_lac
        IMPORTING
          ev_active = gv_msrp_control ).
* End of changes - ECDK915177 - Pio Fernando

      IF p_mat = 'X'.
        PERFORM data_material_wise.
        READ TABLE i_data_mat INTO wa_data INDEX 1.
        IF sy-subrc EQ 0.
* Step 2: Second fetch for merging data to display PO landed cost
          PERFORM f_call_cost_variance_rep.
* Logic addition for Polanded cost.
          PERFORM f_merge_postatus_pocostprice. " Added for CH-3245-ECDK927942-315873-Added Po landed cost logic.
*Add by Amith 12/06/2020
          IF r_alv = 'X'. "" Default aLV Display
            PERFORM build_layout_rev.
            PERFORM build_field_catalog_rev.
            PERFORM build_sortcat_rev.
            PERFORM display_alv_report_mat.

          ELSE.         "" App. Server Down laod

            IF sy-batch = 'X'.
              IF p_file IS INITIAL.
                MESSAGE 'Please select the layout on the selection screen' TYPE 'I'.
              ELSE.
                PERFORM build_field_catalog_rev.
                PERFORM load_format.
              ENDIF.

            ELSE.
              MESSAGE 'You are not authorized to run the report with download option' TYPE 'I'.
            ENDIF.
          ENDIF.

        ELSE.
          MESSAGE s016(rp) WITH text-t02.
          SET SCREEN 0.
          EXIT.
        ENDIF.
      ENDIF.
    ENDIF.

*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
  ENDIF. "<-- PJDK925380:29/05/2012:MW

*&---------------------------------------------------------------------*
*&      Form  clear_data
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM clear_data .

  CLEAR i_data.           REFRESH i_data.
  CLEAR i_data_t.         REFRESH i_data_t.
  CLEAR i_data_mat.       REFRESH i_data_mat.
  CLEAR i_data_size.      REFRESH i_data_size.
  CLEAR i_ekpa.           REFRESH i_ekpa.
  CLEAR i_lifnr.          REFRESH i_lifnr.
  CLEAR i_lfa1.           REFRESH i_lfa1.
  CLEAR i_makt.           REFRESH i_makt.
  CLEAR i_mara.           REFRESH i_mara.
  CLEAR i_konv.           REFRESH i_konv.
  CLEAR i_ekes.           REFRESH i_ekes.
  CLEAR i_mvke.           REFRESH i_mvke.
  CLEAR i_ekpv.           REFRESH i_ekpv.
ENDFORM.                    " clear_data
*&---------------------------------------------------------------------*
*&      Form  fetch_data
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM fetch_data .
  DATA : lv_lines TYPE i.

  TYPES : BEGIN OF t_range,
            sign(1),
            option(2),
            low       LIKE mara-matnr,
            high      LIKE mara-matnr,
          END OF t_range.

  DATA :  lt_smatnr1 TYPE TABLE OF t_range WITH HEADER LINE,
          lt_smatnr2 TYPE TABLE OF t_range WITH HEADER LINE.

  CLEAR: wa_data.

*s_matnr exceeds its range to operate in a select statement.
*Hence this logic is incorporated to maintain the threshold in s_matnr.
  DESCRIBE TABLE s_matnr LINES lv_lines.
  IF lv_lines > 5000.
    lt_smatnr1[] = s_matnr[].
    WHILE lv_lines > 0.

      lt_smatnr2[] = lt_smatnr1[].
      DELETE lt_smatnr2 FROM 5001.

      SELECT ekko~ebeln ekko~ekgrp ekko~lifnr ekko~knumv ekko~zcmsno ekko~zzeindt ekko~zzolla AS zzolla2
        ekko~zzfrsl ekko~zterm ekko~submi       "attSam added on 30th Aug 2012 for first sales flag
        ekpo~zzolla ekko~unsez ekko~aedat ekko~ernam ekko~ihrez ekpo~ebelp ekpo~ebelp AS kposn ekpo~werks ekpo~kunnr AS ekunnr
        ekpo~emlif ekpo~lblkz
        ekpo~zzxportdat ekpo~zzkunnr ekpo~zzvgbel ekpo~lgort ekpo~matnr ekpo~effwr AS amnt_book
        ekpo~elikz ekpo~meins ekpo~evers ekpo~loekz ekpo~netpr ekko~inco1 ekpo~inco1 AS cost_inco1 "chandimaw - 13/07/2012 - add costing inco term
        ekpo~zzofferdat ekpo~zzexfact ekko~zzportentry AS zzportentry2 ekpo~zzportentry ekpo~j_3aexfcm
        ekpo~pstyp     "<-- PJDK925334:24/05/2012:MW
        ekpo~knttp ekpo~zzhanger AS zzhanger_po ekpo~zzfcrdat ekpo~zzonbdat   "<-- PJDK925334:24/05/2012:MW
        ekpo~zzofferdate AS offer_date               " Insert CH-2796-311464-21-Sep-2023
        eket~eindt eket~etenr eket~j_4kscat eket~j_3asize eket~menge AS qty_book eket~j_3aelikz
        eket~wemng AS qty_rcv mara~volum mara~zzkunnr AS zkunnr
        mara~zpre_pack_qty mara~wrkst mara~bismt mara~mtpos_mara mara~zznrfdesc mara~normt mara~spart mara~zzhanger  "Insert ECDK927161-CH-2948-14-Nov-2023
        mara~mstae   "<-- PJDK925334:24/05/2012:MW
        ekpo~bednr     " Added by MahendraP on 2011-03-18
        ekpo~afnam     "Added by SriRam 11/06/2015
        ekko~waers     " YasanthaJ - 17/02/2012 - Ver 17
        eket~j_3anetp  " YasanthaJ - 17/02/2012 - Ver 17
        ekpo~menge           "+PJDK926501  14.08.2012  MP
        mara~mtart           "+PJDK926501  14.08.2012  MP
        ekpo~insmk           "+PJDK928062  26.11.2012  MP
        ekpo~zzdirort         "TD
        ekpo~aedat AS eaedat " +ECDK920591 by SQADIR on 6/12/2020
        mara~zzngendr mara~zznaggrp mara~zzngszgp mara~zznseasn ztseasn~zznseasntxt ztseasn~zyear ztseasn~zzsnyrtxt
        mara~zznprdct mara~zznfabct " sw1
        mara~zznfabrn     "Piyush -9999011257 - Ver:27
        mara~zznrpmnt     "SRIRAM - 9999012212
        mara~zzncoltp mara~zzncuftp mara~zznfapyr mara~zznsilht
        mara~zzncolln mara~zznbrand mara~zznstmth mara~zznevent
* BOC by DGHOSAL on 4/20/2018 for BCBG
        mara~j_3acol
* EOC by DGHOSAL on 4/20/2018 for BCBG
* BOC by RUCHIRA on 7/20/2021 CH-1071
        mara~zzhts1 mara~zzhts1desc
* EOC by RUCHIRA on 7/20/2021 CH-1071
        ztbrand~zznbrandtxt ztbrand~zznbrgrp zroyalty~zprdha
        ekko~reswk ekpo~reslo  "FNT Change NF 10/17/2017
        ekpo~bsgru " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
        ekpo~zzlatecd
        ekko~zzlatecd AS zzlatecd1
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
        ekpo~zexempt
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
        ekpo~zzgohflag "Added for CH-2221 315873 GOH Flag
        mara~zznopdcl  " +Ruchira:06.01.2022 Othr Product Classification

           mara~zznactvt mara~zzntheme mara~zznbkpkd mara~zznbdftn mara~zznbusun mara~zznchorg  mara~zznchar2 mara~zznclass
           mara~zzndenft mara~zzndepmt mara~zznfabat mara~zznfabnm  mara~zznfabst  mara~zznftacc  mara~zznhwtrt mara~zznhemfn
            mara~zznlengt  mara~zznmettp mara~zznpatrn   mara~zznpresn mara~zznprcpt mara~zznprdgr mara~zznstone mara~zznsclas
            mara~zznwaist mara~zznwashy mara~zznwashs mara~zznwasht mara~zznlgopn mara~zznchars mara~zzconstype mara~zznfabrn
             mara~zznfapyr mara~zzhlht mara~zznstmth mara~zznitplt mara~zznnctyp mara~zznsetct mara~zznrpmnt mara~zzshaftht
             mara~zznslvtp mara~zzstdet mara~zznstfsh mara~zzinvstat


        APPENDING CORRESPONDING FIELDS OF TABLE i_data
        FROM ekko INNER JOIN ekpo ON ekko~ebeln = ekpo~ebeln
                  INNER JOIN eket ON ekpo~ebeln = eket~ebeln AND
                                     ekpo~ebelp = eket~ebelp
                  INNER JOIN mara ON ekpo~matnr = mara~matnr
                  LEFT OUTER JOIN ztbrand ON mara~zznbrand = ztbrand~zznbrand
                  LEFT OUTER JOIN ztseasn ON mara~zznseasn = ztseasn~zznseasn
                  LEFT OUTER JOIN zroyalty ON mara~matnr = zroyalty~matnr
           WHERE ekko~ebeln IN s_ebeln AND
*              ekko~ekorg IN s_ekorg AND <-- PJDK925334:24/05/2012:MW
              ekko~ekgrp IN s_ekgrp AND
              ekko~lifnr IN s_lifnr AND
              ekko~aedat IN s_aedat AND
              ekko~ernam IN s_ernam AND
              ekko~inco1 IN s_inco1 AND
              ekko~submi IN s_collec AND
              ekpo~werks IN s_werks AND
              ekpo~lgort IN s_lgort AND "<-- PJDK925334:24/05/2012:MW
              ekpo~matnr IN lt_smatnr2 AND
              ekpo~pstyp IN s_pstyp AND
              ekpo~evers IN s_evers AND
              ekpo~inco1 IN s_cinco1 AND  " chandimaw - 13/07/2012 - add costing inco term
              ekpo~zzxportdat IN s_shpdt AND
              ekpo~j_3aexfcm IN s_exfcm AND "<-- PJDK926297:27/07/2012:MalindaW
              ekpo~afnam IN s_afnam AND     "Added By SriRam
              ekpo~bednr IN s_bednr AND
              ekpo~zzbstnk IN s_zbstnk AND

*Add AP, 31/03/2023
             ekpo~zzlatecd IN s_zlcd AND "" Add AP, ECDK925994

*End Add


* BOC by DGHOSAL on 5/21/2018
              ekpo~zzkunnr IN s_kunnr AND
* EOC by DGHOSAL on 5/21/2018
              ekpo~zzdirort IN s_dirshp AND         "TD
              ekpo~bsgru IN s_bsgru AND       " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
              ekpo~zexempt IN s_exempt AND
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
              eket~eindt IN s_eindt AND
              eket~j_3aelikz IN r_del_sch AND
              ekko~ihrez IN s_ihrez AND
*              tspat~spras EQ 'EN' AND
              mara~zzkunnr IN s_zkunnr AND
              mara~wrkst IN s_wrkst AND
              mara~bismt IN s_bismt AND
              mara~zznbrand IN s_brand AND
              mara~zzncolln IN s_colln AND
              mara~zzngendr IN s_gendr AND
              mara~zznaggrp IN s_aggrp AND
              mara~zzngszgp IN s_gszgp AND
              mara~zznseasn IN s_seasn AND
              mara~zznprdct IN s_prdct AND
        "      mara~zznprdsc IN s_prdsc AND sw1
              mara~zznfabct IN s_fabct AND
              mara~zznfabrn IN s_nfabrn AND    "Piyush -9999011257 - Ver:27
              mara~zznrpmnt IN s_nrpmnt AND    "SRIRAM - 9999012212
              mara~zznstmth IN s_stmth AND
              mara~zznevent IN s_event AND
      ekko~zzdirort IN s_zdiort AND
      mara~zznbusun  IN s_busun AND
      mara~zznprdgr IN s_prdgp AND
      mara~zzndepmt IN s_dempt AND
      mara~zznclass IN s_class AND
      mara~zznsclas IN s_sclass. "Addon CH911

      DELETE lt_smatnr1 FROM  1 TO  5000.
      DESCRIBE TABLE lt_smatnr1 LINES lv_lines.
    ENDWHILE.
  ELSE.
    SELECT ekko~ebeln ekko~ekgrp ekko~lifnr ekko~knumv ekko~zcmsno ekko~zzeindt ekko~zzolla AS zzolla2
      ekko~zzfrsl  ekko~zterm ekko~submi      "attSam added on 30th Aug 2012 for first sales flag
      ekpo~zzolla ekko~unsez ekko~aedat ekko~ernam ekko~ihrez ekpo~ebelp ekpo~ebelp AS kposn ekpo~werks ekpo~kunnr AS ekunnr
      ekpo~emlif ekpo~lblkz
      ekpo~zzxportdat
      ekpo~zzkunnr ekpo~zzvgbel ekpo~lgort ekpo~matnr ekpo~effwr AS amnt_book ekpo~elikz ekpo~meins ekpo~evers
      ekpo~loekz ekpo~netpr ekko~inco1 ekpo~inco1 AS cost_inco1 "chandimaw - 13/07/2012 - add costing inco term
      ekpo~zzofferdat ekpo~zzexfact ekko~zzportentry AS zzportentry2 ekpo~zzportentry ekpo~j_3aexfcm ekpo~pstyp
      ekpo~knttp ekpo~zzhanger AS zzhanger_po ekpo~zzfcrdat ekpo~zzonbdat
      ekpo~zzofferdate AS offer_date                                        " Insert CH-2796-311464-21-Sep-2023
      eket~eindt eket~etenr eket~j_4kscat eket~j_3asize eket~menge AS qty_book eket~j_3aelikz
      eket~wemng AS qty_rcv mara~volum mara~zzkunnr AS zkunnr
      mara~zpre_pack_qty mara~wrkst mara~bismt mara~mtpos_mara mara~zznrfdesc mara~normt mara~spart mara~zzhanger  "Insert ECDK927161-CH-2948-14-Nov-2023
      mara~mstae   "<-- PJDK925334:24/05/2012:MW
      ekpo~bednr     " Added by MahendraP on 2011-03-18
      ekpo~afnam     "Added By SriRam
      ekko~waers     " YasanthaJ - 17/02/2012 - Ver 17
      eket~j_3anetp  " YasanthaJ - 17/02/2012 - Ver 17
      ekpo~menge           "+PJDK926501  14.08.2012  MP
      mara~mtart           "+PJDK926501  14.08.2012  MP
      ekpo~insmk           "+PJDK928062  26.11.2012  MP
      ekpo~zzdirort         "TD
      ekpo~aedat AS eaedat " +ECDK920591 by SQADIR on 6/12/2020
      mara~zzngendr mara~zznaggrp mara~zzngszgp mara~zznseasn ztseasn~zznseasntxt ztseasn~zyear ztseasn~zzsnyrtxt
      mara~zznprdct mara~zznfabct "sw1
      mara~zznfabrn     "Piyush -9999011257 - Ver:27
      mara~zznrpmnt     "SRIRAM -9999012212
      mara~zzncoltp mara~zzncuftp mara~zznfapyr mara~zznsilht
      mara~zzncolln mara~zznbrand mara~zznstmth mara~zznevent " sw1
* BOC by DGHOSAL on 4/20/2018 for BCBG
      mara~j_3acol
* EOC by DGHOSAL on 4/20/2018 for BCBG
* BOC by RUCHIRA on 4/20/2018 for BCBG
      mara~zzhts1 mara~zzhts1desc
* EOC by RUCHIRA on 4/20/2018 for BCBG
      ztbrand~zznbrandtxt ztbrand~zznbrgrp zroyalty~zprdha
      ekko~reswk ekpo~reslo "FNT Change NF 10/17/2017
      ekpo~bsgru " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
      ekpo~zzlatecd
      ekko~zzlatecd AS zzlatecd1  "  if  ekpo~zzlatecd blank get the ekko~zzlatecd
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
      ekpo~zexempt
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
      ekpo~zzgohflag "Added for CH-2221 315873 GOH Flag
       mara~zznopdcl " +Ruchira:06.01.2022 Othr Product Classification



        mara~zznactvt mara~zzntheme mara~zznbkpkd mara~zznbdftn mara~zznbusun mara~zznchorg  mara~zznchar2 mara~zznclass
           mara~zzndenft mara~zzndepmt mara~zznfabat mara~zznfabnm  mara~zznfabst  mara~zznftacc  mara~zznhwtrt mara~zznhemfn
            mara~zznlengt  mara~zznmettp mara~zznpatrn   mara~zznpresn mara~zznprcpt mara~zznprdgr mara~zznstone mara~zznsclas
            mara~zznwaist mara~zznwashy mara~zznwashs mara~zznwasht mara~zznlgopn mara~zznchars mara~zzconstype mara~zznfabrn
             mara~zznfapyr mara~zzhlht mara~zznstmth mara~zznitplt mara~zznnctyp mara~zznsetct mara~zznrpmnt mara~zzshaftht
             mara~zznslvtp mara~zzstdet mara~zznstfsh mara~zzinvstat

      INTO CORRESPONDING FIELDS OF TABLE i_data
      FROM ekko INNER JOIN ekpo ON ekko~ebeln = ekpo~ebeln
                INNER JOIN eket ON ekpo~ebeln = eket~ebeln AND
                                   ekpo~ebelp = eket~ebelp
                INNER JOIN mara ON ekpo~matnr = mara~matnr
                LEFT OUTER JOIN ztbrand ON mara~zznbrand = ztbrand~zznbrand
                LEFT OUTER JOIN ztseasn ON mara~zznseasn = ztseasn~zznseasn
                LEFT OUTER JOIN zroyalty ON mara~matnr = zroyalty~matnr
      WHERE ekko~ebeln IN s_ebeln AND
*            ekko~ekorg IN s_ekorg AND <-- PJDK925334:24/05/2012:MW
            ekko~ekgrp IN s_ekgrp AND
            ekko~lifnr IN s_lifnr AND
            ekko~aedat IN s_aedat AND
            ekko~ernam IN s_ernam AND
            ekko~inco1 IN s_inco1 AND
            ekko~submi IN s_collec AND
            ekpo~werks IN s_werks AND
            ekpo~lgort IN s_lgort AND "<-- PJDK925334:24/05/2012:MW
            ekpo~matnr IN s_matnr AND
            ekpo~pstyp IN s_pstyp AND
            ekpo~evers IN s_evers AND
            ekpo~bednr IN s_bednr AND
            ekpo~zzbstnk IN s_zbstnk AND
* BOC by DGHOSAL on 5/21/2018
            ekpo~zzkunnr IN s_kunnr AND
* EOC by DGHOSAL on 5/21/2018
            ekpo~afnam IN s_afnam AND
            ekpo~inco1 IN s_cinco1 AND  " chandimaw - 13/07/2012 - add costing inco term
            ekpo~j_3aexfcm IN s_exfcm AND "<-- PJDK926297:27/07/2012:MalindaW
            ekpo~zzxportdat IN s_shpdt   AND
            ekpo~zzdirort IN s_dirshp AND         "TD
            ekpo~bsgru IN s_bsgru AND       " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT

*Add AP, 31/03/2023
           ekpo~zzlatecd  IN s_zlcd AND "" Add AP, ECDK925994

*End Add
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
            ekpo~zexempt IN s_exempt AND
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
            eket~eindt      IN s_eindt   AND
            eket~j_3aelikz  IN r_del_sch AND
            ekko~ihrez      IN s_ihrez   AND
            mara~zzkunnr    IN s_zkunnr  AND
            mara~wrkst IN s_wrkst    AND
            mara~bismt IN s_bismt    AND
            mara~zznbrand IN s_brand AND
            mara~zzncolln IN s_colln AND
            mara~zzngendr IN s_gendr AND
            mara~zznaggrp IN s_aggrp AND
            mara~zzngszgp IN s_gszgp AND
            mara~zznseasn IN s_seasn AND
            mara~zznprdct IN s_prdct AND
         "   mara~zznprdsc IN s_prdsc AND sw1
            mara~zznfabct IN s_fabct AND
            mara~zznfabrn IN s_nfabrn AND    "Piyush -9999011257 - Ver:27
            mara~zznrpmnt IN s_nrpmnt AND    " SRIRAM -9999012212
            mara~zznstmth IN s_stmth AND
            mara~zznevent IN s_event AND
    ekko~zzdirort IN s_zdiort AND
         mara~zznbusun  IN s_busun AND
      mara~zznprdgr IN s_prdgp AND
      mara~zzndepmt IN s_dempt AND
      mara~zznclass IN s_class AND
      mara~zznsclas IN s_sclass.. "Addon CH911
  ENDIF.

  CHECK i_data[] IS NOT INITIAL.

* BOC by DGHOSAL on 5/21/2018
* Confirmation Categories: Descriptions
  SELECT * FROM t163f
           INTO TABLE gt_t163f
  WHERE spras = sy-langu.
  IF sy-subrc IS INITIAL.
    SORT gt_t163f BY ebtyp.
  ENDIF.
  IF p_msrp IS NOT INITIAL.
    SELECT * FROM zats_sorg_lbl
    INTO TABLE gt_zats_sorg_lbl.
    IF sy-subrc IS INITIAL.
      SORT gt_zats_sorg_lbl BY vkorg.
    ENDIF.

    SELECT * FROM zats_cust_lbl
    INTO TABLE gt_zats_cust_lbl.
    IF sy-subrc IS INITIAL.
      SORT gt_zats_cust_lbl BY vkorg j_3akvgr8.
    ENDIF.
  ENDIF.
* EOC by DGHOSAL on 5/21/2018

  IF s_mstae[] IS NOT INITIAL.
    DELETE i_data WHERE mstae NOT IN s_mstae.
  ENDIF.
*Start "FNT Change NF 10/17/2017
  IF s_reswk[] IS NOT INITIAL.
    DELETE i_data WHERE reswk NOT IN s_reswk.
  ENDIF.
*End "FNT Change NF 10/17/2017
** End V16 changes asangad 04112011

* chandimaw - 04/03/2011 - option to display deleted orders only
  IF p_d_only = 'X'.
    DELETE i_data WHERE loekz NE 'L'.
  ELSE.
* end chandimaw - 04/03/2011
* delete deleted line items in the Purchase order
    DELETE i_data WHERE loekz NE ''.
  ENDIF.

  IF NOT s_brgrp[] IS INITIAL.
    DELETE i_data WHERE zznbrgrp NOT IN s_brgrp.
  ENDIF.

  IF NOT s_prdha[] IS INITIAL.
    DELETE i_data WHERE zprdha NOT IN s_prdha.
  ENDIF.

*-->+ ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT  Start
*---> select reason for order
  DATA(i_data_cpy) = i_data[].
  SORT i_data_cpy BY bsgru.
  DELETE ADJACENT DUPLICATES FROM i_data_cpy COMPARING bsgru.
  IF i_data_cpy[] IS NOT INITIAL.
    SELECT bsgru, bezei
      FROM tbsgt INTO TABLE @DATA(lt_tbsg)
      FOR ALL ENTRIES IN @i_data_cpy
      WHERE bsgru = @i_data_cpy-bsgru AND
    spras = 'E'.
    IF sy-subrc = 0.
      SORT lt_tbsg.
      FREE: i_data_cpy[].
    ENDIF.
  ENDIF.

*  Boc: CH-1684 : 15-03-2022 DDMMYYY Ruchira Start
  DATA(i_data_c1) = i_data[].
  SORT i_data_c1 BY matnr werks.
  DELETE ADJACENT DUPLICATES FROM i_data_c1 COMPARING matnr werks.
  IF i_data_c1 IS NOT INITIAL.
    CLEAR gi_marc_hts.
    SELECT matnr, werks, zzhts1, zzhts1desc FROM marc
    INTO CORRESPONDING FIELDS OF TABLE @gi_marc_hts
    FOR ALL ENTRIES IN @i_data_c1
    WHERE matnr = @i_data_c1-matnr AND
          werks = @i_data_c1-werks.
    SORT gi_marc_hts BY matnr werks.
  ENDIF.
*  Boc: CH-1684 : 15-03-2022 DDMMYYY Ruchira End
* { Boc - CH-2948-ECDK927161-311464-14-Nov-2023

  SELECT spart, vtext FROM tspat
    INTO TABLE @DATA(lt_div)
    FOR ALL ENTRIES IN @i_data
    WHERE spart EQ  @i_data-spart
    AND spras EQ 'E'.

* } Eoc - CH-2948-ECDK927161-311464-14-Nov-2023

*-->+ ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT  END
  SELECT * INTO TABLE itbrgrp FROM ztbrgrp.
  LOOP AT i_data ASSIGNING <f_data>.

* "{ Boc - ECDK927161-CH-2948-311464-14-Nov-2023
    READ TABLE lt_div ASSIGNING FIELD-SYMBOL(<ls_div>)
     WITH KEY spart = <f_data>-spart.
    IF sy-subrc EQ 0.
      <f_data>-vtext =  <ls_div>-vtext.
    ENDIF.
*  "} Eoc - ECDK927161-CH-2948-311464-14-Nov-2023

    READ TABLE itbrgrp INTO wabrgrp WITH KEY zznbrgrp = <f_data>-zznbrgrp.
    IF sy-subrc = 0.
      <f_data>-zznbrgtp = wabrgrp-zznbrgtp.
    ENDIF.
*-->+ ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT  Start
    READ TABLE lt_tbsg ASSIGNING FIELD-SYMBOL(<fs_tbsg>) WITH KEY bsgru = <f_data>-bsgru.
    IF sy-subrc = 0.
      <f_data>-bezei = <fs_tbsg>-bezei.
    ENDIF.
*-->+ ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT  END
* Begin of Addition For CH-2221 315873 GOH Flag.
    IF <f_data>-zzgohflag = abap_true.
      <f_data>-goh_text = 'YES'.
    ELSE.
      <f_data>-goh_text = 'NO'.
    ENDIF.
* End of Addition For CH-2221 315873 GOH Flag.
  ENDLOOP.

  IF NOT s_brgtp[] IS INITIAL.
    DELETE i_data WHERE zznbrgtp NOT IN s_brgtp.
  ENDIF.

  CHECK i_data[] IS NOT INITIAL.

*{  INSERT  PJDK928062 26.11.2012  MP
  CLEAR : gi_dd07t.
  SELECT ddtext domvalue_l
    INTO CORRESPONDING FIELDS OF TABLE gi_dd07t
    FROM dd07t
    WHERE domname = 'INSMK' AND
  ddlanguage = sy-langu.
*}  INSERT

  PERFORM collect_data.
  PERFORM make_sales_org.
  PERFORM get_mvgr4_data.
  PERFORM get_add_data.
*{  INSERT  PJDK926501  14.08.2012  MP
  IF p_ppk_br EQ 'X'.
    PERFORM get_ppk_data.     "+PJDK926501  14.08.2012  MP
  ENDIF.
*}  INSERT

  IF p_sh_pln = 'X'.
    PERFORM get_shp_plan.
  ENDIF.

* Begin of changes - ECDK922248  Ruchira Sampath
  PERFORM fetch_booking_dates.
* End of changes - ECDK922248 Ruchira Sampath

  i_data_null_so[] = i_data[].

  DELETE i_data_null_so WHERE zzvgbel IS NOT INITIAL.
  SORT i_data_null_so BY matnr.
  DELETE ADJACENT DUPLICATES FROM i_data_null_so COMPARING matnr.
  PERFORM sales_price.

  SELECT * INTO TABLE gt_latecode FROM zlatecode.
  SELECT * INTO TABLE gt_msrp_rates FROM zmsrp_rates.
  SELECT * INTO TABLE gt_plant_control FROM zplant_control.

*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
  PERFORM so_delivery_details.
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
ENDFORM.                    " fetch_data
*&---------------------------------------------------------------------*
*&      Form  get_mvgr4_data
*&---------------------------------------------------------------------*
*       get mvgr1 data
*----------------------------------------------------------------------*
FORM get_mvgr4_data .
  DATA: lv_index TYPE i.
  DATA : i_tvko      TYPE STANDARD TABLE OF tvkwz,
         wa_tvko     TYPE tvkwz,
         i_mvke_copy TYPE STANDARD TABLE OF t_mvke,
         li_kotk984  TYPE TABLE OF kotk984.
  DATA : li_ekpo TYPE TABLE OF ty_ekpo.                     "9999013477
  SORT i_mara BY matnr werks.

  IF  i_mara[] IS NOT INITIAL.
    SELECT a~matnr a~vkorg a~vtweg a~dwerk a~mvgr1
      INTO CORRESPONDING FIELDS OF TABLE i_mvke
      FROM mvke AS a
        FOR ALL ENTRIES IN i_mara
        WHERE a~matnr = i_mara-matnr AND
              a~vkorg IN s_vkorg AND
    a~mvgr1 IN s_mvgr12.

    SORT i_mvke BY matnr vkorg vtweg.
    DELETE ADJACENT DUPLICATES FROM i_mvke COMPARING matnr vkorg vtweg.
  ENDIF.

  SORT i_data BY matnr.

  IF i_mvke[] IS NOT INITIAL.
    LOOP AT i_mvke ASSIGNING <f_mvke>.
      READ TABLE i_data INTO wa_data WITH KEY matnr = <f_mvke>-matnr BINARY SEARCH.
      IF sy-subrc EQ 0.
        lv_index = sy-tabix.

        LOOP AT i_data ASSIGNING <f_data> FROM lv_index.
          IF <f_data>-matnr NE <f_mvke>-matnr.
            EXIT.
          ENDIF.
          <f_data>-mvgr1 = <f_mvke>-mvgr1.
        ENDLOOP.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF s_mvgr12[] IS NOT INITIAL.
    DELETE i_data WHERE mvgr1 IS INITIAL.
  ENDIF.

  IF i_mvke[] IS NOT INITIAL.
    SELECT matnr vkorg j_3asize j_4krcat /afs/refpq j_3apqty
    INTO CORRESPONDING FIELDS OF TABLE i_afsmvke
    FROM /afs/mvke
    FOR ALL ENTRIES IN i_mvke
    WHERE matnr = i_mvke-matnr
      AND vkorg = i_mvke-vkorg
    AND vtweg = i_mvke-vtweg.

    DELETE i_afsmvke WHERE j_3apqty <= 0.
    i_afsmvke_s[] = i_afsmvke[].
  ENDIF.

  IF i_mvke IS NOT INITIAL.
    CLEAR i_mvke_copy.
    i_mvke_copy = i_mvke.
    SORT i_mvke_copy BY mvgr1 ASCENDING.
    DELETE ADJACENT DUPLICATES FROM i_mvke_copy COMPARING mvgr1.

    SELECT mvgr1 bezei
    INTO CORRESPONDING FIELDS OF TABLE i_tvm1t_h
    FROM tvm1t
    FOR ALL ENTRIES IN i_mvke_copy
    WHERE spras = sy-langu AND
    mvgr1 = i_mvke_copy-mvgr1.
  ENDIF.

*  Start of Deletion 9999013477
*  IF i_mvke[] IS NOT INITIAL.
*    SELECT * INTO CORRESPONDING FIELDS OF TABLE li_kotk984
*      FROM kotk984
*      FOR ALL ENTRIES IN i_mvke
*      WHERE kappl = 'V'
*      AND   kschl = 'XVAS'
*      AND   vkorg = i_mvke-vkorg
*      AND   matnr = i_mvke-matnr
*      AND   datbi GE sy-datum.
*
*    IF li_kotk984[] IS NOT INITIAL.
*      SORT li_kotk984 BY matnr.
*      DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING matnr.
*      gi_kotk984_h[]  = li_kotk984[].
*
**     MSRP is geeting from the first record in the j_3avast table for the condition number
*      SORT li_kotk984 BY knumh.
*      DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING knumh.
*
*      SELECT knumh j_3asize j_3atltyp j_3afield1
*        INTO CORRESPONDING FIELDS OF TABLE gi_j_3avast
*        FROM j_3avast
*        FOR ALL ENTRIES IN li_kotk984
*        WHERE knumh     = li_kotk984-knumh
*        AND   j_3atltyp = 'CPM'.
*    ENDIF.
*  ENDIF.
* End of Deletion 9999013477


* BOC by DGHOSAL on 5/21/2018
  IF p_msrp IS NOT INITIAL OR NOT p_asin IS INITIAL.
    IF i_data[] IS NOT INITIAL.
      DATA(li_data) = i_data[].
      DELETE li_data WHERE vkorg IS INITIAL.
      SORT li_data BY vkorg matnr.
      DELETE ADJACENT DUPLICATES FROM li_data COMPARING vkorg matnr.
      SELECT a~matnr a~kunnr a~knumh b~j_3asize b~j_3atltyp a~vkorg b~j_3afield1 b~j_3afield2 INTO TABLE gt_msrp
        FROM kotk980 AS a
        INNER JOIN j_3avast AS b ON a~knumh = b~knumh
        FOR ALL ENTRIES IN li_data
        WHERE a~kappl  = 'V'            AND
              a~kschl  = 'XVAS'         AND
              a~vkorg  = li_data-vkorg   AND
              a~matnr  = li_data-matnr   AND
      a~datbi GE sy-datum.
      IF sy-subrc IS INITIAL.
        SORT gt_msrp BY matnr vkorg kunnr.
      ENDIF.

      REFRESH : li_data[].
      li_data = i_data[].
      DELETE li_data WHERE vkorg IS INITIAL.
      DELETE li_data WHERE j_4kscat IS INITIAL.
      SORT li_data BY vkorg j_4kscat.
      DELETE ADJACENT DUPLICATES FROM li_data COMPARING vkorg j_4kscat.
      IF li_data[] IS NOT INITIAL.
        SELECT vkorg
               kunnr
               j_3akvgr8
               FROM knvv
               INTO TABLE gt_knvv
               FOR ALL ENTRIES IN li_data
               WHERE  vkorg = li_data-vkorg   AND
        j_3akvgr8 = li_data-j_4kscat+0(3).
        IF sy-subrc IS INITIAL.
          SORT gt_knvv BY vkorg j_3akvgr8.
        ENDIF.
      ENDIF.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018

* Start of Addition 9999013477
* Get MSRP
    SORT lt_ekpo BY matnr werks.
    DELETE ADJACENT DUPLICATES FROM lt_ekpo COMPARING matnr werks.
    IF NOT lt_ekpo IS INITIAL.
      SELECT * INTO TABLE li_kotk984
        FROM kotk984
        FOR ALL ENTRIES IN lt_ekpo
        WHERE kappl = 'V'
        AND   kschl = 'XVAS'
        AND   vkorg = lt_ekpo-werks
        AND   matnr = lt_ekpo-matnr
      AND   datbi GE sy-datum.
      IF sy-subrc = 0.
        SORT li_kotk984 BY vkorg matnr.
        DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING vkorg matnr.
        gi_kotk984_h[]  = li_kotk984[].

*MSRP is geeting from the first record in the j_3avast table for the condition number
        SORT li_kotk984 BY knumh.
        DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING knumh.
        SELECT a~knumh a~j_3asize a~j_3atltyp a~j_3afield1
          INTO TABLE gi_j_3avast
          FROM j_3avast AS a INNER JOIN j_3avashd AS b
          ON a~knumh = b~knumh
          FOR ALL ENTRIES IN li_kotk984
          WHERE a~knumh     = li_kotk984-knumh
          AND  a~j_3atltyp = 'CPM'
        AND  b~loevm_ko = space.
        IF sy-subrc = 0.
          SORT gi_j_3avast BY knumh.
        ENDIF.

      ENDIF.

    ENDIF.
*  code commented by Sri Ram 4/02/2015
**  if entry not found in KOTK984 table for EKPO Material then fetch based on TVKWZ
*  li_ekpo[] = lt_ekpo[].
*  SORT li_ekpo BY werks.
*  DELETE ADJACENT DUPLICATES FROM li_ekpo COMPARING werks.
*  IF NOT li_ekpo IS INITIAL.
*    SELECT * FROM tvkwz
*      INTO TABLE lt_tvkwz
*      FOR ALL ENTRIES IN li_ekpo
*      WHERE werks = li_ekpo-werks.
*  ENDIF.
*  CLEAR li_ekpo.
*  li_ekpo[] = lt_ekpo[].
*  SORT li_ekpo BY matnr.
*  DELETE ADJACENT DUPLICATES FROM li_ekpo COMPARING matnr.
*  IF NOT li_ekpo IS INITIAL.
*    SELECT * INTO TABLE li_kotk984
*      FROM kotk984
*      FOR ALL ENTRIES IN lt_ekpo
*      WHERE kappl = 'V'
*      AND   kschl = 'XVAS'
*      AND   matnr = lt_ekpo-matnr
*      AND   datbi GE sy-datum.
*    IF sy-subrc = 0.
*      SORT li_kotk984 BY vkorg matnr.
*      DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING vkorg matnr.
*      lt_kotk984[]  = li_kotk984[].
*  End of code commented by SriRam 04/02/2015
*MSRP is geeting from the first record in the j_3avast table for the condition number
    SORT li_kotk984 BY knumh.
    DELETE ADJACENT DUPLICATES FROM li_kotk984 COMPARING knumh.
    SELECT a~knumh a~j_3asize a~j_3atltyp a~j_3afield1
      INTO TABLE lt_j_3avast
      FROM j_3avast AS a INNER JOIN j_3avashd AS b
      ON a~knumh = b~knumh
      FOR ALL ENTRIES IN li_kotk984
      WHERE a~knumh     = li_kotk984-knumh
      AND  a~j_3atltyp = 'CPM'
    AND  b~loevm_ko = space.
    IF sy-subrc = 0.
      SORT lt_j_3avast BY knumh.
    ENDIF.
*    ENDIF.
  ENDIF.

* End of Addition 9999013477


  CLEAR: i_mvke, i_mvke_copy.
ENDFORM.                    " get_mvgr4_data
*&---------------------------------------------------------------------*
*&      Form  data_material_wise
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM data_material_wise .
  DATA : idx      TYPE i,
         wa_wemng TYPE eket-wemng,
         l_count  TYPE i.
*  DATA: lv_knumv LIKE ekki-knumv.
  DATA: li_data   TYPE TABLE OF t_data,
        li_shppln TYPE STANDARD TABLE OF gt_shppln WITH HEADER LINE.

  CLEAR: i_data_t[].  REFRESH i_data_t[].
  i_data_t[] = i_data[].
  SORT i_data_t BY ebeln ebelp matnr j_3asize eindt.
  SORT i_data BY ebeln ebelp matnr eindt.
  SORT i_ekes BY ebeln ebelp.
  SORT i_sales BY vbeln matnr.
  SORT i_a905 BY vkorg matnr.


* tot mat wise
  CLEAR : wa_data, wa_data_t, v_qty_rcv, v_qty_book, wa_ekes, v_ekes_menge,
          wa_ekes_t, v_kwert. "lv_knumv.



  LOOP AT i_data INTO wa_data.
    idx = sy-tabix.
    wa_data_t = wa_data.
    v_qty_rcv = v_qty_rcv + wa_data-qty_rcv.

    v_qty_book =  v_qty_book + wa_data-qty_book.
* start "FNT Change NF 10/17/2017
    AT NEW ebelp.
      READ TABLE i_ekpv INTO DATA(lwa_ekpv) WITH KEY ebeln =  wa_data_t-ebeln
                                                     ebelp =  wa_data_t-ebelp.

    ENDAT.

    wa_data_t-kunnr  = lwa_ekpv-kunnr.
    wa_data_t-vstel  = lwa_ekpv-vstel.
    wa_data_t-ladgr  = lwa_ekpv-ladgr.
*End "FNT Change NF 10/17/2017


** BoC:CH-1684 Ruchira Start
*    READ TABLE gi_marc_hts ASSIGNING FIELD-SYMBOL(<lfs_marc_hts>)
*                                     WITH KEY matnr = wa_data-matnr
*                                              werks = wa_data-werks BINARY SEARCH.
*    IF sy-subrc EQ 0.
*      wa_data_t-zzhts1     = <lfs_marc_hts>-zzhts1.
*      wa_data_t-zzhts1desc = <lfs_marc_hts>-zzhts1desc.
*    ENDIF.
** BoC:CH-1684 Ruchira End

    AT END OF matnr.
      wa_data_t-qty_rcv  = v_qty_rcv.
      wa_data_t-qty_book = v_qty_book.
* BOC by DGHOSAL on 5/21/2018
*      IF p_del IS NOT INITIAL.
*        READ TABLE i_eket INTO DATA(wa_eket) WITH KEY ebeln =  wa_data_t-ebeln
*                                                      ebelp =  wa_data_t-ebelp.
*        IF sy-subrc EQ 0.
*          wa_data_t-qty_rcv  = wa_eket-wemng.
*        ENDIF.
*        wa_data_t-qty_book = wa_data_t-menge.
*      ENDIF.
* EOC by DGHOSAL on 5/21/2018
      CLEAR : v_qty_rcv, v_qty_book, wa_wemng.

      COLLECT wa_data_t INTO i_data_mat. " APPEND
    ENDAT.
  ENDLOOP.

** Get ZZOLLA from header if item not maintained

  IF it_zzolla_copy[] IS NOT INITIAL.
    SELECT add_info AS zzolla bezei INTO CORRESPONDING FIELDS OF TABLE it_zzolla
      FROM vtadd01t
      FOR ALL ENTRIES IN it_zzolla_copy
      WHERE spras = sy-langu  AND
    add_info = it_zzolla_copy-zzolla.
  ENDIF.
* sum  ekes menge for line item
  LOOP AT i_ekes INTO wa_ekes.
    wa_ekes_t = wa_ekes.
    v_ekes_menge = v_ekes_menge + wa_ekes-menge.
    v_ekes_dabmg = v_ekes_dabmg + wa_ekes-dabmg.

    AT END OF ebelp.
      wa_ekes_t-menge = v_ekes_menge.
      wa_ekes_t-dabmg = v_ekes_dabmg.
      CLEAR v_ekes_menge.
      CLEAR v_ekes_dabmg.

      APPEND wa_ekes_t TO i_ekes_m.
      CLEAR i_ekes_m_tmp. REFRESH i_ekes_m_tmp.
      CLEAR i_ekes_m_h. REFRESH i_ekes_m_h.
      i_ekes_m_tmp = i_ekes_m.
      DELETE ADJACENT DUPLICATES FROM i_ekes_m_tmp COMPARING ebeln ebelp.
      i_ekes_m_h = i_ekes_m_tmp.

      CLEAR i_ekes_m_tmp. REFRESH i_ekes_m_tmp.
      CLEAR i_ekes_m_h2. REFRESH i_ekes_m_h2.
      DELETE ADJACENT DUPLICATES FROM i_ekes_m_tmp COMPARING ebeln ebelp j_3asize.
      i_ekes_m_h2 = i_ekes_m_tmp.
    ENDAT.
  ENDLOOP.
  CLEAR i_mat. REFRESH i_mat.
  CLEAR wa_mat.

  CLEAR i_data_mat2. REFRESH i_data_mat2.
  i_data_mat2 = i_data_mat.
  SORT i_data_mat2 BY knumv.
  DELETE ADJACENT DUPLICATES FROM i_data_mat2 COMPARING knumv. "ebeln ebelp.

* Get pricing conditions not related to po pricing calculation
  REFRESH r_kschl.
  SELECT kschl INTO t683s-kschl
    FROM t683s
    WHERE kvewe = 'A'      AND
          kappl = 'M'      AND
          kalsm = 'XAFSLF' AND
*         kzwiw = 'J'      AND
          kstat = 'X'.

    r_kschl-low    = t683s-kschl.
    r_kschl-option = 'EQ'.
    r_kschl-sign   = 'I'.
    APPEND r_kschl.
  ENDSELECT.

  CLEAR i_konv.  REFRESH i_konv.
  IF NOT i_data_mat2[] IS INITIAL. " i_mat
    SELECT knumv kposn stunr zaehk kwert                    "j_3aetenr
      INTO CORRESPONDING FIELDS OF TABLE i_konv
      FROM konv
      FOR ALL ENTRIES IN  i_data_mat2 " i_mat
      WHERE knumv = i_data_mat2-knumv  AND
            kntyp NE 'V' AND
    kschl NOT IN r_kschl.
  ENDIF.

*Add by AP  12/06/2020
  CLEAR i_release. REFRESH i_release.
  SELECT ebeln frgke frgzu
         INTO CORRESPONDING FIELDS OF TABLE i_release
         FROM ekko
         FOR ALL ENTRIES IN i_data_mat
  WHERE ebeln = i_data_mat-ebeln.

  SORT   i_release BY ebeln frgke .
  DELETE ADJACENT DUPLICATES FROM i_release COMPARING ebeln frgke .

*End Add
*{ Begin of Comment - 311464 - CH-2796-21-Sep-2023
**Add AP 15/07/2022, ED1K900279
*  SELECT zlabel,werks, matnr, offer_date
*         INTO TABLE @DATA(lt_offer_date)
*          FROM zsd_offer_date
*          FOR ALL ENTRIES IN @i_data_mat
*          WHERE werks EQ @i_data_mat-werks AND
*                matnr EQ @i_data_mat-matnr AND
*                zlabel EQ @i_data_mat-lbl.
*
*  SORT lt_offer_date BY werks matnr zlabel.
*  DELETE ADJACENT DUPLICATES FROM lt_offer_date COMPARING werks matnr zlabel.
**End Add

*} End of Comment - 311464 - CH-2796-21-Sep-2023

*-- Begin of changes - ECDK920847 - SQADIR

**PO last Release date
  CLEAR: i_data_temp[], gt_relpo[], gs_relpo.
  i_data_temp[] = i_data_mat[].


  LOOP AT i_data_temp INTO w_data_temp.
    gs_relpo-objectid = w_data_temp-ebeln.
*Release
    CLEAR wa_release.
    READ TABLE i_release INTO wa_release WITH  KEY ebeln = w_data_temp-ebeln BINARY SEARCH.
    IF sy-subrc = 0.
      gs_relpo-frgzu  = wa_release-frgzu. " + SQ 9/28/2020
    ENDIF.

    APPEND gs_relpo TO gt_relpo.
  ENDLOOP.

  SORT gt_relpo.
  DELETE ADJACENT DUPLICATES FROM gt_relpo COMPARING objectid.
  DELETE gt_relpo WHERE frgzu <> 'X'.


  CLEAR: gt_cdpos[], gs_cdpos, gt_cdhdr[], gs_cdhdr.

  IF NOT gt_relpo[] IS INITIAL.
    SELECT objectclas
           objectid
           fname
           changenr INTO CORRESPONDING FIELDS OF TABLE gt_cdpos
           FROM cdpos
          FOR ALL ENTRIES IN gt_relpo
           WHERE objectid =  gt_relpo-objectid AND
                 objectclas = 'EINKBELEG' AND
    fname      = 'FRGKE'.

    SORT gt_cdpos BY objectid changenr DESCENDING.
    DELETE ADJACENT DUPLICATES FROM gt_cdpos COMPARING objectid.
  ENDIF.

  IF NOT gt_cdpos[] IS INITIAL.
    SELECT objectid udate INTO CORRESPONDING FIELDS OF TABLE gt_cdhdr
           FROM cdhdr
      FOR ALL ENTRIES IN gt_cdpos
           WHERE  objectid =  gt_cdpos-objectid AND ""gs_xekko-ebeln AND
                  objectclas = 'EINKBELEG' AND
    changenr   = gt_cdpos-changenr.
    SORT gt_cdhdr BY objectid.
  ENDIF.

*-- End of changes - ECDK920847 - SQADIR



*Add AP 07/02/2022,ECDK923295
**  DATA(i_data_asn) = i_data_mat[].
**  SORT i_data_asn BY ebeln.
**  DELETE ADJACENT DUPLICATES FROM i_data_asn COMPARING ebeln.
**
**  SELECT vbeln, vgbel INTO TABLE @DATA(lt_lips_asn) FROM lips
**         FOR ALL ENTRIES IN @i_data_asn
**         WHERE vgbel = @i_data_asn-ebeln.
**
**  SORT lt_lips_asn BY vbeln vgbel.
**  DELETE ADJACENT DUPLICATES FROM lt_lips_asn COMPARING vbeln vgbel.
**
**  SELECT tknum, vbeln INTO TABLE @DATA(lt_vttp_asn) FROM vttp
**                 FOR ALL ENTRIES IN @lt_lips_asn
**                 WHERE vbeln = @lt_lips_asn-vbeln.
**
**  SORT lt_vttp_asn BY tknum vbeln.
**  DELETE ADJACENT DUPLICATES FROM lt_vttp_asn COMPARING tknum vbeln.
**
**  SELECT tknum, shtyp INTO TABLE @DATA(lt_vttk_asn) FROM vttk
**            FOR ALL ENTRIES IN @lt_vttp_asn
**            WHERE tknum = @lt_vttp_asn-tknum.
**
**  SORT lt_vttk_asn BY tknum shtyp.
**  DELETE ADJACENT DUPLICATES FROM lt_vttk_asn COMPARING tknum shtyp.


*End Add


* Update other fields
  LOOP AT i_data_mat ASSIGNING <f_data>.

    CLEAR: wa_t024, wa_lfa1, wa_makt, wa_ekpa, wa_kna1, wa_mara, wa_vbak,
           wa_ekes,  v_kwert, wa_konv, gs_t141t. "lv_knumv



**Add AP 07/02/2022,ECDK923295
**    READ TABLE lt_lips_asn INTO DATA(ls_lips_asn) WITH KEY vbeln = <f_data>-ebeln.
**    IF sy-subrc EQ 0.
**      READ TABLE lt_vttp_asn INTO DATA(ls_vttp_asn) WITH  KEY vbeln = ls_lips_asn-vbeln.
**      IF sy-subrc EQ 0.
**        READ TABLE lt_vttk_asn INTO DATA(ls_vttk_asn) WITH KEY tknum = ls_vttp_asn-tknum.
**        IF sy-subrc EQ 0.
**          SELECT SINGLE zzdirort INTO @DATA(lv_potyp) FROM likp WHERE vbeln = @ls_lips_asn-vbeln.
**          IF ls_vttk_asn-shtyp EQ 'X001' AND ( lv_potyp EQ 'DSUS' OR lv_potyp EQ 'DSOR' OR lv_potyp EQ 'DSAR'
**                                                  OR lv_potyp EQ 'DSDP' OR lv_potyp EQ 'DENL' OR lv_potyp EQ 'DINL').
***Get the latest IDOCInfo
**
**            SELECT b~role_b INTO TABLE @DATA(lt_role_b)
**         FROM srrelroles AS a INNER JOIN idocrel AS b ON a~roleid = b~role_a
**         WHERE a~roletype = 'OUTBELEG' AND
**               a~objkey    =   @ls_vttk_asn-tknum.
**
**
**            IF lt_role_b IS NOT INITIAL.
**              SELECT objkey INTO TABLE @DATA(lt_idocs) FROM srrelroles
**                     FOR ALL ENTRIES IN @lt_role_b
**                     WHERE roleid = @lt_role_b-role_b.
**
**              SORT lt_idocs BY objkey DESCENDING.
**              READ TABLE lt_idocs  INTO DATA(ls_idocs) INDEX 1.
**
*** Get the Idoc details from edids table
**              SELECT SINGLE docnum,status,statxt, credat INTO @DATA(ls_edids) FROM edids WHERE docnum = @ls_idocs-objkey.
**
**              <f_data>-docnum = ls_edids-docnum.
**              <f_data>-status = ls_edids-status.
**              <f_data>-statxt = ls_edids-statxt.
**              <f_data>-credat = ls_edids-credat.
**
**            ENDIF.
**
**
**          ENDIF.
**
**        ENDIF.
**
**      ENDIF.
**
**    ENDIF.



*End Add



* BoC:CH-1684 Ruchira Start
    READ TABLE gi_marc_hts ASSIGNING FIELD-SYMBOL(<lfs_marc_hts>)
                                     WITH KEY matnr = <f_data>-matnr
                                              werks = <f_data>-werks BINARY SEARCH.
    IF sy-subrc EQ 0.
      <f_data>-zzhts1     = <lfs_marc_hts>-zzhts1.
      <f_data>-zzhts1desc = <lfs_marc_hts>-zzhts1desc.
    ENDIF.
* BoC:CH-1684 Ruchira End


*Add AP 12/06/2020
*Release
    READ TABLE i_release INTO wa_release WITH  KEY ebeln = <f_data>-ebeln.
    <f_data>-frgke  = wa_release-frgke .
    <f_data>-frgzu  = wa_release-frgzu. " + SQ 9/28/2020
*End Add

*{ Begin of Comment - 311464 - CH-2796-21-Sep-2023
**Add AP 15/07/2022,ED1K900279
*    READ TABLE lt_offer_date INTO DATA(ls_offer_date) WITH KEY werks = <f_data>-werks
*                                                               matnr = <f_data>-matnr
*                                                               zlabel = <f_data>-lbl BINARY SEARCH.
*    IF sy-subrc EQ 0.
*      <f_data>-offer_date = ls_offer_date-offer_date.
*
*    ENDIF.
*
**End Add
*} End of Comment - 311464 - CH-2796-21-Sep-2023

*-- Begin of changes - ECDK920847 - SQADIR
    CLEAR gs_cdhdr.
    READ TABLE gt_cdhdr INTO gs_cdhdr WITH KEY objectid =  <f_data>-ebeln BINARY SEARCH.
    IF sy-subrc = 0.
      <f_data>-redat = gs_cdhdr-udate.
    ENDIF.
*-- End of changes - ECDK920847 - SQADIR

* purcg gro name
    READ TABLE i_t024_h INTO wa_t024 WITH TABLE KEY ekgrp = <f_data>-ekgrp.
    <f_data>-eknam = wa_t024-eknam.

* Vendor name
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-lifnr.
    <f_data>-ven_nam = wa_lfa1-name1.

* good sup code
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output.
    <f_data>-lifn2 = wa_ekpa-lifn2.

* good suplier name
    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-lifn2.
    <f_data>-sup_nam = wa_lfa1-name1.
* Country of origin (GS Partner)
    <f_data>-land1 = wa_lfa1-land1.

* MahendraP added on 2011-02-24 to populate data
    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output2.
    <f_data>-ord_lifn2 = wa_ekpa-lifn2.   " Ordering address code

    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-ord_lifn2.
    <f_data>-ord_name1 = wa_lfa1-name1.   " Ordering address name

    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output3.
    <f_data>-pi_lifn2 = wa_ekpa-lifn2.   " Invoicing Party code

    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-pi_lifn2.
    <f_data>-pi_name1 = wa_lfa1-name1.   " Invoicing Party name

* chandimaw - 24/05/2012 - freight forwarder
    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output4.
    <f_data>-cr_lifn2 = wa_ekpa-lifn2.   " Freight Forwarder code

    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-cr_lifn2.
    <f_data>-cr_name1 = wa_lfa1-name1.   " Freight Forwarder name
* end chandimaw - 24/05/2012

* PTO SO acc name
    READ TABLE i_kna1_h INTO wa_kna1 WITH TABLE KEY kunnr = <f_data>-zzkunnr.
    <f_data>-pto_nam = wa_kna1-name1.

* Cust PO # & Customer Due Date
    READ TABLE i_vbak_h INTO wa_vbak WITH TABLE KEY vbeln = <f_data>-zzvgbel.
* BOC by DGHOSAL on 5/21/2018
    IF sy-subrc IS INITIAL.
* EOC by DGHOSAL on 5/21/2018
      <f_data>-bstnk = wa_vbak-bstnk.
      <f_data>-vdatu = wa_vbak-vdatu.
      <f_data>-gueen = wa_vbak-gueen.
      <f_data>-bsark = wa_vbak-bsark. " Added For CH-2237 315873 Add SO PO type in Material PO report
* BOC by DGHOSAL on 5/21/2018
      READ TABLE gt_knvp INTO gs_knvp WITH KEY
                              kunnr = <f_data>-zzkunnr
                              vkorg = wa_vbak-vkorg
                              vtweg = wa_vbak-vtweg
                              spart = wa_vbak-spart
                              kunn2 = <f_data>-ekunnr
                              BINARY SEARCH.
      IF sy-subrc IS INITIAL.
        <f_data>-knref = gs_knvp-knref.
      ENDIF.
    ENDIF.
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button

    READ TABLE gi_ekkn INTO DATA(lwa_ekkn) WITH KEY ebeln =  <f_data>-ebeln
                                                    ebelp =  <f_data>-ebelp.
    IF sy-subrc EQ 0.
      READ TABLE gi_sonet INTO DATA(lwa_sonet) WITH KEY vbeln =  lwa_ekkn-vbeln
                                                        posnr =  lwa_ekkn-vbelp.
      IF sy-subrc EQ 0.
* SO Net Price.
        <f_data>-sonet  = lwa_sonet-netpr.
* SO Value.
        <f_data>-soval  = <f_data>-qty_book * lwa_sonet-netpr.
      ENDIF.
    ENDIF.

* Delivery No
* Check whether it has multiple delivery number for PO and line item.
    DATA(lt_delno) = gi_bkdates.
    DELETE lt_delno WHERE ( ebeln NE <f_data>-ebeln
                    OR      ebelp NE <f_data>-ebelp
                    OR      ebtyp NE 'LA' ) .
* Take a copy of internal table before deleting entries based on delivery.
    DATA(lt_conid) = lt_delno.
* Check for duplicate delivery number associated with PO and item
    SORT lt_delno BY vbeln.
    DELETE ADJACENT DUPLICATES FROM lt_delno COMPARING vbeln.
    DESCRIBE TABLE lt_delno LINES DATA(lv_rowcount).
    READ TABLE lt_delno ASSIGNING FIELD-SYMBOL(<lfs_delno>)
                                  WITH KEY ebeln = <f_data>-ebeln
                                           ebelp = <f_data>-ebelp
                                           ebtyp = 'LA'.
    IF sy-subrc EQ 0.
      <f_data>-delno = COND #( WHEN lv_rowcount > 1 THEN 'MULTIPLE'
                               WHEN lv_rowcount = 1 THEN <lfs_delno>-vbeln ).
    ENDIF.

* Container No
* Check for duplicate Container number associated with PO and item
    SORT lt_conid BY xblnr.
    DELETE ADJACENT DUPLICATES FROM lt_conid COMPARING xblnr.
    DESCRIBE TABLE lt_conid LINES DATA(lv_count).
    READ TABLE lt_conid ASSIGNING FIELD-SYMBOL(<lfs_conid>)
                                  WITH KEY ebeln = <f_data>-ebeln
                                           ebelp = <f_data>-ebelp
                                           ebtyp = 'LA'.
    IF sy-subrc EQ 0.
      <f_data>-conid = COND #( WHEN lv_count > 1 THEN 'MULTIPLE'
                               WHEN lv_count = 1 THEN <lfs_conid>-xblnr ).
    ENDIF.

* Customer Start Date and Customer Cancel Date
    READ TABLE i_sales ASSIGNING FIELD-SYMBOL(<fs_sales>) WITH KEY vbeln = <f_data>-zzvgbel.
    IF sy-subrc EQ 0.
      <f_data>-cusst    = <fs_sales>-vdatu.
      <f_data>-cusca    = <fs_sales>-j_3acada.
    ENDIF.
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button

    READ TABLE i_kna1_h INTO wa_kna1 WITH TABLE KEY kunnr = <f_data>-ekunnr.
    IF sy-subrc IS INITIAL.
      <f_data>-kname_sh = wa_kna1-name1.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018


* label
*    SHIFT <f_data>-j_4kscat LEFT DELETING LEADING space.
    <f_data>-lbl = <f_data>-j_4kscat+0(3).

* mat text
    READ TABLE i_makt_h INTO wa_makt WITH TABLE KEY matnr = <f_data>-matnr.
    <f_data>-maktx = wa_makt-maktx.

*** get mat status text "asangad 11112011 V16
    READ TABLE gt_t141t_h INTO gs_t141t WITH TABLE KEY mmsta = <f_data>-mstae.
    <f_data>-mtstb = gs_t141t-mtstb.

* color descrip
    READ TABLE i_mara_h INTO wa_mara WITH TABLE KEY matnr = <f_data>-matnr.
    <f_data>-normt = wa_mara-normt.

    "$ Region - attSam added on 31.10.2011
*   Sub profit center description
    READ TABLE i_tvm1t_h INTO wa_tvm1t WITH TABLE KEY mvgr1 = <f_data>-mvgr1.
    IF sy-subrc = 0.
      <f_data>-mvgr1_desc = wa_tvm1t-bezei.
    ENDIF.

*   Hanger Description
    CLEAR : wa_zhanger.
    READ TABLE i_zhanger_h INTO wa_zhanger
      WITH TABLE KEY zzhanger = <f_data>-zzhanger.
    IF sy-subrc = 0.
      <f_data>-zzhangerdesc = wa_zhanger-zzhangerdesc.
    ENDIF.
    "$ Endregion - attSam added on 31.10.2011

*   BCBG: Get packaging type from text
    READ TABLE gt_plant_control INTO gw_plant_control WITH KEY werks = <f_data>-werks.
    IF ( sy-subrc = 0 ) AND ( gw_plant_control-zpack_chk = 'X' ).
      IF NOT <f_data>-zzhanger_po IS INITIAL.
        <f_data>-zzhanger = <f_data>-zzhanger_po.

        READ TABLE i_zhanger_h INTO wa_zhanger WITH TABLE KEY zzhanger = <f_data>-zzhanger.
        IF sy-subrc = 0.
          <f_data>-zzhangerdesc = wa_zhanger-zzhangerdesc.
        ELSE.
          CLEAR <f_data>-zzhangerdesc.
        ENDIF.
      ENDIF.

*      CLEAR: gt_lines[], gw_lines, gv_tdname.
*
*      CONCATENATE <f_data>-ebeln <f_data>-ebelp INTO gv_tdname RESPECTING BLANKS.
*
*      CALL FUNCTION 'READ_TEXT'
*        EXPORTING
*          id                      = 'F01'
*          language                = sy-langu
*          name                    = gv_tdname
*          object                  = 'EKPO'
*        TABLES
*          lines                   = gt_lines
*        EXCEPTIONS
*          id                      = 1
*          language                = 2
*          name                    = 3
*          not_found               = 4
*          object                  = 5
*          reference_check         = 6
*          wrong_access_to_archive = 7
*          OTHERS                  = 8.
*
*      READ TABLE gt_lines INTO gw_lines INDEX 1.
*      IF sy-subrc = 0.
*        SPLIT gw_lines-tdline AT ':' INTO gv_split1 gv_split2.
*        CONDENSE gv_split2.
*        gv_split1 = gv_split2(3).
*        IF gv_split1 CO '1234567890 '.
*          <f_data>-zzhanger = gv_split1.
*
*          gw_lines-tdline = gv_split2.
*          CLEAR: gv_split1, gv_split2.
*          SPLIT gw_lines-tdline AT '-' INTO gv_split1 gv_split2.
*          CONDENSE gv_split2.
*
*          IF NOT gv_split2 IS INITIAL.
*            <f_data>-zzhangerdesc = gv_split2.
*          ENDIF.
*        ENDIF.
*      ENDIF.
    ENDIF.

** If item level is not maintained get from header level
    IF <f_data>-zzolla IS INITIAL.
      <f_data>-zzolla = <f_data>-zzolla2.
    ENDIF.

* Ver. 10 Nilmini 07/09/2010 - port of eit name
    CLEAR : wa_zzolla , <f_data>-zzolla_desc.
    IF <f_data>-zzolla IS NOT INITIAL.
      READ TABLE it_zzolla INTO wa_zzolla WITH TABLE KEY zzolla = <f_data>-zzolla.
      IF sy-subrc = 0.
        <f_data>-zzolla_desc = wa_zzolla-bezei.
      ENDIF.
    ENDIF.

*   Late code
    IF <f_data>-zzlatecd IS INITIAL.
      <f_data>-zzlatecd = <f_data>-zzlatecd1.
    ENDIF.

    IF NOT <f_data>-zzlatecd IS INITIAL.
      READ TABLE gt_latecode INTO gw_latecode WITH KEY zlatecd = <f_data>-zzlatecd.
      IF sy-subrc = 0.
        <f_data>-zlatedesc = gw_latecode-zlatedesc.
      ENDIF.
    ENDIF.

** If item level is not maintained get from header level
    IF <f_data>-zzportentry IS INITIAL.
      <f_data>-zzportentry = <f_data>-zzportentry2.
    ENDIF.
** Fill port of entry descriptions
    READ TABLE it_zport ASSIGNING <f_zport>
                         WITH TABLE KEY  zport = <f_data>-zzportentry.
    IF sy-subrc = 0.
      <f_data>-zport_desc = <f_zport>-bezei.
    ENDIF.

    READ TABLE i_t027b_h ASSIGNING <f_t027b>
                         WITH TABLE KEY spras = sy-langu
                                        evers = <f_data>-evers.
    IF sy-subrc = 0.
      <f_data>-evtxt = <f_t027b>-evtxt.
    ENDIF.

* Ship Mode/Shipping Instructions Text.
    READ TABLE i_t027b_h ASSIGNING <f_t027b>
                         WITH TABLE KEY spras = sy-langu
                                        evers = <f_data>-evers.
    IF sy-subrc = 0.
      <f_data>-evtxt = <f_t027b>-evtxt.
    ENDIF.

* Standard Cost/Standard Price.
    READ TABLE i_mbew_h ASSIGNING <f_mbew>
                         WITH  TABLE KEY matnr = <f_data>-matnr
                                   bwkey = <f_data>-werks.
    IF sy-subrc = 0.
      <f_data>-stprs = <f_mbew>-stprs.
    ENDIF.

* Customer SO Cancel Date.
*    READ TABLE i_vbap_h ASSIGNING <f_vbap>
*                         WITH TABLE KEY vbeln = <f_data>-zzvgbel.
*    IF sy-subrc = 0.
*      <f_data>-gueen = <f_vbap>-gueen.
*    ENDIF.

* Profit Center.
    READ TABLE i_marc_h ASSIGNING <f_marc>
                         WITH TABLE KEY matnr = <f_data>-matnr
                                        werks = <f_data>-werks.
    IF sy-subrc = 0.
      <f_data>-prctr = <f_marc>-prctr.
      <f_data>-herkl = <f_marc>-herkl.
    ENDIF.

* Total Canceled(qty booked - qty rcv)
    IF <f_data>-elikz = 'X'.
      IF <f_data>-qty_book > <f_data>-qty_rcv.
        <f_data>-qty_cnc = <f_data>-qty_book - <f_data>-qty_rcv.
      ELSE.
        CLEAR <f_data>-qty_cnc.
      ENDIF.
    ELSE.
      CLEAR <f_data>-qty_cnc.
    ENDIF.

* tot qty in trans
    READ TABLE i_ekes_m_h INTO wa_ekes WITH TABLE KEY ebeln = <f_data>-ebeln
                                                      ebelp = <f_data>-ebelp.

    <f_data>-qty_intra = wa_ekes-menge - wa_ekes-dabmg.

*For Pre-pack Materials
    IF <f_data>-mtpos_mara = 'ERLA'.
      <f_data>-qty_book_pc    = <f_data>-qty_book  * <f_data>-zpre_pack_qty.
      <f_data>-qty_rcv_pc     = <f_data>-qty_rcv   * <f_data>-zpre_pack_qty.
      <f_data>-qty_cnc_pc     = <f_data>-qty_cnc   * <f_data>-zpre_pack_qty.
      <f_data>-qty_intra_pc   = <f_data>-qty_intra * <f_data>-zpre_pack_qty.
    ELSE.
      <f_data>-qty_book_pc    = <f_data>-qty_book.
      <f_data>-qty_rcv_pc     = <f_data>-qty_rcv.
      <f_data>-qty_cnc_pc     = <f_data>-qty_cnc.
      <f_data>-qty_intra_pc   = <f_data>-qty_intra.
    ENDIF.

* WIP Bal (Tot Qty Booked-Tot Qty  Rcv)
    IF <f_data>-elikz = ''.
      <f_data>-qty_wip = <f_data>-qty_book - <f_data>-qty_cnc - <f_data>-qty_rcv.

      <f_data>-wip_vol = <f_data>-qty_wip * <f_data>-volum.
      "This value should always be absolute.Even if the calculation is (-ve), the value should be shown as +ve.
      IF <f_data>-wip_vol < 0.
        <f_data>-wip_vol = <f_data>-wip_vol * -1.
      ENDIF.
    ENDIF.

*For Pre-pack Materials
    IF <f_data>-mtpos_mara = 'ERLA'.
      <f_data>-qty_wip_pc = <f_data>-qty_wip * <f_data>-zpre_pack_qty.
    ELSE.
      <f_data>-qty_wip_pc = <f_data>-qty_wip.
    ENDIF.

* Var PO vs Shipped WIP Bal-Qty In tran
    <f_data>-qty_var = ( <f_data>-qty_rcv + <f_data>-qty_intra + <f_data>-qty_cnc ) - <f_data>-qty_book.
    IF <f_data>-zpre_pack_qty = 0.
      <f_data>-qty_var_pc = <f_data>-qty_var.
    ELSE.
      <f_data>-qty_var_pc = <f_data>-qty_var * <f_data>-zpre_pack_qty.
    ENDIF.

**  Identify the Pre pack materials
    CLEAR wa_afsmvke. "KosalaW:30.08.2010
    IF <f_data>-j_3asize NE ''.
      READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                           j_3asize = <f_data>-j_3asize
                                           j_4krcat = <f_data>-lbl.
      IF sy-subrc NE 0.
        READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                 j_4krcat = <f_data>-lbl
                                                 /afs/refpq  =  'X'.
        IF sy-subrc NE 0.
          READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                 j_3asize = <f_data>-j_3asize
                                                 j_4krcat = ' '.
          IF sy-subrc NE 0.
            READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                     j_4krcat = ' '
                                                    /afs/refpq  =  'X'.
          ENDIF.
        ENDIF.
      ENDIF.

**  Identify the Pre pack materials and Calculate the Pack Qty
    ELSE.
      READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                      j_4krcat = <f_data>-lbl
                                                      /afs/refpq  =  'X'.
      IF sy-subrc NE 0.
        READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                        j_4krcat = ' '
                                                        /afs/refpq  =  'X'.
      ENDIF.
    ENDIF.

    IF sy-subrc = 0.
      <f_data>-tot_ctn = <f_data>-qty_wip DIV wa_afsmvke-j_3apqty.
      <f_data>-j_3apqty = wa_afsmvke-j_3apqty.
    ELSE.
*--------------------------------------------------------------------*
* Total no of Cartons field is dependent on the Pack Qty, I would
* like the report to show Total No of Cartons also to be blank where
* the Pack Qty is blank (zero).
      <f_data>-tot_ctn = 0.
    ENDIF.

    LOOP AT i_konv ASSIGNING <f_konv> WHERE knumv = <f_data>-knumv AND kposn = <f_data>-ebelp.
      v_kwert = v_kwert + <f_konv>-kwert.
    ENDLOOP.

    IF  <f_data>-qty_book > 0.
* PO intransit amount
      <f_data>-amnt_intra = ( v_kwert / <f_data>-qty_book ) * <f_data>-qty_intra.
* Received amnt
      <f_data>-amnt_rcv   = ( v_kwert / <f_data>-qty_book ) * <f_data>-qty_rcv.
* PO open amnt
      <f_data>-amnt_wip   = ( v_kwert / <f_data>-qty_book ) * <f_data>-qty_wip.
    ENDIF.

* BOC by PFERNANDO on 7/23/2018
    SELECT kschl kbetr INTO CORRESPONDING FIELDS OF gwa_fob FROM konv
           WHERE knumv = <f_data>-knumv AND kposn = <f_data>-ebelp.
      IF sy-subrc = 0 AND gwa_fob-kschl = 'XB00'.
*     Total PO Amount in FOB
        <f_data>-tot_po_fob = <f_data>-menge * gwa_fob-kbetr.
        EXIT.
      ENDIF.
    ENDSELECT.
*   Total PO Amount in Standard Cost
    <f_data>-tot_po_std = <f_data>-menge * <f_data>-stprs.
* EOC by PFERNANDO on 7/23/2018

    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_OUTPUT'
      EXPORTING
        input    = <f_data>-meins
        language = sy-langu
      IMPORTING
        output   = <f_data>-meins.

*Read Sales Price
*    READ TABLE i_sales_final INTO wa_sales WITH KEY
*                              vbeln     = <f_data>-zzvgbel
*                              matnr     = <f_data>-matnr.
    READ TABLE i_sales  INTO wa_sales WITH KEY
                             vbeln     = <f_data>-zzvgbel
                             matnr     = <f_data>-matnr
                             BINARY SEARCH.

    IF sy-subrc = 0.
      <f_data>-kbetr = wa_sales-kbetr.
      <f_data>-konwa = wa_sales-waers.

    ELSE.
      CLEAR wa_a905.
      READ TABLE i_a905 INTO wa_a905 WITH KEY vkorg = <f_data>-werks "Sreeram
                                              matnr = <f_data>-matnr BINARY SEARCH.

      IF sy-subrc = 0.
        CLEAR wa_sales_4_a905.
        READ TABLE i_sales_4_a905 INTO wa_sales_4_a905 WITH TABLE KEY knumh = wa_a905-knumh.
        IF sy-subrc = 0.
          <f_data>-kbetr = wa_sales_4_a905-kbetr.
          <f_data>-konwa = wa_sales_4_a905-konwa.
        ENDIF.

*  Code commented by SriRam  9999013477 4/02/2015
*    Addition of code by Sri Ram 9999013477
*    ELSE.
*      CLEAR: <f_data>-kbetr,<f_data>-konwa.
*      LOOP AT lt_tvkwz INTO lw_tvkwz WHERE werks = <f_data>-werks
*                                      AND vkorg <> <f_data>-werks.
*        CLEAR wa_a905.
*        READ TABLE i_a905 INTO wa_a905 WITH KEY vkorg = lw_tvkwz-vkorg
*                                                matnr = <f_data>-matnr BINARY SEARCH.
*        IF sy-subrc = 0.
*          CLEAR wa_sales_4_a905.
*          READ TABLE i_sales_4_a905 INTO wa_sales_4_a905 WITH TABLE KEY knumh = wa_a905-knumh.
*          IF sy-subrc = 0.
*            <f_data>-kbetr = wa_sales_4_a905-kbetr.
*            <f_data>-konwa = wa_sales_4_a905-konwa.
*          ENDIF.
*          EXIT.
*        ENDIF.
*        CLEAR lw_tvkwz.
*      ENDLOOP.
** End of Code commented by SriRam  9999013477 4/02/2015
      ENDIF.
    ENDIF.

* BOC by DGHOSAL on 6/9/2018 for SAP-75
    READ TABLE i_ekes_ibd INTO DATA(ls_ibd) WITH KEY
                               ebeln = <f_data>-ebeln
                               ebelp = <f_data>-ebelp
                               BINARY SEARCH.
    IF sy-subrc IS INITIAL.
      <f_data>-ibd_date = ls_ibd-eindt.
    ENDIF.
* EOC by DGHOSAL on 6/9/2018 for SAP-75

* Begin of changes - ECDK915177 - Pio Fernando
    IF gv_msrp_control IS INITIAL.
* End of changes - ECDK915177 - Pio Fernando

* BOC by DGHOSAL on 5/21/2018
      READ TABLE gt_msrp INTO gs_msrp WITH KEY
                              matnr = <f_data>-matnr
                              vkorg = <f_data>-vkorg
                              kunnr =  <f_data>-zzkunnr
                              BINARY SEARCH.
      IF sy-subrc IS INITIAL.
        <f_data>-msrp = gs_msrp-j_3afield1.
      ELSE.
        READ TABLE gt_zats_sorg_lbl INTO gs_zats_sorg_lbl WITH KEY
                                         vkorg = <f_data>-vkorg
                                         BINARY SEARCH.
        IF sy-subrc IS INITIAL AND gs_zats_sorg_lbl-lbl_apl EQ 'X'.

          LOOP AT gt_zats_cust_lbl INTO gs_zats_cust_lbl WHERE vkorg = <f_data>-vkorg
                                                           AND j_3akvgr8 = <f_data>-j_4kscat+(3).
            READ TABLE gt_msrp INTO gs_msrp WITH KEY
                                 matnr = <f_data>-matnr
                                 vkorg = <f_data>-vkorg
                                 kunnr = gs_zats_cust_lbl-kunnr
                                 BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              <f_data>-msrp = gs_msrp-j_3afield1.
              EXIT.
            ENDIF.

          ENDLOOP.
        ELSE.
          READ TABLE gt_knvv INTO gs_knvv WITH KEY
                             vkorg = <f_data>-vkorg
                             j_3akvgr8 = <f_data>-j_4kscat+(3)
                             BINARY SEARCH.
          IF sy-subrc IS INITIAL.
            READ TABLE gt_msrp INTO gs_msrp WITH KEY
                                matnr = <f_data>-matnr
                                vkorg = <f_data>-vkorg
                                kunnr =  gs_knvv-kunnr
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              <f_data>-msrp = gs_msrp-j_3afield1.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDIF.
      IF <f_data>-msrp IS INITIAL.
* EOC by DGHOSAL on 5/21/2018

        READ TABLE gi_kotk984_h INTO gwa_kotk984 WITH TABLE KEY vkorg   = <f_data>-werks     " EKPO-WERKS added 9999013477
                                                                matnr   = <f_data>-matnr.
        IF sy-subrc EQ 0.
          "     Get MSRP from the the first record for the cond number
          READ TABLE gi_j_3avast INTO gwa_j_3avast WITH KEY knumh = gwa_kotk984-knumh.
          IF sy-subrc EQ 0.
            <f_data>-msrp = gwa_j_3avast-j_3afield1.
          ENDIF.
*      CLEAR <f_data>-msrp.
        ENDIF.
* BOC by DGHOSAL on 5/21/2018
      ENDIF.
* EOC by DGHOSAL on 5/21/2018

*   BCBG: Compare at MSRP
      READ TABLE gt_compat INTO wa_compat WITH KEY matnr = <f_data>-matnr.
*                                                   kunnr = <f_data>-zzkunnr. " CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
      IF ( sy-subrc = 0 ) AND ( NOT wa_compat-j_3afield1 IS INITIAL ).
        <f_data>-msrp_compat = <f_data>-msrp.
        <f_data>-msrp = wa_compat-j_3afield1.
      ENDIF.

* Begin of changes - ECDK915177 - Pio Fernando
    ELSE.
*     MSRP
      IF s_ebeln IS NOT INITIAL.
        READ TABLE i_data_mat2 INTO DATA(lwa_mara) WITH KEY matnr = <f_data>-matnr.

        SELECT SINGLE vbeln INTO @DATA(lv_vbeln) FROM ekkn
        WHERE ebeln = @lwa_mara-ebeln.

        SELECT SINGLE kunnr INTO @DATA(lv_kunnr) FROM vbak
        WHERE vbeln = @lv_vbeln.
      ELSE.
        lv_kunnr = <f_data>-kunnr.
      ENDIF.

      CALL METHOD zcl_msrp_pricing=>get_msrp_price
        EXPORTING
          iv_vkorg                   = <f_data>-vkorg
          iv_kunnr                   = lv_kunnr
          iv_pltyp                   = '*'
          iv_matnr                   = <f_data>-matnr
          iv_all_cond                = abap_true
        IMPORTING
          ev_msrp                    = DATA(lv_msrp)
          ev_curr                    = DATA(lv_curr)
          et_msrp                    = DATA(lt_msrp)
        EXCEPTIONS
          condition_record_not_found = 1
          OTHERS                     = 2.

      IF sy-subrc = 0.
        <f_data>-msrp = lv_msrp.
      ENDIF.

*     Compared at MSRP
      SELECT SINGLE konp~kbetr INTO lv_msrp FROM a901
             INNER JOIN konp ON a901~knumh = konp~knumh
             WHERE a901~kappl = 'V' AND
                   a901~kschl = 'XMSR' AND
                   a901~vkorg = <f_data>-vkorg AND
                   a901~kunnr = gv_factory AND    " Commented CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
*                   a901~kunnr = <f_data>-zzkunnr AND " Added CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
      a901~matnr = <f_data>-matnr.
      IF sy-subrc = 0.
        <f_data>-msrp_compat = <f_data>-msrp.
        <f_data>-msrp = lv_msrp.
      ENDIF.

      IF p_msrp = abap_true.
        LOOP AT lt_msrp INTO DATA(lwa_msrp).

          IF <f_data>-msrp_compat IS NOT INITIAL AND lwa_msrp-waers = 'USD'.
            lwa_msrp-msrp = <f_data>-msrp.
          ENDIF.

          CALL METHOD zcl_msrp_pricing=>get_msrp_curr_sequence
            EXPORTING
              iv_curr = lwa_msrp-waers
            IMPORTING
              ev_seq  = DATA(lv_seq)
            CHANGING
              it_curr = gt_curr[].

          CONCATENATE '<f_data>-msrp_' lv_seq INTO gv_var.
          ASSIGN (gv_var) TO <gv_var>.
          IF <gv_var> IS ASSIGNED.
            <gv_var> = lwa_msrp-msrp.
          ENDIF.

        ENDLOOP.
      ENDIF.
      CLEAR: lt_msrp[], lv_msrp, lv_curr.
    ENDIF.
* End of changes - ECDK915177 - Pio Fernando

* For Parent and Child ASIN Number
    IF p_asin EQ 'X'.
      READ TABLE gt_msrp INTO gs_msrp WITH KEY matnr = <f_data>-matnr
                                               vkorg = <f_data>-vkorg
                                               j_3atltyp = 'PAR'.
      IF sy-subrc IS INITIAL.
        <f_data>-pasin = gs_msrp-j_3afield1.
      ENDIF.
      READ TABLE gt_msrp INTO gs_msrp WITH KEY matnr = <f_data>-matnr
                                         vkorg = <f_data>-vkorg
                                         j_3asize = <f_data>-j_3asize
                                         j_3atltyp = 'CHD'.
      IF sy-subrc IS INITIAL.
        <f_data>-casin = gs_msrp-j_3afield2.
      ENDIF.
    ENDIF.

*   BCBG: Canadian MSRP
    IF NOT <f_data>-msrp IS INITIAL.
      READ TABLE gt_msrp_rates INTO wa_msrp_rates WITH KEY werks = <f_data>-werks
                                                           tcurr = 'CAD'.
      IF sy-subrc = 0.
        <f_data>-msrpcad = <f_data>-msrp.
        gv_msrpcad = <f_data>-msrpcad * wa_msrp_rates-kbetr.
        <f_data>-msrpcad = gv_msrpcad.

        CALL FUNCTION 'ZMSRP_ROUNDING'
          EXPORTING
            zznbrand = <f_data>-zznbrand
            msrp_in  = <f_data>-msrpcad
          IMPORTING
            msrp_out = <f_data>-msrpcad.
      ENDIF.
    ENDIF.




*   BCBG: UPC
***    READ TABLE i_mean_c INTO wa_mean WITH KEY matnr = <f_data>-matnr
***                                            j_3akordx = <f_data>-j_3asize
***                                            /afs/eanblock = <f_data>-j_4kscat.
***    IF sy-subrc NE 0.
***      READ TABLE i_mean_c INTO wa_mean WITH KEY matnr = <f_data>-matnr
***                                              j_3akordx = <f_data>-j_3asize.
***    ENDIF.
***
***    IF sy-subrc = 0.
***      <f_data>-ean11 = wa_mean-ean11.
***
***      CALL FUNCTION 'CONVERSION_EXIT_EAN11_OUTPUT'
***        EXPORTING
***          input  = <f_data>-ean11
***        IMPORTING
***          output = <f_data>-ean11.
***    ENDIF.

*  BoC :    + CH-2685 : Ruchira : 19-July-2023
    CLEAR i_mean_c.
    i_mean_c = i_mean.

    DELETE i_mean_c WHERE matnr     NE <f_data>-matnr.
    DELETE i_mean_c WHERE j_3akordx NE <f_data>-j_3asize.

    DELETE i_mean_c WHERE /afs/eanblock NE <f_data>-j_4kscat  AND
                          /afs/eanblock NE ''.

    CLEAR wa_mean.

    sy-subrc = 4.

    IF <f_data>-j_4kscat IS NOT INITIAL.
      READ TABLE i_mean_c INTO wa_mean WITH KEY /afs/eanblock = <f_data>-j_4kscat
                                                eantp         = 'Z2'.
      IF sy-subrc NE 0.
        READ TABLE i_mean_c INTO wa_mean WITH KEY /afs/eanblock = <f_data>-j_4kscat.

      ENDIF.
    ENDIF.

    IF sy-subrc NE 0.
      READ TABLE i_mean_c INTO wa_mean WITH KEY  eantp         = 'Z2'.
    ENDIF.

    IF sy-subrc NE 0.
      READ TABLE i_mean_c INTO wa_mean INDEX 1.
    ENDIF.

    IF wa_mean-ean11 IS NOT INITIAL.
      <f_data>-ean11 = wa_mean-ean11.

      CALL FUNCTION 'CONVERSION_EXIT_EAN11_OUTPUT'
        EXPORTING
          input  = <f_data>-ean11
        IMPORTING
          output = <f_data>-ean11.
    ENDIF.

*  EoC :    + CH-2685 : Ruchira : 19-July-2023


*   BCBG: French color desc
    READ TABLE gi_color_desc INTO wa_color_desc WITH KEY matnr = <f_data>-matnr
                                                         spras = 'F'.
    IF sy-subrc = 0.
      <f_data>-col_desc_fr = wa_color_desc-zzdesc.
    ENDIF.

* Code commented by SriRam  9999013477 4/02/2015
*  Addition of code by SriRam 9999013477
*    IF <f_data>-msrp IS INITIAL.
*      LOOP AT lt_tvkwz INTO lw_tvkwz WHERE werks = <f_data>-werks .
*
*        READ TABLE lt_kotk984 INTO gwa_kotk984 WITH KEY vkorg   = lw_tvkwz-vkorg
*                                                        matnr   = <f_data>-matnr.
*        IF sy-subrc EQ 0.
*          "     Get MSRP from the the first record for the cond number
*          READ TABLE lt_j_3avast INTO gwa_j_3avast WITH KEY knumh = gwa_kotk984-knumh.
*          IF sy-subrc EQ 0.
*            <f_data>-msrp = gwa_j_3avast-j_3afield1.
*            EXIT.
*          ENDIF.
*        ENDIF.
*      ENDLOOP.
*    ENDIF.
*  End of Addition 9999013477 by Sri Ram
* End of Code commented by SriRam  9999013477 4/02/2015
* INSERT:PJDK925334:24/05/2012:MW Start-02 >>>

*Removed by AP 29/03/2022,  ECDK923697
**    IF <f_data>-pstyp = '5' AND <f_data>-knttp = 'X'.
**      CLEAR <f_data>-lgort.

*End removed
* BOC by DGHOSAL on 5/21/2018
    READ TABLE gt_edicon INTO gs_edicon WITH KEY
                            kunnr = <f_data>-zzkunnr
                            vkorg = wa_vbak-vkorg
                            vtweg = wa_vbak-vtweg
                            spart = wa_vbak-spart
                            BINARY SEARCH.
    IF sy-subrc IS INITIAL.
      <f_data>-dirshp = gs_edicon-dirshp.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018
**    ENDIF. "" Removed by AP
* INSERT:PJDK925334:24/05/2012:MW End-02 <<<

*{  INSERT  PJDK928062  26.11.2012  MP
    CLEAR gwa_dd07t.
    READ TABLE gi_dd07t INTO gwa_dd07t WITH KEY domvalue_l = <f_data>-insmk.
    IF sy-subrc = 0.
      <f_data>-ddtext = gwa_dd07t-ddtext.
    ENDIF.
*}  INSERT

*   6/26/13 - Standardization: Add new field descriptions
*   Gender
    READ TABLE itgendr INTO wagendr WITH KEY zzngendr = <f_data>-zzngendr.
    IF sy-subrc = 0.
      <f_data>-zzngendrtxt = wagendr-zzngendrtxt.
    ENDIF.

*   Age group
    READ TABLE itaggrp INTO waaggrp WITH KEY zznaggrp = <f_data>-zznaggrp.
    IF sy-subrc = 0.
      <f_data>-zznaggrptxt = waaggrp-zznaggrptxt.
    ENDIF.

*   Brand group
    READ TABLE itbrgrp INTO wabrgrp WITH KEY zznbrgrp = <f_data>-zznbrgrp.
    IF sy-subrc = 0.
      <f_data>-zznbrgrptxt = wabrgrp-zznbrgrptxt.
    ENDIF.

*   Brand group type
    READ TABLE itbrgtp INTO wabrgtp WITH KEY zznbrgtp = <f_data>-zznbrgtp.
    IF sy-subrc = 0.
      <f_data>-zznbrgtptxt = wabrgtp-zznbrgtptxt.
    ENDIF.

*   Gender size grp
    READ TABLE itgszgp INTO wagszgp WITH KEY zzngszgp = <f_data>-zzngszgp.
    IF sy-subrc = 0.
      <f_data>-zzngszgptxt = wagszgp-zzngszgptxt.
    ENDIF.

*   Collar Type Description
    READ TABLE itcoltp INTO wacoltp WITH KEY zzncoltp = <f_data>-zzncoltp.
    IF sy-subrc = 0.
      <f_data>-zzncoltptxt = wacoltp-zzncoltptxt.
    ENDIF.

*   Cuff Type Description
    READ TABLE itcuftp INTO wacuftp WITH KEY zzncuftp = <f_data>-zzncuftp.
    IF sy-subrc = 0.
      <f_data>-zzncuftptxt = wacuftp-zzncuftptxt.
    ENDIF.

*   Fashion Pyramid Description
    READ TABLE itfapyr INTO wafapyr WITH KEY zznfapyr = <f_data>-zznfapyr.
    IF sy-subrc = 0.
      <f_data>-zznfapyrtxt = wafapyr-zznfapyrtxt.
    ENDIF.

*   Silhouette Description Description
    READ TABLE itsilht INTO wasilht WITH KEY zznsilht = <f_data>-zznsilht.
    IF sy-subrc = 0.
      <f_data>-zznsilhttxt = wasilht-zznsilhttxt.
    ENDIF.

*   Product category
    READ TABLE itprdct INTO waprdct WITH KEY zznprdct = <f_data>-zznprdct.
    IF sy-subrc = 0.
      <f_data>-zznprdcttxt = waprdct-zznprdcttxt.
    ENDIF.

*   Sub product category
    READ TABLE itprdsc INTO waprdsc WITH KEY zznprdsc = <f_data>-zznprdsc.
    IF sy-subrc = 0.
      <f_data>-zznprdsctxt = waprdsc-zznprdsctxt.
    ENDIF.

*   Fabric
    READ TABLE itfabct INTO wafabct WITH KEY zznfabct = <f_data>-zznfabct.
    IF sy-subrc = 0.
      <f_data>-zznfabcttxt = wafabct-zznfabcttxt.
    ENDIF.

*{ Begin of Change -9999011257 "Piyush Payasi
*   Fabric Concept Text
    READ TABLE i_fabrn WITH KEY zznfabrn = <f_data>-zznfabrn.
    IF sy-subrc = 0.
      <f_data>-zznfabrntxt = i_fabrn-zznfabrntxt.
    ENDIF.
*} End of Change -9999011257
**Start of changes done by SRIRAM."9999012212
    READ TABLE i_nrpmnt WITH KEY zznrpmnt = <f_data>-zznrpmnt.
    IF sy-subrc = 0.
      <f_data>-zznrpmnt = i_nrpmnt-zznrpmnt.
    ENDIF.
**End of changes done by SRIRAM. "9999012212
*   Event
    READ TABLE itevent INTO waevent WITH KEY zznevent = <f_data>-zznevent.
    IF sy-subrc = 0.
      <f_data>-zzneventtxt = waevent-zzneventtxt.
    ENDIF.

*   Collection
    READ TABLE itcolln INTO wacolln WITH KEY zzncolln = <f_data>-zzncolln.
    IF sy-subrc = 0.
      <f_data>-zzncollntxt = wacolln-zzncollntxt.
    ENDIF.

*   Royalty
    READ TABLE itprdha INTO waprdha WITH KEY zzrcode = <f_data>-zprdha.
    IF sy-subrc = 0.
      <f_data>-zzlicdesc = waprdha-zzlicdesc.
      <f_data>-zzprdesc  = waprdha-zzprdesc.
    ENDIF.


* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
    READ TABLE it_ztopdcl ASSIGNING FIELD-SYMBOL(<lfs_ztopdcl>)
                                                WITH KEY zznopdcl = <f_data>-zznopdcl.
    IF sy-subrc = 0.
      <f_data>-zznopdcltxt = <lfs_ztopdcl>-zznopdcltxt.
    ENDIF.
* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

    IF it_cname[] IS NOT INITIAL.
*
      READ TABLE it_cname ASSIGNING <fs_cname> WITH KEY kunnr = <f_data>-zkunnr.
*
      IF sy-subrc EQ 0 .
*
        <f_data>-custname = <fs_cname>-name1.
*
        SHIFT <f_data>-zkunnr LEFT DELETING LEADING '0'.
*
      ENDIF.
*
    ENDIF.
*   AACategory Description
    READ TABLE itadesc INTO wadesc WITH KEY knttp = <f_data>-knttp.
    IF sy-subrc = 0.
      <f_data>-knttx = wadesc-knttx.
    ENDIF.

*   AACategory Description
    READ TABLE itcat INTO wacat WITH KEY pstyp = <f_data>-pstyp.
    IF sy-subrc = 0.
      <f_data>-ptext = wacat-ptext.
    ENDIF.

* Begin of changes - ECDK922248  Ruchira Sampath
    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'AB'.
    IF sy-subrc EQ 0.
      <f_data>-eindt_ab = <lfs_bkdates>-eindt.
      <f_data>-erdat_ab = <lfs_bkdates>-erdat.
      <f_data>-xblnr_ab = <lfs_bkdates>-xblnr.
    ENDIF.

    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates1>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'PB'.
    IF sy-subrc EQ 0.
      <f_data>-eindt_pb = <lfs_bkdates1>-eindt.
      <f_data>-erdat_pb = <lfs_bkdates1>-erdat.
      <f_data>-xblnr_pb = <lfs_bkdates1>-xblnr.
    ENDIF.

    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates2>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'LA'.
    IF sy-subrc EQ 0.
      <f_data>-xblnr_la = <lfs_bkdates2>-xblnr.
    ENDIF.

* End of changes - ECDK922248 Ruchira Sampath

    "sw
    READ TABLE lt_ztactvt INTO DATA(ls_ztactvt) WITH KEY  zznactvt = <f_data>-zznactvt.
    IF sy-subrc = 0.
      <f_data>-zznactvtxt  = ls_ztactvt-zznactvtxt.
    ENDIF.

    READ TABLE lt_zttheme INTO DATA(ls_zttheme) WITH KEY zzntheme = <f_data>-zzntheme.
    IF sy-subrc = 0.
      <f_data>-zznthemetxt  = ls_zttheme-zznthemetxt.
    ENDIF.

    READ TABLE lt_ztbkpkd INTO DATA(ls_ztbkpkd) WITH KEY zznbkpkd = <f_data>-zznbkpkd.
    IF sy-subrc = 0.
      <f_data>-zznbkpkdtxt  = ls_ztbkpkd-zznbkpkdtxt.
    ENDIF.

    READ TABLE lt_ztbdftn INTO DATA(ls_ztbdftn) WITH KEY zznbdftn = <f_data>-zznbdftn.
    IF sy-subrc = 0.
      <f_data>-zznbdftntxt  = ls_ztbdftn-zznbdftntxt.
    ENDIF.

    READ TABLE lt_ztbusun INTO DATA(ls_ztbusun) WITH KEY zznbusun = <f_data>-zznbusun.
    IF sy-subrc = 0.
      <f_data>-zznbusun  = ls_ztbusun-zznbusun.
    ENDIF.

    READ TABLE lt_ztchorg INTO DATA(ls_ztchorg) WITH KEY zznchorg = <f_data>-zznchorg.
    IF sy-subrc = 0.
      <f_data>-zznchorgtxt  = ls_ztchorg-zznchorgtxt.
    ENDIF.

    READ TABLE lt_ztchar2 INTO DATA(ls_ztchar2) WITH KEY zznchar2 = <f_data>-zznchar2.
    IF sy-subrc = 0.
      <f_data>-zznchar2txt  = ls_ztchar2-zznchar2txt.
    ENDIF.

    READ TABLE lt_ztclass INTO DATA(ls_ztclass) WITH KEY zznclass = <f_data>-zznclass.
    IF sy-subrc = 0.
      <f_data>-zznclasstxt  = ls_ztclass-zznclasstxt.
    ENDIF.

    READ TABLE lt_ztdenft INTO DATA(ls_ztdenft) WITH KEY zzndenft = <f_data>-zzndenft.
    IF sy-subrc = 0.
      <f_data>-zzndenfttxt = ls_ztdenft-zzndenfttxt.
    ENDIF.

    READ TABLE lt_ztdepmt INTO DATA(ls_ztdepmt) WITH KEY zzndepmt = <f_data>-zzndepmt.
    IF sy-subrc = 0.
      <f_data>-zzndepmtxt  = ls_ztdepmt-zzndepmtxt.
    ENDIF.

    READ TABLE lt_ztfabat INTO DATA(ls_ztfabat) WITH KEY zznfabat = <f_data>-zznfabat.
    IF sy-subrc = 0.
      <f_data>-zznfabatxt  = ls_ztfabat-zznfabatxt.
    ENDIF.

    READ TABLE lt_ztfabnm INTO DATA(ls_ztfabnm) WITH KEY zznfabnm = <f_data>-zznfabnm.
    IF sy-subrc = 0.
      <f_data>-zznfabnmtxt  = ls_ztfabnm-zznfabnmtxt.
    ENDIF.

    READ TABLE lt_ztfabst INTO DATA(ls_ztfabst) WITH KEY zznfabst = <f_data>-zznfabst.
    IF sy-subrc = 0.
      <f_data>-zznfabstxt = ls_ztfabst-zznfabstxt.
    ENDIF.

    READ TABLE lt_ztftacc INTO DATA(ls_ztftacc) WITH KEY zznftacc = <f_data>-zznftacc.
    IF sy-subrc = 0.
      <f_data>-zznftacctxt  = ls_ztftacc-zznftacctxt.
    ENDIF.

    READ TABLE lt_zthwtrt INTO DATA(ls_zthwtrt) WITH KEY zznhwtrt = <f_data>-zznhwtrt.
    IF sy-subrc = 0.
      <f_data>-zznhwtrttxt  = ls_zthwtrt-zznhwtrttxt.
    ENDIF.

    READ TABLE lt_zthemfn INTO DATA(ls_zthemfn) WITH KEY zznhemfn = <f_data>-zznhemfn.
    IF sy-subrc = 0.
      <f_data>-zznhemfntxt  = ls_zthemfn-zznhemfntxt.
    ENDIF.

    READ TABLE lt_ztlengt INTO DATA(ls_ztlengt) WITH KEY zznlengt = <f_data>-zznlengt.
    IF sy-subrc = 0.
      <f_data>-zznlengtxt  = ls_ztlengt-zznlengtxt.
    ENDIF.

    READ TABLE lt_ztmettp INTO DATA(ls_ztmettp) WITH KEY zznmettp = <f_data>-zznmettp.
    IF sy-subrc = 0.
      <f_data>-zznmettptxt  = ls_ztmettp-zznmettptxt.
    ENDIF.
    READ TABLE lt_ztpatrn INTO DATA(ls_ztpatrn) WITH KEY zznpatrn = <f_data>-zznpatrn.
    IF sy-subrc = 0.
      <f_data>-zznpatrntxt  = ls_ztpatrn-zznpatrntxt.
    ENDIF.

    READ TABLE lt_ztpresn INTO DATA(ls_ztpresn) WITH KEY zznpresn =  <f_data>-zznpresn.
    IF sy-subrc = 0.
      <f_data>-zznpresntxt = ls_ztpresn-zznpresntxt.
    ENDIF.

    READ TABLE lt_ztprcpt  INTO DATA(ls_ztprcpt) WITH KEY zznprcpt = <f_data>-zznprcpt.
    IF sy-subrc = 0.
      <f_data>-zznprcptxt = ls_ztprcpt-zznprcptxt.
    ENDIF.

    READ TABLE lt_ztprdgr INTO DATA(ls_ztprdgr) WITH KEY zznprdgr =  <f_data>-zznprdgr.
    IF sy-subrc = 0.
      <f_data>-zznprdgrtxt = ls_ztprdgr-zznprdgrtxt.
    ENDIF.

    READ TABLE lt_ztstone INTO DATA(ls_ztstone) WITH KEY zznstone = <f_data>-zznstone.
    IF sy-subrc = 0.
      <f_data>-zznstonetxt = ls_ztstone-zznstonetxt.
    ENDIF.

    READ TABLE lt_ztsclas INTO DATA(ls_ztsclas) WITH KEY zznsclas  =  <f_data>-zznsclas .
    IF sy-subrc = 0.
      <f_data>-zznsclastxt = ls_ztsclas-zznsclastxt.
    ENDIF.

    READ TABLE lt_ztwaist INTO DATA(ls_ztwaist) WITH KEY zznwaist =  <f_data>-zznwaist.
    IF sy-subrc = 0.
      <f_data>-zznwaistxt = ls_ztwaist-zznwaistxt.
    ENDIF.
    READ TABLE lt_ztwashy INTO DATA(ls_ztwashy) WITH KEY zznwashy =  <f_data>-zznwashy.
    IF sy-subrc = 0.
      <f_data>-zznwashytxt = ls_ztwashy-zznwashytxt.
    ENDIF.
    READ TABLE lt_ztwashs INTO DATA(ls_ztwashs) WITH KEY zznwashs =  <f_data>-zznwashs.
    IF sy-subrc = 0.
      <f_data>-zznwashstxt = ls_ztwashs-zznwashstxt.
    ENDIF.
    READ TABLE lt_ztwasht INTO DATA(ls_ztwasht) WITH KEY zznwasht =  <f_data>-zznwasht.
    IF sy-subrc = 0.
      <f_data>-zznwashtxt  = ls_ztwasht-zznwashtxt.
    ENDIF.
    READ TABLE lt_ztlgopn INTO DATA(ls_ztlgopn) WITH KEY zznlgopn = <f_data>-zznlgopn.
    IF sy-subrc = 0.
      <f_data>-zznlgopntxt = ls_ztlgopn-zznlgopntxt.
    ENDIF.
    READ TABLE lt_ztsilht INTO DATA(ls_ztsilht) WITH KEY zznsilht =  <f_data>-zznsilht.
    IF sy-subrc = 0.
      <f_data>-zznsilhttxt = ls_ztsilht-zznsilhttxt.
    ENDIF.
    READ TABLE lt_ztchars INTO DATA(ls_ztchars) WITH KEY zznchars = <f_data>-zznchars.
    IF sy-subrc = 0.
      <f_data>-zzncharstxt = ls_ztchars-zzncharstxt.
    ENDIF.
    READ TABLE lt_zconstype INTO DATA(ls_zconstype) WITH KEY zzconstype = <f_data>-zzconstype.
    IF sy-subrc = 0.
      <f_data>-zzconstypedesc = ls_zconstype-zzconstypedesc.
    ENDIF.
    READ TABLE lt_ztfabrn INTO DATA(ls_ztfabrn) WITH KEY zznfabrn = <f_data>-zznfabrn.
    IF sy-subrc = 0.
      <f_data>-zznfabrntxt = ls_ztfabrn-zznfabrntxt.
    ENDIF.
    READ TABLE lt_ztfapyr INTO DATA(ls_ztfapyrn) WITH KEY zznfapyr = <f_data>-zznfapyr.
    IF sy-subrc = 0.
      <f_data>-zznfapyrtxt = ls_ztfapyrn-zznfapyrtxt.
    ENDIF.
    READ TABLE lt_zhlht INTO DATA(ls_zhlht) WITH KEY zzhlht = <f_data>-zzhlht.
    IF sy-subrc = 0.
      <f_data>-zzhlhtdesc = ls_zhlht-zzhlhtdesc.
    ENDIF.
*    READ TABLE lt_ztpresn INTO DATA(ls_ztpresn) WITH KEY zznpresn =  <f_data>-zznpresn.
*    IF sy-subrc = 0.
*      <f_data>-ZZHLHTDESC = ls_ztpresn-ZZHLHTDESC.
*    ENDIF.
*    READ TABLE lt_ZTSTMTH INTO DATA(ls_ZTSTMTH) WITH KEY ZZNSTMTH = <f_data>-ZZNSTMTH.
*    IF sy-subrc = 0.
*      <f_data>-ZZNSTMTHTXT = ls_ztstmth-ZZNSTMTHTXT.
*    ENDIF.
    READ TABLE lt_ztitplt INTO DATA(ls_ztitplt) WITH KEY zznitplt = <f_data>-zznitplt.
    IF sy-subrc = 0.
      <f_data>-zznitplttxt = ls_ztitplt-zznitplttxt.
    ENDIF.
    READ TABLE lt_ztnctyp INTO DATA(ls_ztnctyp) WITH KEY zznnctyp = <f_data>-zznnctyp.
    IF sy-subrc = 0.
      <f_data>-zznnctyptxt = ls_ztnctyp-zznnctyptxt.
    ENDIF.
    READ TABLE lt_ztsetct INTO DATA(ls_ztsetct) WITH KEY zznsetct = <f_data>-zznsetct.
    IF sy-subrc = 0.
      <f_data>-zznsetcttxt = ls_ztsetct-zznsetcttxt.
    ENDIF.

*    READ TABLE lt_ZTRPMNT INTO DATA(ls_ZTRPMNT) WITH KEY ZZNRPMNT = <f_data>-ZZNRPMNT.
*    IF sy-subrc = 0.
*      <f_data>-ZZNRPMNTTXT = ls_ZTRPMNT-ZZNRPMNTTXT.
*    ENDIF.

    READ TABLE lt_zshaftht INTO DATA(ls_zshaftht) WITH KEY zzshaftht = <f_data>-zzshaftht.
    IF sy-subrc = 0.
      <f_data>-zzshafthtdesc = ls_zshaftht-zzshafthtdesc.
    ENDIF.

    READ TABLE lt_ztslvtp INTO DATA(ls_ztslvtp) WITH KEY zznslvtp = <f_data>-zznslvtp.
    IF sy-subrc = 0.
      <f_data>-zznslvtptxt = ls_ztslvtp-zznslvtptxt.
    ENDIF.

    READ TABLE lt_zstdet INTO DATA(ls_zstdet) WITH KEY zzstdet = <f_data>-zzstdet.
    IF sy-subrc = 0.
      <f_data>-zzstdetdesc = ls_zstdet-zzstdetdesc.
    ENDIF.

    READ TABLE lt_ztstfsh INTO DATA(ls_ztstfsh) WITH KEY zznstfsh = <f_data>-zznstfsh.
    IF sy-subrc = 0.
      <f_data>-zznstfshtxt = ls_ztstfsh-zznstfshtxt.
    ENDIF.

    READ TABLE lt_zinvstatus INTO DATA(ls_zinvstatus) WITH KEY zzinvstat = <f_data>-zzinvstat.
    IF sy-subrc = 0.
      <f_data>-zzinvdesc = ls_zinvstatus-zzinvdesc.
    ENDIF.


  ENDLOOP.

* filter by coo
  IF s_herkl[] IS NOT INITIAL.
    DELETE i_data_mat WHERE herkl NOT IN s_herkl.
  ENDIF.

*to filter by profit centre +SP20May2010
  IF s_prctr[] IS NOT INITIAL.
    DELETE i_data_mat WHERE prctr IS INITIAL.
  ENDIF.

*to filter by sub profit centre +SP20May2010
  IF s_mvgr12[] IS NOT INITIAL.
    DELETE i_data_mat WHERE mvgr1 IS INITIAL.
  ENDIF.

  CLEAR wa_data_t.
  IF NOT s_land1 IS INITIAL.
    LOOP AT i_data_mat INTO wa_data_t WHERE lifn2 NE ''.
      IF NOT wa_data_t-land1 IN s_land1.
        DELETE TABLE i_data_mat FROM wa_data_t.
      ENDIF.
    ENDLOOP.
  ENDIF.

*{  INSERT  PJDK926501  14.08.2012  MP
  IF p_ppk_br EQ 'X'.
    CLEAR : li_data[].
    li_data[] = i_data_mat[].
    CLEAR : i_data_mat[].
    LOOP AT li_data INTO wa_data.
      wa_data_t = wa_data.
      APPEND wa_data_t TO i_data_mat.
      IF wa_data-mtart EQ 'XPPK'.
        LOOP AT gi_zpocomp INTO gwa_zpocomp2 WHERE ebeln = wa_data-ebeln
                                              AND ebelp = wa_data-ebelp.
          gwa_zpocomp = gwa_zpocomp2.
          CLEAR : wa_data_t-qty_book,wa_data_t-amnt_book,wa_data_t-netpr,wa_data_t-qty_cnc, wa_data_t-qty_intra,wa_data_t-amnt_intra,
                  wa_data_t-qty_rcv,wa_data_t-amnt_rcv,wa_data_t-qty_wip,wa_data_t-amnt_wip,wa_data_t-qty_var,wa_data_t-stprs,
                  wa_data_t-volum,wa_data_t-wip_vol,wa_data_t-tot_ctn,wa_data_t-kbetr,wa_data_t-qty_book_pc,wa_data_t-qty_cnc_pc,
                  wa_data_t-qty_intra_pc,wa_data_t-qty_rcv_pc,wa_data_t-qty_wip_pc,wa_data_t-qty_var_pc,wa_data_t-j_3apqty,wa_data_t-msrp,
                  wa_data_t-maktx, wa_data_t-zzhanger, wa_data_t-zzhangerdesc,wa_data_t-lbl,wa_data_t-meins,
                  wa_data_t-normt,wa_data_t-zpre_pack_qty,
                  wa_data_t-mstae,wa_data_t-mtstb,wa_data_t-zznrfdesc.


          AT NEW matnr. "" ebelp. ""AP 12/09/2022, ED1K900471 , removed ebelp
            wa_data_t-comp_netpr = gwa_zpocomp-netpr.
          ENDAT.
          wa_data_t-comp_matnr = gwa_zpocomp-matnr.
*  BoC : CH-1778  :Ruchira : 05/06/2022
          READ TABLE gi_compupc ASSIGNING FIELD-SYMBOL(<lfs_compupc>)
                                           WITH KEY matnr     = gwa_zpocomp-matnr
                                                    j_3akordx = gwa_zpocomp-j_3asize BINARY SEARCH.
          IF sy-subrc EQ 0.
*            wa_data_t-ean11 = <lfs_compupc>-ean11.
            wa_data_t-comp_ean11 = <lfs_compupc>-ean11.
          ENDIF.
*  EoC : CH-1778  :Ruchira : 05/06/2022
          wa_data_t-comp_j_3asize = gwa_zpocomp-j_3asize.
          wa_data_t-comp_qty = gwa_zpocomp-menge * wa_data-menge.
          wa_data_t-comp_val = gwa_zpocomp-netpr * wa_data_t-comp_qty.
          APPEND wa_data_t TO i_data_mat.
          CLEAR : gwa_zpocomp, wa_data_t-comp_netpr.
        ENDLOOP.
      ENDIF.
    ENDLOOP.
    FREE li_data.
*}  INSERT

*{  INSERT   PJDK930237  06.05.2013 NR
  ELSEIF p_sh_pln = 'X'.
    CLEAR : li_data[].
    li_data[] = i_data_mat[].
    CLEAR : i_data_mat[].
    SORT li_data BY ebeln ebelp matnr eindt.

*   Rollup shipping plan to material level
    CLEAR li_shppln[].
    LOOP AT gi_shppln INTO gw_shppln.
      READ TABLE li_shppln WITH KEY ebeln = gw_shppln-ebeln
                                    ebelp = gw_shppln-ebelp
                                    xblnr = gw_shppln-xblnr
* BOC by DGHOSAL on 5/21/2018
                                    ebtyp = gw_shppln-ebtyp.
* EOC by DGHOSAL on 5/21/2018
      IF sy-subrc = 0.
        li_shppln-menge = li_shppln-menge + gw_shppln-menge.
        MODIFY li_shppln INDEX sy-tabix.
      ELSE.
        APPEND gw_shppln TO li_shppln.
      ENDIF.
    ENDLOOP.

    LOOP AT li_data INTO wa_data.
      READ TABLE li_shppln INTO gw_shppln WITH KEY ebeln = wa_data-ebeln
                                                   ebelp = wa_data-ebelp.
      IF sy-subrc = 0.
        CLEAR l_count.
        LOOP AT li_shppln INTO gw_shppln WHERE ebeln = wa_data-ebeln AND
                                               ebelp = wa_data-ebelp.
          ADD 1 TO l_count.
          IF l_count = 1.
            wa_data-xblnr = gw_shppln-xblnr.
            wa_data-erdat = gw_shppln-erdat.
            wa_data-eindt_s = gw_shppln-eindt.
            wa_data-menge_s = gw_shppln-menge.
* BOC by DGHOSAL on 5/21/2018
            wa_data-ebtyp = gw_shppln-ebtyp.
            READ TABLE gt_t163f INTO gs_t163f WITH KEY
                                ebtyp = gw_shppln-ebtyp
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              wa_data-ebtxt = gs_t163f-ebtxt.
            ENDIF.
* EOC by DGHOSAL on 5/21/2018
            APPEND wa_data TO i_data_mat.
          ELSE.
            CLEAR : wa_data-qty_book,wa_data-amnt_book,wa_data-netpr,wa_data-qty_cnc, wa_data-qty_intra,wa_data-amnt_intra,
                    wa_data-qty_rcv,wa_data-amnt_rcv,wa_data-qty_wip,wa_data-amnt_wip,wa_data-qty_var,wa_data-stprs,
                    wa_data-volum,wa_data-wip_vol,wa_data-tot_ctn,wa_data-kbetr,wa_data-qty_book_pc,wa_data-qty_cnc_pc,
                    wa_data-qty_intra_pc,wa_data-qty_rcv_pc,wa_data-qty_wip_pc,wa_data-qty_var_pc,wa_data-j_3apqty,wa_data-msrp,
                    wa_data-zpre_pack_qty.

            wa_data-xblnr = gw_shppln-xblnr.
            wa_data-erdat = gw_shppln-erdat.
            wa_data-eindt_s = gw_shppln-eindt.
            wa_data-menge_s = gw_shppln-menge.
* BOC by DGHOSAL on 5/21/2018
            wa_data-ebtyp = gw_shppln-ebtyp.
            READ TABLE gt_t163f INTO gs_t163f WITH KEY
                                ebtyp = gw_shppln-ebtyp
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              wa_data-ebtxt = gs_t163f-ebtxt.
            ENDIF.
* EOC by DGHOSAL on 5/21/2018
            APPEND wa_data TO i_data_mat.
          ENDIF.
        ENDLOOP.

      ELSE.
        APPEND wa_data TO i_data_mat.
      ENDIF.
    ENDLOOP.

    IF NOT s_eindt2[] IS INITIAL.
      DELETE i_data_mat WHERE NOT eindt_s IN s_eindt2.
    ENDIF.

    IF NOT s_erdat[] IS INITIAL.
      DELETE i_data_mat WHERE NOT erdat IN s_erdat.
    ENDIF.
  ENDIF.
*}  INSERT

  "Code Added By SriRam  10/06/2015
  IF s_lgort[] IS NOT INITIAL.
    DELETE i_data_mat WHERE lgort = ''.
  ENDIF.

* To Filter Invoice Party
  IF s_inpty[] IS NOT INITIAL.
    DELETE i_data_mat WHERE pi_lifn2 NOT IN s_inpty.
  ENDIF.

* To Filter Freight Forwarder
  IF s_frfor[] IS NOT INITIAL.
    DELETE i_data_mat WHERE cr_lifn2 NOT IN s_frfor.
  ENDIF.

* To Filter Ordering Address
  IF s_ordar[] IS NOT INITIAL.
    DELETE i_data_mat WHERE ord_lifn2 NOT IN s_ordar.
  ENDIF.

* To Filter Goods Supplier
  IF s_gsupp[] IS NOT INITIAL.
    DELETE i_data_mat WHERE lifn2 NOT IN s_gsupp.
  ENDIF.

  " End of Code Addition.

ENDFORM.                    " data_material_wise
*&---------------------------------------------------------------------*
*&      Form  data_size_wise
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM data_size_wise .
  DATA : idx      TYPE i,
         l_count  TYPE i,
         lv_index TYPE i. "LJ24AUG2010

  DATA : i_data_copy TYPE SORTED TABLE OF t_data WITH NON-UNIQUE KEY ebeln ebelp matnr j_3asize.

  DATA : li_data TYPE TABLE OF t_data.  "+PJDK926501  14.08.2012  MP
*  BoC:Ruchira Sampath:06/08/2021-CH1343
  DATA : li_ekes_size  TYPE STANDARD TABLE OF t_ekes_size,
         lwa_ekes_size TYPE t_ekes_size.
  LOOP AT i_ekes ASSIGNING FIELD-SYMBOL(<lfs_ekes>).
    MOVE-CORRESPONDING <lfs_ekes> TO lwa_ekes_size.
    APPEND lwa_ekes_size TO li_ekes_size.
    CLEAR lwa_ekes_size.
  ENDLOOP.

  SORT li_ekes_size BY ebeln ebelp j_3asize.
*  EoC:Ruchira Sampath:06/08/2021-CH1343

  CLEAR: i_data_t[].  REFRESH i_data_t[].
  CLEAR v_ekes_menge.
  CLEAR v_kwert.
  i_data_t[] = i_data[].
  REFRESH i_data.
  i_data_copy[] = i_data_t.

  SORT i_data_t BY ebeln ebelp matnr j_3asize eindt.
*  SORT i_data BY ebeln ebelp matnr j_3asize eindt.
  SORT i_ekes BY ebeln ebelp j_3asize.
  SORT i_sales BY vbeln matnr j_3asize.
  SORT  i_a905 BY matnr.

* sum  ekes menge for size
*  BoC:Ruchira Sampath:06/08/2021-CH1343
***  LOOP AT i_ekes INTO wa_ekes.
***    wa_ekes_t = wa_ekes.
***    v_ekes_menge = v_ekes_menge + wa_ekes-menge.
***    v_ekes_dabmg = v_ekes_dabmg + wa_ekes-dabmg.
***
***    AT END OF j_3asize.
***      wa_ekes_t-menge = v_ekes_menge.
***      wa_ekes_t-dabmg = v_ekes_dabmg.
***      CLEAR v_ekes_menge.
***      CLEAR v_ekes_dabmg.
***
***      APPEND wa_ekes_t TO i_ekes_m.
***    ENDAT.
***  ENDLOOP.

  LOOP AT li_ekes_size ASSIGNING FIELD-SYMBOL(<lfs_ekes_c>).
*    wa_ekes_t = wa_ekes.
    MOVE-CORRESPONDING <lfs_ekes_c> TO wa_ekes_t.
    v_ekes_menge = v_ekes_menge + <lfs_ekes_c>-menge.
    v_ekes_dabmg = v_ekes_dabmg + <lfs_ekes_c>-dabmg.

    AT END OF j_3asize.
      wa_ekes_t-menge = v_ekes_menge.
      wa_ekes_t-dabmg = v_ekes_dabmg.
      CLEAR v_ekes_menge.
      CLEAR v_ekes_dabmg.

      APPEND wa_ekes_t TO i_ekes_m.
      CLEAR wa_ekes_t.
    ENDAT.
  ENDLOOP.
*  BoC:Ruchira Sampath:06/08/2021-CH1343

  LOOP AT i_data_t INTO wa_data_t.
    idx = sy-tabix.
*    IF NOT wa_data_t-j_3asize IS INITIAL.
    lw_size-j_3asize = wa_data_t-j_3asize.
*    APPEND lw_size TO lt_size.  " NF 08/12/2017
    COLLECT lw_size INTO lt_size.  " NF 08/12/2017
*    ENDIF.
*Start "FNT Change NF 10/17/2017
    AT NEW ebelp.

      READ TABLE i_ekpv INTO DATA(lwa_ekpv) WITH KEY ebeln = wa_data_t-ebeln
                                                     ebelp = wa_data_t-ebelp.
    ENDAT.
*End "FNT Change NF 10/17/2017
    AT END OF matnr.
      CALL FUNCTION 'J_3A_SORT_SIZES'
        EXPORTING
          matnr                 = wa_data_t-matnr
        TABLES
          j_3asosi              = lt_size
        EXCEPTIONS
          j_3asosi_is_empty     = 1
          unable_ascertain_grid = 2
          material_not_found    = 3
          no_grid_found         = 4
          parameter_missing     = 5
          no_sort_for_grid      = 6
          OTHERS                = 7.
      IF sy-subrc <> 0.
      ENDIF.

      LOOP AT lt_size INTO lw_size.
        LOOP AT i_data_copy INTO wa_data WHERE ebeln    = wa_data_t-ebeln AND
                                               ebelp    = wa_data_t-ebelp AND
                                               matnr    = wa_data_t-matnr AND
                                               j_3asize = lw_size-j_3asize.

*          IF wa_data-ebeln = wa_data_t-ebeln
*            AND wa_data-ebelp = wa_data_t-ebelp
*            AND wa_data-matnr = wa_data_t-matnr
*            AND wa_data-j_3asize = lw_size-j_3asize.
*start "FNT Change NF 10/17/2017
          wa_data-kunnr = lwa_ekpv-kunnr.
          wa_data-vstel = lwa_ekpv-vstel.
          wa_data-ladgr = lwa_ekpv-ladgr.
*End "FNT Change NF 10/17/2017
          APPEND wa_data TO i_data_size.
          CLEAR wa_data.
*          ENDIF.
        ENDLOOP.
      ENDLOOP.

      CLEAR : lt_size[], lw_size.
      REFRESH lt_size[].
    ENDAT.
  ENDLOOP.

** change to get ZZOLLA ,if item level is not maintained, get from header level
*  SORT i_data_t BY zzolla.
*  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING zzolla.
  IF it_zzolla_copy[] IS NOT INITIAL.
    SELECT add_info AS zzolla bezei INTO CORRESPONDING FIELDS OF TABLE it_zzolla
      FROM vtadd01t
      FOR ALL ENTRIES IN it_zzolla_copy "data_t
      WHERE spras = sy-langu  AND
    add_info = it_zzolla_copy-zzolla.
  ENDIF.

***** get the i_konv data set ******************
  CLEAR i_data_size2. REFRESH i_data_size2.
  i_data_size2 = i_data_size.
* SORT i_data_mat2 BY ebeln ebelp.
  SORT i_data_size2 BY knumv.
  DELETE ADJACENT DUPLICATES FROM i_data_size2 COMPARING knumv. "ebeln ebelp.

  REFRESH r_kschl.
  SELECT kschl INTO t683s-kschl
    FROM t683s
    WHERE kvewe = 'A'      AND
          kappl = 'M'      AND
          kalsm = 'XAFSLF' AND
*         kzwiw = 'J'
          kstat = 'X'.

    r_kschl-low    = t683s-kschl.
    r_kschl-option = 'EQ'.
    r_kschl-sign   = 'I'.
    APPEND r_kschl.
  ENDSELECT.

  CLEAR i_konv.  REFRESH i_konv.
  IF NOT i_data_size2[] IS INITIAL. " i_mat
    SELECT knumv kposn stunr zaehk kwert                    "j_3aetenr
      INTO CORRESPONDING FIELDS OF TABLE i_konv
      FROM konv
      FOR ALL ENTRIES IN  i_data_size2 " i_mat
      WHERE knumv = i_data_size2-knumv  AND
            kntyp NE 'V' AND
    kschl NOT IN r_kschl.
  ENDIF.

*-- Begin of changes - Add Release Date

*Add by AP  12/06/2020
  IF NOT i_data_size[] IS INITIAL.
    CLEAR i_release. REFRESH i_release.
    SELECT ebeln frgke frgzu
           INTO CORRESPONDING FIELDS OF TABLE i_release
           FROM ekko
           FOR ALL ENTRIES IN i_data_size
    WHERE ebeln = i_data_size-ebeln.

  ENDIF.

  SORT   i_release BY ebeln frgke .
  DELETE ADJACENT DUPLICATES FROM i_release COMPARING ebeln frgke .

*End Add

*{ Begin of Comment - 311464 - CH-2796-21-Sep-2023
**Add AP, 15/07/2022
*  SELECT zlabel,werks, matnr, offer_date
*         INTO TABLE @DATA(lt_offer_date_size)
*          FROM zsd_offer_date
*          FOR ALL ENTRIES IN @i_data_size
*          WHERE werks EQ @i_data_size-werks AND
*                matnr EQ @i_data_size-matnr AND
*                zlabel EQ @i_data_size-lbl.
*
*  SORT lt_offer_date_size BY werks matnr zlabel.
*  DELETE ADJACENT DUPLICATES FROM lt_offer_date_size COMPARING werks matnr zlabel.
*
*
**End Add
*} End of Comment - 311464 - CH-2796-21-Sep-2023

*-- Begin of changes - ECDK920847 - SQADIR

**PO last Release date
  CLEAR: i_data_temp[], gt_relpo[], gs_relpo.
  i_data_temp[] = i_data_size[].


  LOOP AT i_data_temp INTO w_data_temp.
    gs_relpo-objectid = w_data_temp-ebeln.
*Release
    CLEAR wa_release.
    READ TABLE i_release INTO wa_release WITH  KEY ebeln = w_data_temp-ebeln BINARY SEARCH.
    IF sy-subrc = 0.
      gs_relpo-frgzu  = wa_release-frgzu. " + SQ 9/28/2020
    ENDIF.

    APPEND gs_relpo TO gt_relpo.
  ENDLOOP.

  SORT gt_relpo.
  DELETE ADJACENT DUPLICATES FROM gt_relpo COMPARING objectid.
  DELETE gt_relpo WHERE frgzu <> 'X'.


  CLEAR: gt_cdpos[], gs_cdpos, gt_cdhdr[], gs_cdhdr.

  IF NOT gt_relpo[] IS INITIAL.
    SELECT objectclas
           objectid
           fname
           changenr INTO CORRESPONDING FIELDS OF TABLE gt_cdpos
           FROM cdpos
          FOR ALL ENTRIES IN gt_relpo
           WHERE objectid =  gt_relpo-objectid AND
                 objectclas = 'EINKBELEG' AND
    fname      = 'FRGKE'.

    SORT gt_cdpos BY objectid changenr DESCENDING.
    DELETE ADJACENT DUPLICATES FROM gt_cdpos COMPARING objectid.
  ENDIF.

  IF NOT gt_cdpos[] IS INITIAL.
    SELECT objectid udate INTO CORRESPONDING FIELDS OF TABLE gt_cdhdr
           FROM cdhdr
      FOR ALL ENTRIES IN gt_cdpos
           WHERE  objectid =  gt_cdpos-objectid AND ""gs_xekko-ebeln AND
                  objectclas = 'EINKBELEG' AND
    changenr   = gt_cdpos-changenr.
    SORT gt_cdhdr BY objectid.
  ENDIF.

*-- End of changes - ECDK920847 - SQADIR

*-- End of changes - Add Release Date

*Add AP 09/02/2022, ECDK923295
**  DATA(i_data_asn) = i_data_size[].
**  SORT i_data_asn BY ebeln.
**  DELETE ADJACENT DUPLICATES FROM i_data_asn COMPARING ebeln.
**
**  SELECT vbeln, vgbel INTO TABLE @DATA(lt_lips_asn) FROM lips
**         FOR ALL ENTRIES IN @i_data_asn
**         WHERE vgbel = @i_data_asn-ebeln.
**
**  SORT lt_lips_asn BY vbeln vgbel.
**  DELETE ADJACENT DUPLICATES FROM lt_lips_asn COMPARING vbeln vgbel.
**
**  SELECT tknum, vbeln INTO TABLE @DATA(lt_vttp_asn) FROM vttp
**                 FOR ALL ENTRIES IN @lt_lips_asn
**                 WHERE vbeln = @lt_lips_asn-vbeln.
**
**  SORT lt_vttp_asn BY tknum vbeln.
**  DELETE ADJACENT DUPLICATES FROM lt_vttp_asn COMPARING tknum vbeln.
**
**  SELECT tknum, shtyp INTO TABLE @DATA(lt_vttk_asn) FROM vttk
**            FOR ALL ENTRIES IN @lt_vttp_asn
**            WHERE tknum = @lt_vttp_asn-tknum.
**
**  SORT lt_vttk_asn BY tknum shtyp.
**  DELETE ADJACENT DUPLICATES FROM lt_vttk_asn COMPARING tknum shtyp.

*End Add



* fill all other data ti itab
  CLEAR : wa_data, wa_data_t.
  LOOP AT i_data_size ASSIGNING <f_data>.
    CLEAR: wa_t024, wa_lfa1, wa_makt, wa_ekpa, wa_kna1, wa_mara, wa_vbak,
           wa_ekes.
    CLEAR v_kwert.                                              "gajaba 20090820

*-- Begin of changes - ECDK920847 - SQADIR
    CLEAR gs_cdhdr.
    READ TABLE gt_cdhdr INTO gs_cdhdr WITH KEY objectid =  <f_data>-ebeln BINARY SEARCH.
    IF sy-subrc = 0.
      <f_data>-redat = gs_cdhdr-udate.
    ENDIF.
*-- End of changes - ECDK920847 - SQADIR
* BoC:CH-1684 Ruchira Start
    READ TABLE gi_marc_hts ASSIGNING FIELD-SYMBOL(<lfs_marc_hts>)
                                     WITH KEY matnr = <f_data>-matnr
                                              werks = <f_data>-werks BINARY SEARCH.
    IF sy-subrc EQ 0.
      <f_data>-zzhts1     = <lfs_marc_hts>-zzhts1.
      <f_data>-zzhts1desc = <lfs_marc_hts>-zzhts1desc.
    ENDIF.
* BoC:CH-1684 Ruchira End
*{ Begin of Comment - 311464 - CH-2796-21-Sep-2023
**Add AP 15/07/2022,ED1K900279
*    READ TABLE lt_offer_date_size INTO DATA(ls_offer_date_size) WITH KEY werks = <f_data>-werks
*                                                                         matnr = <f_data>-matnr
*                                                                         zlabel = <f_data>-lbl BINARY SEARCH.
*    IF sy-subrc EQ 0.
*      <f_data>-offer_date = ls_offer_date_size-offer_date.
*    ENDIF.
*
**End Add
*} End of Comment - 311464 - CH-2796-21-Sep-2023

*Add AP 09/02/2022, ECDK923295
**    READ TABLE lt_lips_asn INTO DATA(ls_lips_asn) WITH KEY vbeln = <f_data>-ebeln.
**    IF sy-subrc EQ 0.
**      READ TABLE lt_vttp_asn INTO DATA(ls_vttp_asn) WITH  KEY vbeln = ls_lips_asn-vbeln.
**      IF sy-subrc EQ 0.
**        READ TABLE lt_vttk_asn INTO DATA(ls_vttk_asn) WITH KEY tknum = ls_vttp_asn-tknum.
**        IF sy-subrc EQ 0.
**          SELECT SINGLE zzdirort INTO @DATA(lv_potyp) FROM likp WHERE vbeln = @ls_lips_asn-vbeln.
**          IF ls_vttk_asn-shtyp EQ 'X001' AND ( lv_potyp EQ 'DSUS' OR lv_potyp EQ 'DSOR' OR  lv_potyp EQ 'DSAR' OR lv_potyp EQ 'DENL' OR lv_potyp EQ 'DINL'
**                                               OR lv_potyp EQ 'DSDP').
***Get the latest IDOCInfo
**
**            SELECT b~role_b INTO TABLE @DATA(lt_role_b)
**         FROM srrelroles AS a INNER JOIN idocrel AS b ON a~roleid = b~role_a
**         WHERE a~roletype = 'OUTBELEG' AND
**               a~objkey    =   @ls_vttk_asn-tknum.
**
**
**            IF lt_role_b IS NOT INITIAL.
**              SELECT objkey INTO TABLE @DATA(lt_idocs) FROM srrelroles
**                     FOR ALL ENTRIES IN @lt_role_b
**                     WHERE roleid = @lt_role_b-role_b.
**
**              SORT lt_idocs BY objkey DESCENDING.
**              READ TABLE lt_idocs  INTO DATA(ls_idocs) INDEX 1.
**
*** Get the Idoc details from edids table
**              SELECT SINGLE docnum,status,statxt, credat INTO @DATA(ls_edids) FROM edids WHERE docnum = @ls_idocs-objkey.
**
**              <f_data>-docnum = ls_edids-docnum.
**              <f_data>-status = ls_edids-status.
**              <f_data>-statxt = ls_edids-statxt.
**              <f_data>-credat = ls_edids-credat.
**
**            ENDIF.
**
**
**          ENDIF.
**
**        ENDIF.
**
**      ENDIF.
**
**    ENDIF.



*End Add

* purcg gro name
    READ TABLE i_t024_h INTO wa_t024 WITH KEY ekgrp = <f_data>-ekgrp.
    <f_data>-eknam = wa_t024-eknam.
* Vendor name
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH KEY lifnr = <f_data>-lifnr.
    <f_data>-ven_nam = wa_lfa1-name1.
*{+9999007701:13062012:AsithaG
    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output4.
    <f_data>-cr_lifn2 = wa_ekpa-lifn2.   " Freight Forwarder code
    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-cr_lifn2.
    <f_data>-cr_name1 = wa_lfa1-name1.   " Freight Forwarder name
*}+9999007701:13062012:AsithaG-END

* good sup code
    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH KEY ebeln = <f_data>-ebeln parvw = v_output." +PJDK919297 09.06.2011 PR
    <f_data>-lifn2 = wa_ekpa-lifn2.

    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output2.
    <f_data>-ord_lifn2 = wa_ekpa-lifn2.   " Ordering address code

    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-ord_lifn2.
    <f_data>-ord_name1 = wa_lfa1-name1.   " Ordering address name

    CLEAR wa_ekpa.
    READ TABLE i_ekpa_h INTO wa_ekpa WITH TABLE KEY ebeln = <f_data>-ebeln parvw = v_output3.
    <f_data>-pi_lifn2 = wa_ekpa-lifn2.   " Invoicing Party code

    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH TABLE KEY lifnr = <f_data>-pi_lifn2.
    <f_data>-pi_name1 = wa_lfa1-name1.   " Invoicing Party name

* good suplier nam
    CLEAR wa_lfa1.
    READ TABLE i_lfa1_h INTO wa_lfa1 WITH KEY lifnr = <f_data>-lifn2.
    <f_data>-sup_nam = wa_lfa1-name1.
* Country of origin (GS Partner)
    <f_data>-land1 = wa_lfa1-land1.

* PTO SO acc name
    READ TABLE i_kna1_h INTO wa_kna1 WITH KEY kunnr = <f_data>-zzkunnr.
    <f_data>-pto_nam = wa_kna1-name1.

* Cust PO #
**    READ TABLE i_vbak INTO wa_vbak WITH KEY vbeln = <f_data>-zzvgbel.
*    READ TABLE i_vbak_h INTO wa_vbak WITH KEY vbeln = <f_data>-zzvgbel.
*    <f_data>-bstnk = wa_vbak-bstnk.

* label
*    SHIFT <f_data>-j_4kscat LEFT DELETING LEADING space.
    <f_data>-lbl = <f_data>-j_4kscat+0(3).

* mat text
    READ TABLE i_makt_h INTO wa_makt WITH KEY matnr = <f_data>-matnr.
    <f_data>-maktx = wa_makt-maktx.

*** get mat status text
    READ TABLE gt_t141t_h INTO gs_t141t WITH TABLE KEY mmsta = <f_data>-mstae.
    <f_data>-mtstb = gs_t141t-mtstb.

* color descrip
    READ TABLE i_mara_h INTO wa_mara WITH KEY matnr = <f_data>-matnr.
    <f_data>-normt = wa_mara-normt.

* Cust PO # & Customer Due Date
    READ TABLE i_vbak_h INTO wa_vbak WITH KEY vbeln = <f_data>-zzvgbel.
* BOC by DGHOSAL on 5/21/2018
    IF sy-subrc IS INITIAL.
* EOC by DGHOSAL on 5/21/2018
      <f_data>-bstnk = wa_vbak-bstnk.
      <f_data>-vdatu = wa_vbak-vdatu.
      <f_data>-gueen = wa_vbak-gueen.
* BOC by DGHOSAL on 5/21/2018
      READ TABLE gt_knvp INTO gs_knvp WITH KEY
                              kunnr = <f_data>-zzkunnr
                              vkorg = wa_vbak-vkorg
                              vtweg = wa_vbak-vtweg
                              spart = wa_vbak-spart
                              kunn2 = <f_data>-ekunnr
                              BINARY SEARCH.
      IF sy-subrc IS INITIAL.
        <f_data>-knref = gs_knvp-knref.
      ENDIF.
    ENDIF.
    READ TABLE i_kna1_h INTO wa_kna1 WITH TABLE KEY kunnr = <f_data>-ekunnr.
    IF sy-subrc IS INITIAL.
      <f_data>-kname_sh = wa_kna1-name1.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018
* Standard Cost/Standard Price.
    READ TABLE i_mbew_h ASSIGNING <f_mbew>
                         WITH TABLE KEY matnr = <f_data>-matnr
                                        bwkey = <f_data>-werks.

    IF sy-subrc = 0.
      <f_data>-stprs = <f_mbew>-stprs.
    ENDIF.

* Ship Mode/Shipping Instructions Text.
    READ TABLE i_t027b_h ASSIGNING <f_t027b>
                         WITH TABLE KEY spras = sy-langu
                                        evers = <f_data>-evers.
    IF sy-subrc = 0.
      <f_data>-evtxt = <f_t027b>-evtxt.
    ENDIF.

**LJ24AUG2010 If item level is not maintained get from header level
    IF <f_data>-zzolla IS INITIAL.
      <f_data>-zzolla = <f_data>-zzolla2.
    ENDIF.
*  port of eit name
    CLEAR wa_zzolla.
    IF <f_data>-zzolla IS NOT INITIAL.
      READ TABLE it_zzolla INTO wa_zzolla WITH TABLE KEY zzolla = <f_data>-zzolla.
      IF sy-subrc = 0.
        <f_data>-zzolla_desc = wa_zzolla-bezei.
      ENDIF.
    ENDIF.

*   Late code
    IF <f_data>-zzlatecd IS INITIAL.
      <f_data>-zzlatecd = <f_data>-zzlatecd1.
    ENDIF.

    IF NOT <f_data>-zzlatecd IS INITIAL.
      READ TABLE gt_latecode INTO gw_latecode WITH KEY zlatecd = <f_data>-zzlatecd.
      IF sy-subrc = 0.
        <f_data>-zlatedesc = gw_latecode-zlatedesc.
      ENDIF.
    ENDIF.

**  If item level is not maintained get from header level
    IF <f_data>-zzportentry IS INITIAL.
      <f_data>-zzportentry = <f_data>-zzportentry2.
    ENDIF.
**  Fill port of entry descriptions
    READ TABLE it_zport ASSIGNING <f_zport>
                         WITH TABLE KEY  zport = <f_data>-zzportentry.
    IF sy-subrc = 0.
      <f_data>-zport_desc = <f_zport>-bezei.
    ENDIF.

* Customer SO Cancel Date.
*    READ TABLE i_vbap_h ASSIGNING <f_vbap>
*                         WITH TABLE KEY vbeln = <f_data>-zzvgbel.
*    IF sy-subrc = 0.
*      <f_data>-gueen = <f_vbap>-gueen.
*    ENDIF.

* Profit Center.
    READ TABLE i_marc_h ASSIGNING <f_marc>
                         WITH TABLE KEY matnr = <f_data>-matnr
                                        werks = <f_data>-werks.
    IF sy-subrc = 0.
      <f_data>-prctr = <f_marc>-prctr.
      <f_data>-herkl = <f_marc>-herkl.
    ENDIF.

* Total Canceled(qty booked - qty rcv)
    IF <f_data>-j_3aelikz = 'X'.
      IF <f_data>-qty_book > <f_data>-qty_rcv .
        <f_data>-qty_cnc = <f_data>-qty_book - <f_data>-qty_rcv.
      ELSE.
        CLEAR <f_data>-qty_cnc.
      ENDIF.
    ELSE.
      CLEAR <f_data>-qty_cnc.
    ENDIF.

* tot qty in trans
*  BoC:Ruchira Sampath:06/08/2021-CH1343

***    LOOP AT i_ekes_m INTO wa_ekes WHERE ebeln = <f_data>-ebeln
***                                    AND ebelp = <f_data>-ebelp
***                                    AND j_3asize = <f_data>-j_3asize.
****    READ TABLE i_ekes_m INTO wa_ekes WITH KEY ebeln = <f_data>-ebeln
****                                                 ebelp = <f_data>-ebelp
****                                                 j_3asize = <f_data>-j_3asize.
***      <f_data>-qty_intra = wa_ekes-menge - wa_ekes-dabmg.
***    ENDLOOP.

    CLEAR wa_ekes.
    READ TABLE i_ekes_m INTO wa_ekes WITH KEY ebeln    = <f_data>-ebeln
                                              ebelp    = <f_data>-ebelp
                                              j_3asize = <f_data>-j_3asize.
    IF sy-subrc EQ 0.
      <f_data>-qty_intra = wa_ekes-menge - wa_ekes-dabmg.
    ENDIF.

*  EoC:Ruchira Sampath:06/08/2021-CH1343
*For Pre-pack Materials
    IF <f_data>-mtpos_mara = 'ERLA'.
      <f_data>-qty_book_pc    = <f_data>-qty_book  * <f_data>-zpre_pack_qty.
      <f_data>-qty_rcv_pc     = <f_data>-qty_rcv   * <f_data>-zpre_pack_qty.
      <f_data>-qty_cnc_pc     = <f_data>-qty_cnc   * <f_data>-zpre_pack_qty.
      <f_data>-qty_intra_pc   = <f_data>-qty_intra * <f_data>-zpre_pack_qty.
    ELSE.
      <f_data>-qty_book_pc    = <f_data>-qty_book.
      <f_data>-qty_rcv_pc     = <f_data>-qty_rcv.
      <f_data>-qty_cnc_pc     = <f_data>-qty_cnc.
      <f_data>-qty_intra_pc   = <f_data>-qty_intra.
    ENDIF.

* WIP Bal (Tot Qty Booked-Tot Qty  Rcv)
    IF <f_data>-j_3aelikz = ''.
      <f_data>-qty_wip = <f_data>-qty_book - <f_data>-qty_cnc - <f_data>-qty_rcv.
      <f_data>-wip_vol = <f_data>-qty_wip * <f_data>-volum.
      "This value should always be absolute.Even if the calculation is (-ve), the value should be shown as +ve.
      IF <f_data>-wip_vol < 0.
        <f_data>-wip_vol = <f_data>-wip_vol * -1.
      ENDIF.
    ENDIF.

*For Pre-pack Materials
    IF <f_data>-mtpos_mara = 'ERLA'.
      <f_data>-qty_wip_pc = <f_data>-qty_wip * <f_data>-zpre_pack_qty.
    ELSE.
      <f_data>-qty_wip_pc = <f_data>-qty_wip.
    ENDIF.

******* calculate estimate allocated cartoons****************************

** Identify the Pre pack materials
    CLEAR wa_afsmvke. "KosalaW:30.08.2010
    IF <f_data>-j_3asize NE ''.
      READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                           j_3asize = <f_data>-j_3asize
                                           j_4krcat = <f_data>-lbl.
      IF sy-subrc NE 0.
        READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                 j_4krcat = <f_data>-lbl
                                                 /afs/refpq  =  'X'.
        IF sy-subrc NE 0.
          READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                 j_3asize = <f_data>-j_3asize
                                                 j_4krcat = ' '.
          IF sy-subrc NE 0.
            READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                     j_4krcat = ' '
                                                    /afs/refpq  =  'X'.
          ENDIF.
        ENDIF.
      ENDIF.

** Identify the Pre pack materials and Calculate the Pack Qty
    ELSE.
      READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                      j_4krcat = <f_data>-lbl "ATTSAM - Changed 17.08.2010-Ver 11 - "j_4krcat = <f_data>-j_4kscat
                                                      /afs/refpq  =  'X'.
      IF sy-subrc NE 0.
        READ TABLE i_afsmvke_s INTO wa_afsmvke WITH KEY matnr = <f_data>-matnr
                                                        j_4krcat = ' '
                                                        /afs/refpq  =  'X'.
      ENDIF.
    ENDIF.

    IF sy-subrc = 0.
      <f_data>-tot_ctn = <f_data>-qty_wip DIV wa_afsmvke-j_3apqty.
      <f_data>-j_3apqty = wa_afsmvke-j_3apqty.
    ELSE.
* Total no of Cartons field is dependent on the Pack Qty, I would
* like the report to show Total No of Cartons also to be blank where
* the Pack Qty is blank (zero).
*      <f_data>-tot_ctn = <f_data>-qty_wip.
      <f_data>-tot_ctn = 0.

*      <f_data>-j_3apqty  = 1. "LJ26AUG2010 - Req by Ashutosh if no record found value should be 0
    ENDIF.

* Var PO vs Shipped WIP Bal-Qty In tran
*    IF <f_data>-j_3aelikz = ''.
*      <f_data>-qty_var = <f_data>-qty_wip - <f_data>-qty_intra.
*    <f_data>-qty_var = <f_data>-qty_intra - <f_data>-qty_wip.
    <f_data>-qty_var = ( <f_data>-qty_rcv + <f_data>-qty_intra + <f_data>-qty_cnc ) - <f_data>-qty_book.
    IF <f_data>-zpre_pack_qty = 0.
      <f_data>-qty_var_pc = <f_data>-qty_var.
    ELSE.
      <f_data>-qty_var_pc = <f_data>-qty_var * <f_data>-zpre_pack_qty.
    ENDIF.

** to be included same as material wise report*****************
*    LOOP AT i_konv ASSIGNING <f_konv> WHERE knumv = <f_data>-knumv AND kposn = <f_data>-ebelp.
*      v_kwert = v_kwert + <f_konv>-kwert.
*    ENDLOOP.

* PO open amnt
*    IF <f_data>-qty_book > 0.
*      <f_data>-amnt_wip   = ( v_kwert / <f_data>-qty_book ) * <f_data>-qty_wip.
*    ENDIF.


*    <f_data>-amnt_book  = <f_data>-j_3anetp * <f_data>-qty_book. *-- CH 821 (Changed the logic)

*    <f_data>-amnt_book  = <f_data>-stprs * <f_data>-qty_book.
    IF <f_data>-menge IS INITIAL OR <f_data>-menge = 0.
      CLEAR <f_data>-amnt_book.
    ELSE.
      <f_data>-amnt_book  = ( <f_data>-amnt_book / <f_data>-menge ) * <f_data>-qty_book.
    ENDIF.

    <f_data>-amnt_wip   = <f_data>-j_3anetp * <f_data>-qty_wip.

* BOC by PFERNANDO on 7/23/2018
    SELECT kschl kbetr INTO CORRESPONDING FIELDS OF gwa_fob FROM konv
           WHERE knumv = <f_data>-knumv AND kposn = <f_data>-ebelp.
      IF sy-subrc = 0 AND gwa_fob-kschl = 'XB00'.
*     Total PO Amount in FOB
        <f_data>-tot_po_fob = <f_data>-qty_book * gwa_fob-kbetr.
        EXIT.
      ENDIF.
    ENDSELECT.
*   Total PO Amount in Standard Cost
    <f_data>-tot_po_std = <f_data>-qty_book * <f_data>-stprs.
* EOC by PFERNANDO on 7/23/2018

    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_OUTPUT'
      EXPORTING
        input    = <f_data>-meins
        language = sy-langu
      IMPORTING
        output   = <f_data>-meins.

    CLEAR : wa_konv.

*    Sub profit center description
    READ TABLE i_tvm1t_h INTO wa_tvm1t WITH TABLE KEY mvgr1 = <f_data>-mvgr1.
    IF sy-subrc = 0.
      <f_data>-mvgr1_desc = wa_tvm1t-bezei.
    ENDIF.

*   Hanger Description
    CLEAR : wa_zhanger.
    READ TABLE i_zhanger_h INTO wa_zhanger
      WITH TABLE KEY zzhanger = <f_data>-zzhanger.
    IF sy-subrc = 0.
      <f_data>-zzhangerdesc = wa_zhanger-zzhangerdesc.
    ENDIF.

*   BCBG: Get packaging type from text
    READ TABLE gt_plant_control INTO gw_plant_control WITH KEY werks = <f_data>-werks.
    IF ( sy-subrc = 0 ) AND ( gw_plant_control-zpack_chk = 'X' ).
      IF NOT <f_data>-zzhanger_po IS INITIAL.
        <f_data>-zzhanger = <f_data>-zzhanger_po.

        READ TABLE i_zhanger_h INTO wa_zhanger WITH TABLE KEY zzhanger = <f_data>-zzhanger.
        IF sy-subrc = 0.
          <f_data>-zzhangerdesc = wa_zhanger-zzhangerdesc.
        ELSE.
          CLEAR <f_data>-zzhangerdesc.
        ENDIF.
      ENDIF.
*      CLEAR: gt_lines[], gw_lines, gv_tdname.
*
*      CONCATENATE <f_data>-ebeln <f_data>-ebelp INTO gv_tdname RESPECTING BLANKS.
*
*      CALL FUNCTION 'READ_TEXT'
*        EXPORTING
*          id                      = 'F01'
*          language                = sy-langu
*          name                    = gv_tdname
*          object                  = 'EKPO'
*        TABLES
*          lines                   = gt_lines
*        EXCEPTIONS
*          id                      = 1
*          language                = 2
*          name                    = 3
*          not_found               = 4
*          object                  = 5
*          reference_check         = 6
*          wrong_access_to_archive = 7
*          OTHERS                  = 8.
*
*      READ TABLE gt_lines INTO gw_lines INDEX 1.
*      IF sy-subrc = 0.
*        SPLIT gw_lines-tdline AT ':' INTO gv_split1 gv_split2.
*        CONDENSE gv_split2.
*        gv_split1 = gv_split2(3).
*        IF gv_split1 CO '1234567890 '.
*          <f_data>-zzhanger = gv_split1.
*
*          gw_lines-tdline = gv_split2.
*          CLEAR: gv_split1, gv_split2.
*          SPLIT gw_lines-tdline AT '-' INTO gv_split1 gv_split2.
*          CONDENSE gv_split2.
*
*          IF NOT gv_split2 IS INITIAL.
*            <f_data>-zzhangerdesc = gv_split2.
*          ENDIF.
*        ENDIF.
*      ENDIF.
    ENDIF.

***** Pricing moved to material level *******
**    size wise FOB price
*    READ TABLE i_konv_fob_h INTO wa_konv_fob
*    WITH TABLE KEY knumv = <f_data>-knumv
*                   kposn = <f_data>-kposn
*                   j_3aetenr = <f_data>-etenr.
*
*    IF sy-subrc = 0.
*      <f_data>-netpr = wa_konv_fob-kbetr.
*    ENDIF.

*Read Sales Price +SP13MAY2010
    READ TABLE i_sales INTO wa_sales WITH KEY
                            vbeln     = <f_data>-zzvgbel
                            matnr     = <f_data>-matnr
                            j_3asize  = <f_data>-j_3asize
                            BINARY SEARCH.
    IF sy-subrc = 0.
      <f_data>-kbetr = wa_sales-kbetr.
      <f_data>-konwa = wa_sales-waers.

    ELSE.
      CLEAR wa_a905.
      READ TABLE i_a905 INTO wa_a905 WITH KEY matnr = <f_data>-matnr BINARY SEARCH.
      IF sy-subrc = 0.
        CLEAR wa_sales_4_a905.
        READ TABLE i_sales_4_a905 INTO wa_sales_4_a905 WITH TABLE KEY knumh = wa_a905-knumh.
        IF sy-subrc = 0.
          <f_data>-kbetr = wa_sales_4_a905-kbetr.
        ENDIF.
      ENDIF.
    ENDIF.

    "split size added 04112011 asangad
    CALL FUNCTION 'J_3A_SPLIT_SIZES'
      EXPORTING
        matnr              = <f_data>-matnr
        j_3asize           = <f_data>-j_3asize
      IMPORTING
        j_3akord1          = <f_data>-j_3akord1
        j_3akord2          = <f_data>-j_3akord2
*       j_3akord3          = lv_size2
      EXCEPTIONS
        no_grid_determined = 1
        OTHERS             = 2.
    IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

* BOC by DGHOSAL on 6/9/2018 for SAP-75
    READ TABLE i_ekes_ibd INTO DATA(ls_ibd) WITH KEY
                               ebeln = <f_data>-ebeln
                               ebelp = <f_data>-ebelp
                               j_3asize = <f_data>-j_3asize
                               BINARY SEARCH.
    IF sy-subrc IS INITIAL.
      <f_data>-ibd_date = ls_ibd-eindt.
    ENDIF.
* EOC by DGHOSAL on 6/9/2018 for SAP-75

* Begin of changes - ECDK915177 - Pio Fernando
    IF gv_msrp_control IS INITIAL.
* End of changes - ECDK915177 - Pio Fernando

* BOC by DGHOSAL on 5/21/2018
      READ TABLE gt_msrp INTO gs_msrp WITH KEY
                               matnr = <f_data>-matnr
                               vkorg = <f_data>-vkorg
                               kunnr = <f_data>-zzkunnr
                               BINARY SEARCH.
      IF sy-subrc IS INITIAL.
        <f_data>-msrp = gs_msrp-j_3afield1.
      ELSE.
        READ TABLE gt_zats_sorg_lbl INTO gs_zats_sorg_lbl WITH KEY
                                         vkorg = <f_data>-vkorg
                                         BINARY SEARCH.
        IF sy-subrc IS INITIAL AND gs_zats_sorg_lbl-lbl_apl EQ 'X'.

          LOOP AT gt_zats_cust_lbl INTO gs_zats_cust_lbl WHERE vkorg = <f_data>-vkorg
                                                           AND j_3akvgr8 = <f_data>-j_4kscat+(3).
            READ TABLE gt_msrp INTO gs_msrp WITH KEY
                                 matnr = <f_data>-matnr
                                 vkorg = <f_data>-vkorg
                                 kunnr = gs_zats_cust_lbl-kunnr
                                 BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              <f_data>-msrp = gs_msrp-j_3afield1.
              EXIT.
            ENDIF.

          ENDLOOP.
        ELSE.
          READ TABLE gt_knvv INTO gs_knvv WITH KEY
                             vkorg = <f_data>-vkorg
                             j_3akvgr8 = <f_data>-j_4kscat+(3)
                             BINARY SEARCH.
          IF sy-subrc IS INITIAL.
            READ TABLE gt_msrp INTO gs_msrp WITH KEY
                                matnr = <f_data>-matnr
                                vkorg = <f_data>-vkorg
                                kunnr =  gs_knvv-kunnr
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              <f_data>-msrp = gs_msrp-j_3afield1.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDIF.
      IF <f_data>-msrp IS INITIAL.
* EOC by DGHOSAL on 5/21/2018


        READ TABLE gi_kotk984_h INTO gwa_kotk984 WITH TABLE KEY vkorg   = <f_data>-werks  " EKPO-WERKS added by MS 9999013477
                                                                matnr   = <f_data>-matnr.
        IF sy-subrc EQ 0.
          "     Get MSRP from the the first record for the cond number
          READ TABLE gi_j_3avast INTO gwa_j_3avast WITH KEY knumh = gwa_kotk984-knumh.
          IF sy-subrc EQ 0.
            <f_data>-msrp = gwa_j_3avast-j_3afield1.
          ENDIF.
*      CLEAR <f_data>-msrp.
        ENDIF.
* BOC by DGHOSAL on 5/21/2018
      ENDIF.
* EOC by DGHOSAL on 5/21/2018

*   BCBG: Compare at MSRP
      READ TABLE gt_compat INTO wa_compat WITH KEY matnr = <f_data>-matnr.
*                                                   kunnr = <f_data>-zzkunnr. " CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
      IF ( sy-subrc = 0 ) AND ( NOT wa_compat-j_3afield1 IS INITIAL ).
        <f_data>-msrp_compat = <f_data>-msrp.
        <f_data>-msrp = wa_compat-j_3afield1.
      ENDIF.

* Begin of changes - ECDK915177 - Pio Fernando
    ELSE.
*     MSRP
      IF s_ebeln IS NOT INITIAL.
        READ TABLE i_data_mat2 INTO DATA(lwa_mara) WITH KEY matnr = <f_data>-matnr.

        SELECT SINGLE vbeln INTO @DATA(lv_vbeln) FROM ekkn
        WHERE ebeln = @lwa_mara-ebeln.

        SELECT SINGLE kunnr INTO @DATA(lv_kunnr) FROM vbak
        WHERE vbeln = @lv_vbeln.
      ELSE.
        lv_kunnr = <f_data>-kunnr.
      ENDIF.

      CALL METHOD zcl_msrp_pricing=>get_msrp_price
        EXPORTING
          iv_vkorg                   = <f_data>-vkorg
          iv_kunnr                   = lv_kunnr
          iv_pltyp                   = '*'
          iv_matnr                   = <f_data>-matnr
          iv_all_cond                = abap_true
        IMPORTING
          ev_msrp                    = DATA(lv_msrp)
          ev_curr                    = DATA(lv_curr)
          et_msrp                    = DATA(lt_msrp)
        EXCEPTIONS
          condition_record_not_found = 1
          OTHERS                     = 2.

      IF sy-subrc = 0.
        <f_data>-msrp = lv_msrp.
      ENDIF.

*     Compared at MSRP
      SELECT SINGLE konp~kbetr INTO lv_msrp FROM a901
             INNER JOIN konp ON a901~knumh = konp~knumh
             WHERE a901~kappl = 'V' AND
                   a901~kschl = 'XMSR' AND
                   a901~vkorg = <f_data>-vkorg AND
                   a901~kunnr = gv_factory AND      " Commented CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
*                   a901~kunnr = <f_data>-zzkunnr AND " Added CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
      a901~matnr = <f_data>-matnr.
      IF sy-subrc = 0.
        <f_data>-msrp_compat = <f_data>-msrp.
        <f_data>-msrp = lv_msrp.
      ENDIF.

      IF p_msrp = abap_true.
        LOOP AT lt_msrp INTO DATA(lwa_msrp).

          IF <f_data>-msrp_compat IS NOT INITIAL AND lwa_msrp-waers = 'USD'.
            lwa_msrp-msrp = <f_data>-msrp.
          ENDIF.

          CALL METHOD zcl_msrp_pricing=>get_msrp_curr_sequence
            EXPORTING
              iv_curr = lwa_msrp-waers
            IMPORTING
              ev_seq  = DATA(lv_seq)
            CHANGING
              it_curr = gt_curr[].

          CONCATENATE '<f_data>-msrp_' lv_seq INTO gv_var.
          ASSIGN (gv_var) TO <gv_var>.
          IF <gv_var> IS ASSIGNED.
            <gv_var> = lwa_msrp-msrp.
          ENDIF.

        ENDLOOP.
      ENDIF.
      CLEAR: lt_msrp[], lv_msrp, lv_curr.
    ENDIF.
* End of changes - ECDK915177 - Pio Fernando
* For Parent and Child ASIN Number
    IF p_asin EQ 'X'.
      READ TABLE gt_msrp INTO gs_msrp WITH KEY matnr = <f_data>-matnr
                                               vkorg = <f_data>-vkorg
                                               j_3atltyp = 'PAR'.
      IF sy-subrc IS INITIAL.
        <f_data>-pasin = gs_msrp-j_3afield1.
      ENDIF.
      READ TABLE gt_msrp INTO gs_msrp WITH KEY matnr = <f_data>-matnr
                                         vkorg = <f_data>-vkorg
                                         j_3asize = <f_data>-j_3asize
                                         j_3atltyp = 'CHD'.
      IF sy-subrc IS INITIAL.
        <f_data>-casin = gs_msrp-j_3afield2.
      ENDIF.
    ENDIF.

*   BCBG: Canadian MSRP
    IF NOT <f_data>-msrp IS INITIAL.
      READ TABLE gt_msrp_rates INTO wa_msrp_rates WITH KEY werks = <f_data>-werks
                                                           tcurr = 'CAD'.
      IF sy-subrc = 0.
        <f_data>-msrpcad = <f_data>-msrp.
        gv_msrpcad = <f_data>-msrpcad * wa_msrp_rates-kbetr.
        <f_data>-msrpcad = gv_msrpcad.

        CALL FUNCTION 'ZMSRP_ROUNDING'
          EXPORTING
            zznbrand = <f_data>-zznbrand
            msrp_in  = <f_data>-msrpcad
          IMPORTING
            msrp_out = <f_data>-msrpcad.
      ENDIF.
    ENDIF.

*   BCBG: UPC
***    READ TABLE i_mean INTO wa_mean WITH KEY matnr = <f_data>-matnr
***                                            j_3akordx = <f_data>-j_3asize
***                                            /afs/eanblock = <f_data>-j_4kscat.
***    IF sy-subrc NE 0.
***      READ TABLE i_mean INTO wa_mean WITH KEY matnr = <f_data>-matnr
***                                              j_3akordx = <f_data>-j_3asize.
***    ENDIF.
***
***    IF sy-subrc = 0.
***      <f_data>-ean11 = wa_mean-ean11.
***
***      CALL FUNCTION 'CONVERSION_EXIT_EAN11_OUTPUT'
***        EXPORTING
***          input  = <f_data>-ean11
***        IMPORTING
***          output = <f_data>-ean11.
***    ENDIF.

*  BoC :    + CH-2685 : Ruchira : 19-July-2023

    CLEAR i_mean_c.
    i_mean_c = i_mean.

    DELETE i_mean_c WHERE matnr     NE <f_data>-matnr.
    DELETE i_mean_c WHERE j_3akordx NE <f_data>-j_3asize.
    DELETE i_mean_c WHERE /afs/eanblock NE <f_data>-j_4kscat  AND
                          /afs/eanblock NE ''.

    CLEAR wa_mean.

    sy-subrc = 4.

    IF <f_data>-j_4kscat IS NOT INITIAL.
      READ TABLE i_mean_c INTO wa_mean WITH KEY /afs/eanblock = <f_data>-j_4kscat
                                                eantp         = 'Z2'.
      IF sy-subrc NE 0.
        READ TABLE i_mean_c INTO wa_mean WITH KEY /afs/eanblock = <f_data>-j_4kscat.

      ENDIF.
    ENDIF.

    IF sy-subrc NE 0.
      READ TABLE i_mean_c INTO wa_mean WITH KEY j_3akordx     = <f_data>-j_3asize
                                                eantp         = 'Z2'.
    ENDIF.

    IF sy-subrc NE 0.
      READ TABLE i_mean_c INTO wa_mean INDEX 1.
    ENDIF.

    IF wa_mean-ean11 IS NOT INITIAL.
      <f_data>-ean11 = wa_mean-ean11.

      CALL FUNCTION 'CONVERSION_EXIT_EAN11_OUTPUT'
        EXPORTING
          input  = <f_data>-ean11
        IMPORTING
          output = <f_data>-ean11.
    ENDIF.

*  EoC :    + CH-2685 : Ruchira : 19-July-2023



*   BCBG: French color desc
    READ TABLE gi_color_desc INTO wa_color_desc WITH KEY matnr = <f_data>-matnr
                                                         spras = 'F'.
    IF sy-subrc = 0.
      <f_data>-col_desc_fr = wa_color_desc-zzdesc.
    ENDIF.

*Code commented by SriRam  9999013477 4/02/2015
* Start of Addition 9999013477 by Sri Ram
*    IF <f_data>-msrp IS INITIAL.
**      LOOP AT lt_tvkwz INTO lw_tvkwz WHERE werks = <f_data>-werks .
*
*        READ TABLE lt_kotk984 INTO gwa_kotk984 WITH KEY matnr = <f_data>-matnr.      " vkorg   = lw_tvkwz-vkorg
*
*        IF sy-subrc EQ 0.
*          "     Get MSRP from the the first record for the cond number
*          READ TABLE lt_j_3avast INTO gwa_j_3avast WITH KEY knumh = gwa_kotk984-knumh.
*          IF sy-subrc EQ 0.
*            <f_data>-msrp = gwa_j_3avast-j_3afield1.
*            EXIT.
*          ENDIF.
*        ENDIF.
**      ENDLOOP.
*    ENDIF.
* End of Addition 9999013477 by Sri Ram
*End of Code commented by SriRam  9999013477 4/02/2015

* INSERT:PJDK925380:29/05/2012:MW - {
*Removed by AP. 29/03/2022
**    IF <f_data>-pstyp = '5' AND <f_data>-knttp = 'X'.
**      CLEAR <f_data>-lgort.

*End Removed
* BOC by DGHOSAL on 5/21/2018
    READ TABLE gt_edicon INTO gs_edicon WITH KEY
                            kunnr = <f_data>-zzkunnr
                            vkorg = wa_vbak-vkorg
                            vtweg = wa_vbak-vtweg
                            spart = wa_vbak-spart
                            BINARY SEARCH.
    IF sy-subrc IS INITIAL.
      <f_data>-dirshp = gs_edicon-dirshp.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018
**    ENDIF. "" *Removed by AP. 29/03/2022
* INSERT:PJDK925380:29/05/2012:MW - }

*{  INSERT  PJDK928062  26.11.2012  MP
    CLEAR gwa_dd07t.
    READ TABLE gi_dd07t INTO gwa_dd07t WITH KEY domvalue_l = <f_data>-insmk.
    IF sy-subrc = 0.
      <f_data>-ddtext = gwa_dd07t-ddtext.
    ENDIF.
*}  INSERT

*   6/26/13 - Standardization: Add new field descriptions
*   Gender
    READ TABLE itgendr INTO wagendr WITH KEY zzngendr = <f_data>-zzngendr.
    IF sy-subrc = 0.
      <f_data>-zzngendrtxt = wagendr-zzngendrtxt.
    ENDIF.

*   Age group
    READ TABLE itaggrp INTO waaggrp WITH KEY zznaggrp = <f_data>-zznaggrp.
    IF sy-subrc = 0.
      <f_data>-zznaggrptxt = waaggrp-zznaggrptxt.
    ENDIF.

*   Gender size grp
    READ TABLE itgszgp INTO wagszgp WITH KEY zzngszgp = <f_data>-zzngszgp.
    IF sy-subrc = 0.
      <f_data>-zzngszgptxt = wagszgp-zzngszgptxt.
    ENDIF.

*   Collar Type Description
    READ TABLE itcoltp INTO wacoltp WITH KEY zzncoltp = <f_data>-zzncoltp.
    IF sy-subrc = 0.
      <f_data>-zzncoltptxt = wacoltp-zzncoltptxt.
    ENDIF.

*   Cuff Type Description
    READ TABLE itcuftp INTO wacuftp WITH KEY zzncuftp = <f_data>-zzncuftp.
    IF sy-subrc = 0.
      <f_data>-zzncuftptxt = wacuftp-zzncuftptxt.
    ENDIF.

*   Fashion Pyramid Description
    READ TABLE itfapyr INTO wafapyr WITH KEY zznfapyr = <f_data>-zznfapyr.
    IF sy-subrc = 0.
      <f_data>-zznfapyrtxt = wafapyr-zznfapyrtxt.
    ENDIF.

*   Silhouette Description Description
    READ TABLE itsilht INTO wasilht WITH KEY zznsilht = <f_data>-zznsilht.
    IF sy-subrc = 0.
      <f_data>-zznsilhttxt = wasilht-zznsilhttxt.
    ENDIF.

*   Product category
    READ TABLE itprdct INTO waprdct WITH KEY zznprdct = <f_data>-zznprdct.
    IF sy-subrc = 0.
      <f_data>-zznprdcttxt = waprdct-zznprdcttxt.
    ENDIF.

*   Sub product category
    READ TABLE itprdsc INTO waprdsc WITH KEY zznprdsc = <f_data>-zznprdsc.
    IF sy-subrc = 0.
      <f_data>-zznprdsctxt = waprdsc-zznprdsctxt.
    ENDIF.

*   Fabric
    READ TABLE itfabct INTO wafabct WITH KEY zznfabct = <f_data>-zznfabct.
    IF sy-subrc = 0.
      <f_data>-zznfabcttxt = wafabct-zznfabcttxt.
    ENDIF.

*   Collection
    READ TABLE itcolln INTO wacolln WITH KEY zzncolln = <f_data>-zzncolln.
    IF sy-subrc = 0.
      <f_data>-zzncollntxt = wacolln-zzncollntxt.
    ENDIF.

*   Brand group
    READ TABLE itbrgrp INTO wabrgrp WITH KEY zznbrgrp = <f_data>-zznbrgrp.
    IF sy-subrc = 0.
      <f_data>-zznbrgrptxt = wabrgrp-zznbrgrptxt.
    ENDIF.

*   Brand group type
    READ TABLE itbrgtp INTO wabrgtp WITH KEY zznbrgtp = <f_data>-zznbrgtp.
    IF sy-subrc = 0.
      <f_data>-zznbrgtptxt = wabrgtp-zznbrgtptxt.
    ENDIF.

*   Event
    READ TABLE itevent INTO waevent WITH KEY zznevent = <f_data>-zznevent.
    IF sy-subrc = 0.
      <f_data>-zzneventtxt = waevent-zzneventtxt.
    ENDIF.

*   Fabric concept
    READ TABLE i_fabrn WITH KEY zznfabrn = <f_data>-zznfabrn.
    IF sy-subrc = 0.
      <f_data>-zznfabrntxt = i_fabrn-zznfabrntxt.
    ENDIF.

*   Collection
    READ TABLE itcolln INTO wacolln WITH KEY zzncolln = <f_data>-zzncolln.
    IF sy-subrc = 0.
      <f_data>-zzncollntxt = wacolln-zzncollntxt.
    ENDIF.

*   Royalty
    READ TABLE itprdha INTO waprdha WITH KEY zzrcode = <f_data>-zprdha.
    IF sy-subrc = 0.
      <f_data>-zzlicdesc = waprdha-zzlicdesc.
      <f_data>-zzprdesc  = waprdha-zzprdesc.
    ENDIF.

* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
    READ TABLE it_ztopdcl ASSIGNING FIELD-SYMBOL(<lfs_ztopdcl>)
                                                WITH KEY zznopdcl = <f_data>-zznopdcl.
    IF sy-subrc = 0.
      <f_data>-zznopdcltxt = <lfs_ztopdcl>-zznopdcltxt.
    ENDIF.
* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

    IF it_cname[] IS NOT INITIAL.
*
      READ TABLE it_cname ASSIGNING <fs_cname> WITH KEY kunnr = <f_data>-zkunnr.
*
      IF sy-subrc EQ 0 .
        <f_data>-custname = <fs_cname>-name1.
      ENDIF.
*
*
    ENDIF.
*
    IF <f_data>-zkunnr IS NOT INITIAL.
*
      SHIFT <f_data>-zkunnr LEFT DELETING LEADING '0'.
*
    ENDIF.
*
*   AACategory Description
    READ TABLE itadesc INTO wadesc WITH KEY knttp = <f_data>-knttp.
    IF sy-subrc = 0.
      <f_data>-knttx = wadesc-knttx.
    ENDIF.

*   AACategory Description
    READ TABLE itcat INTO wacat WITH KEY pstyp = <f_data>-pstyp.
    IF sy-subrc = 0.
      <f_data>-ptext = wacat-ptext.
    ENDIF.

* Begin of changes - ECDK922248  Ruchira Sampath
    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'AB'.
    IF sy-subrc EQ 0.
      <f_data>-eindt_ab = <lfs_bkdates>-eindt.
      <f_data>-erdat_ab = <lfs_bkdates>-erdat.
      <f_data>-xblnr_ab = <lfs_bkdates>-xblnr.
    ENDIF.

    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates1>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'PB'.
    IF sy-subrc EQ 0.
      <f_data>-eindt_pb = <lfs_bkdates1>-eindt.
      <f_data>-erdat_pb = <lfs_bkdates1>-erdat.
      <f_data>-xblnr_pb = <lfs_bkdates1>-xblnr.
    ENDIF.

    READ TABLE gi_bkdates ASSIGNING FIELD-SYMBOL(<lfs_bkdates2>)
                                                      WITH KEY ebeln = <f_data>-ebeln
                                                               ebelp = <f_data>-ebelp
                                                               ebtyp = 'LA'.
    IF sy-subrc EQ 0.
      <f_data>-xblnr_la = <lfs_bkdates2>-xblnr.
    ENDIF.
* End of changes - ECDK922248 Ruchira Sampath

    READ TABLE lt_ztactvt INTO DATA(ls_ztactvt) WITH KEY  zznactvt = <f_data>-zznactvt.
    IF sy-subrc = 0.
      <f_data>-zznactvtxt  = ls_ztactvt-zznactvtxt.
    ENDIF.

*    READ TABLE lt_zttheme INTO DATA(ls_zttheme) WITH KEY zzntheme = <f_data>-zzntheme.
*    IF sy-subrc = 0.
*      <f_data>-zznthemetxt  = ls_zttheme-zznthemetxt.
*    ENDIF.

    READ TABLE lt_ztbkpkd INTO DATA(ls_ztbkpkd) WITH KEY zznbkpkd = <f_data>-zznbkpkd.
    IF sy-subrc = 0.
      <f_data>-zznbkpkdtxt  = ls_ztbkpkd-zznbkpkdtxt.
    ENDIF.

    READ TABLE lt_ztbdftn INTO DATA(ls_ztbdftn) WITH KEY zznbdftn = <f_data>-zznbdftn.
    IF sy-subrc = 0.
      <f_data>-zznbdftntxt  = ls_ztbdftn-zznbdftntxt.
    ENDIF.

    READ TABLE lt_ztbusun INTO DATA(ls_ztbusun) WITH KEY zznbusun = <f_data>-zznbusun.
    IF sy-subrc = 0.
      <f_data>-zznbusun  = ls_ztbusun-zznbusun.
    ENDIF.

    READ TABLE lt_ztchorg INTO DATA(ls_ztchorg) WITH KEY zznchorg = <f_data>-zznchorg.
    IF sy-subrc = 0.
      <f_data>-zznchorgtxt  = ls_ztchorg-zznchorgtxt.
    ENDIF.

    READ TABLE lt_ztchar2 INTO DATA(ls_ztchar2) WITH KEY zznchar2 = <f_data>-zznchar2.
    IF sy-subrc = 0.
      <f_data>-zznchar2txt  = ls_ztchar2-zznchar2txt.
    ENDIF.

    READ TABLE lt_ztclass INTO DATA(ls_ztclass) WITH KEY zznclass = <f_data>-zznclass.
    IF sy-subrc = 0.
      <f_data>-zznclasstxt  = ls_ztclass-zznclasstxt.
    ENDIF.

    READ TABLE lt_ztdenft INTO DATA(ls_ztdenft) WITH KEY zzndenft = <f_data>-zzndenft.
    IF sy-subrc = 0.
      <f_data>-zzndenfttxt = ls_ztdenft-zzndenfttxt.
    ENDIF.

    READ TABLE lt_ztdepmt INTO DATA(ls_ztdepmt) WITH KEY zzndepmt = <f_data>-zzndepmt.
    IF sy-subrc = 0.
      <f_data>-zzndepmtxt  = ls_ztdepmt-zzndepmtxt.
    ENDIF.

    READ TABLE lt_ztfabat INTO DATA(ls_ztfabat) WITH KEY zznfabat = <f_data>-zznfabat.
    IF sy-subrc = 0.
      <f_data>-zznfabatxt  = ls_ztfabat-zznfabatxt.
    ENDIF.

    READ TABLE lt_ztfabnm INTO DATA(ls_ztfabnm) WITH KEY zznfabnm = <f_data>-zznfabnm.
    IF sy-subrc = 0.
      <f_data>-zznfabnmtxt  = ls_ztfabnm-zznfabnmtxt.
    ENDIF.

    READ TABLE lt_ztfabst INTO DATA(ls_ztfabst) WITH KEY zznfabst = <f_data>-zznfabst.
    IF sy-subrc = 0.
      <f_data>-zznfabstxt = ls_ztfabst-zznfabstxt.
    ENDIF.

    READ TABLE lt_ztftacc INTO DATA(ls_ztftacc) WITH KEY zznftacc = <f_data>-zznftacc.
    IF sy-subrc = 0.
      <f_data>-zznftacctxt  = ls_ztftacc-zznftacctxt.
    ENDIF.

    READ TABLE lt_zthwtrt INTO DATA(ls_zthwtrt) WITH KEY zznhwtrt = <f_data>-zznhwtrt.
    IF sy-subrc = 0.
      <f_data>-zznhwtrttxt  = ls_zthwtrt-zznhwtrttxt.
    ENDIF.

    READ TABLE lt_zthemfn INTO DATA(ls_zthemfn) WITH KEY zznhemfn = <f_data>-zznhemfn.
    IF sy-subrc = 0.
      <f_data>-zznhemfntxt  = ls_zthemfn-zznhemfntxt.
    ENDIF.

    READ TABLE lt_ztlengt INTO DATA(ls_ztlengt) WITH KEY zznlengt = <f_data>-zznlengt.
    IF sy-subrc = 0.
      <f_data>-zznlengtxt  = ls_ztlengt-zznlengtxt.
    ENDIF.

    READ TABLE lt_ztmettp INTO DATA(ls_ztmettp) WITH KEY zznmettp = <f_data>-zznmettp.
    IF sy-subrc = 0.
      <f_data>-zznmettptxt  = ls_ztmettp-zznmettptxt.
    ENDIF.
    READ TABLE lt_ztpatrn INTO DATA(ls_ztpatrn) WITH KEY zznpatrn = <f_data>-zznpatrn.
    IF sy-subrc = 0.
      <f_data>-zznpatrntxt  = ls_ztpatrn-zznpatrntxt.
    ENDIF.

    READ TABLE lt_ztpresn INTO DATA(ls_ztpresn) WITH KEY zznpresn =  <f_data>-zznpresn.
    IF sy-subrc = 0.
      <f_data>-zznpresntxt = ls_ztpresn-zznpresntxt.
    ENDIF.

    READ TABLE lt_ztprcpt  INTO DATA(ls_ztprcpt) WITH KEY zznprcpt = <f_data>-zznprcpt.
    IF sy-subrc = 0.
      <f_data>-zznprcptxt = ls_ztprcpt-zznprcptxt.
    ENDIF.

    READ TABLE lt_ztprdgr INTO DATA(ls_ztprdgr) WITH KEY zznprdgr =  <f_data>-zznprdgr.
    IF sy-subrc = 0.
      <f_data>-zznprdgrtxt = ls_ztprdgr-zznprdgrtxt.
    ENDIF.

    READ TABLE lt_ztstone INTO DATA(ls_ztstone) WITH KEY zznstone = <f_data>-zznstone.
    IF sy-subrc = 0.
      <f_data>-zznstonetxt = ls_ztstone-zznstonetxt.
    ENDIF.

    READ TABLE lt_ztsclas INTO DATA(ls_ztsclas) WITH KEY zznsclas  =  <f_data>-zznsclas .
    IF sy-subrc = 0.
      <f_data>-zznsclastxt = ls_ztsclas-zznsclastxt.
    ENDIF.

    READ TABLE lt_ztwaist INTO DATA(ls_ztwaist) WITH KEY zznwaist =  <f_data>-zznwaist.
    IF sy-subrc = 0.
      <f_data>-zznwaistxt = ls_ztwaist-zznwaistxt.
    ENDIF.
    READ TABLE lt_ztwashy INTO DATA(ls_ztwashy) WITH KEY zznwashy =  <f_data>-zznwashy.
    IF sy-subrc = 0.
      <f_data>-zznwashytxt = ls_ztwashy-zznwashytxt.
    ENDIF.
    READ TABLE lt_ztwashs INTO DATA(ls_ztwashs) WITH KEY zznwashs =  <f_data>-zznwashs.
    IF sy-subrc = 0.
      <f_data>-zznwashstxt = ls_ztwashs-zznwashstxt.
    ENDIF.
    READ TABLE lt_ztwasht INTO DATA(ls_ztwasht) WITH KEY zznwasht =  <f_data>-zznwasht.
    IF sy-subrc = 0.
      <f_data>-zznwashtxt  = ls_ztwasht-zznwashtxt.
    ENDIF.
    READ TABLE lt_ztlgopn INTO DATA(ls_ztlgopn) WITH KEY zznlgopn = <f_data>-zznlgopn.
    IF sy-subrc = 0.
      <f_data>-zznlgopntxt = ls_ztlgopn-zznlgopntxt.
    ENDIF.
    READ TABLE lt_ztsilht INTO DATA(ls_ztsilht) WITH KEY zznsilht =  <f_data>-zznsilht.
    IF sy-subrc = 0.
      <f_data>-zznsilhttxt = ls_ztsilht-zznsilhttxt.
    ENDIF.
    READ TABLE lt_ztchars INTO DATA(ls_ztchars) WITH KEY zznchars = <f_data>-zznchars.
    IF sy-subrc = 0.
      <f_data>-zzncharstxt = ls_ztchars-zzncharstxt.
    ENDIF.
    READ TABLE lt_zconstype INTO DATA(ls_zconstype) WITH KEY zzconstype = <f_data>-zzconstype.
    IF sy-subrc = 0.
      <f_data>-zzconstypedesc = ls_zconstype-zzconstypedesc.
    ENDIF.
    READ TABLE lt_ztfabrn INTO DATA(ls_ztfabrn) WITH KEY zznfabrn = <f_data>-zznfabrn.
    IF sy-subrc = 0.
      <f_data>-zznfabrntxt = ls_ztfabrn-zznfabrntxt.
    ENDIF.
    READ TABLE lt_ztfapyr INTO DATA(ls_ztfapyrn) WITH KEY zznfapyr = <f_data>-zznfapyr.
    IF sy-subrc = 0.
      <f_data>-zznfapyrtxt = ls_ztfapyrn-zznfapyrtxt.
    ENDIF.
    READ TABLE lt_zhlht INTO DATA(ls_zhlht) WITH KEY zzhlht = <f_data>-zzhlht.
    IF sy-subrc = 0.
      <f_data>-zzhlhtdesc = ls_zhlht-zzhlhtdesc.
    ENDIF.
*    READ TABLE lt_ztpresn INTO DATA(ls_ztpresn) WITH KEY zznpresn =  <f_data>-zznpresn.
*    IF sy-subrc = 0.
*      <f_data>-ZZHLHTDESC = ls_ztpresn-ZZHLHTDESC.
*    ENDIF.
*    READ TABLE lt_ZTSTMTH INTO DATA(ls_ZTSTMTH) WITH KEY ZZNSTMTH = <f_data>-ZZNSTMTH.
*    IF sy-subrc = 0.
*      <f_data>-ZZNSTMTHTXT = ls_ztstmth-ZZNSTMTHTXT.
*    ENDIF.
    READ TABLE lt_ztitplt INTO DATA(ls_ztitplt) WITH KEY zznitplt = <f_data>-zznitplt.
    IF sy-subrc = 0.
      <f_data>-zznitplttxt = ls_ztitplt-zznitplttxt.
    ENDIF.
    READ TABLE lt_ztnctyp INTO DATA(ls_ztnctyp) WITH KEY zznnctyp = <f_data>-zznnctyp.
    IF sy-subrc = 0.
      <f_data>-zznnctyptxt = ls_ztnctyp-zznnctyptxt.
    ENDIF.
    READ TABLE lt_ztsetct INTO DATA(ls_ztsetct) WITH KEY zznsetct = <f_data>-zznsetct.
    IF sy-subrc = 0.
      <f_data>-zznsetcttxt = ls_ztsetct-zznsetcttxt.
    ENDIF.

*    READ TABLE lt_ZTRPMNT INTO DATA(ls_ZTRPMNT) WITH KEY ZZNRPMNT = <f_data>-ZZNRPMNT.
*    IF sy-subrc = 0.
*      <f_data>-ZZNRPMNTTXT = ls_ZTRPMNT-ZZNRPMNTTXT.
*    ENDIF.

    READ TABLE lt_zshaftht INTO DATA(ls_zshaftht) WITH KEY zzshaftht = <f_data>-zzshaftht.
    IF sy-subrc = 0.
      <f_data>-zzshafthtdesc = ls_zshaftht-zzshafthtdesc.
    ENDIF.

    READ TABLE lt_ztslvtp INTO DATA(ls_ztslvtp) WITH KEY zznslvtp = <f_data>-zznslvtp.
    IF sy-subrc = 0.
      <f_data>-zznslvtptxt = ls_ztslvtp-zznslvtptxt.
    ENDIF.

    READ TABLE lt_zstdet INTO DATA(ls_zstdet) WITH KEY zzstdet = <f_data>-zzstdet.
    IF sy-subrc = 0.
      <f_data>-zzstdetdesc = ls_zstdet-zzstdetdesc.
    ENDIF.

    READ TABLE lt_ztstfsh INTO DATA(ls_ztstfsh) WITH KEY zznstfsh = <f_data>-zznstfsh.
    IF sy-subrc = 0.
      <f_data>-zznstfshtxt = ls_ztstfsh-zznstfshtxt.
    ENDIF.

  ENDLOOP.

* COO
  IF s_herkl[] IS NOT INITIAL.
    DELETE i_data_size WHERE herkl NOT IN s_herkl.
  ENDIF.


*to filter by profit centre +SP20May2010
  IF s_prctr[] IS NOT INITIAL.
    DELETE i_data_size WHERE prctr IS INITIAL.
  ENDIF.

*to filter by sub profit centre +SP20May2010
  IF s_mvgr12[] IS NOT INITIAL.
    DELETE i_data_size WHERE mvgr1 IS INITIAL.
  ENDIF.

  "Code Added By SriRam  10/06/2015
  IF s_lgort[] IS NOT INITIAL.
    DELETE i_data_size  WHERE lgort = ''.
  ENDIF.
  " End of Code Addition.

**Filer Records against Country of Origin
  CLEAR wa_data_t.
  IF NOT s_land1 IS INITIAL.
    LOOP AT i_data_size INTO wa_data_t WHERE lifn2 NE ''.
      IF NOT wa_data_t-land1 IN s_land1.
        DELETE TABLE i_data_size FROM wa_data_t.
      ENDIF.
    ENDLOOP.
  ENDIF.

*{  INSERT  PJDK926501  14.08.2012  MP
  IF p_ppk_br EQ 'X'.
    CLEAR : li_data[].
    li_data[] = i_data_size[].
    CLEAR : i_data_size[].
    LOOP AT li_data INTO wa_data.
      wa_data_t = wa_data.
      APPEND wa_data_t TO i_data_size.
      IF wa_data-mtart EQ 'XPPK'.
        LOOP AT gi_zpocomp INTO gwa_zpocomp2 WHERE ebeln = wa_data-ebeln
                                              AND ebelp = wa_data-ebelp.
          gwa_zpocomp = gwa_zpocomp2.
          CLEAR : wa_data_t-qty_book,wa_data_t-amnt_book,wa_data_t-netpr,wa_data_t-qty_cnc, wa_data_t-qty_intra,wa_data_t-amnt_intra,
                  wa_data_t-qty_rcv,wa_data_t-amnt_rcv,wa_data_t-qty_wip,wa_data_t-amnt_wip,wa_data_t-qty_var,wa_data_t-stprs,
                  wa_data_t-volum,wa_data_t-wip_vol,wa_data_t-tot_ctn,wa_data_t-kbetr,wa_data_t-qty_book_pc,wa_data_t-qty_cnc_pc,
                  wa_data_t-qty_intra_pc,wa_data_t-qty_rcv_pc,wa_data_t-qty_wip_pc,wa_data_t-qty_var_pc,wa_data_t-j_3apqty,wa_data_t-msrp,
                  wa_data_t-maktx, wa_data_t-zzhanger, wa_data_t-zzhangerdesc,wa_data_t-lbl,wa_data_t-meins,
                  wa_data_t-normt,wa_data_t-zpre_pack_qty,
                  wa_data_t-mstae,wa_data_t-mtstb,wa_data_t-zznrfdesc.

          AT NEW ebelp.
            wa_data_t-comp_netpr = gwa_zpocomp-netpr.
          ENDAT.
          wa_data_t-comp_matnr = gwa_zpocomp-matnr.
*  BoC : CH-1778  :Ruchira : 05/06/2022
          READ TABLE gi_compupc ASSIGNING FIELD-SYMBOL(<lfs_compupc>)
                                           WITH KEY matnr     = gwa_zpocomp-matnr
                                                    j_3akordx = gwa_zpocomp-j_3asize BINARY SEARCH.
          IF sy-subrc EQ 0.
*            wa_data_t-ean11 = <lfs_compupc>-ean11.
            wa_data_t-comp_ean11 = <lfs_compupc>-ean11.
          ENDIF.
*  EoC : CH-1778  :Ruchira : 05/06/2022

          wa_data_t-comp_j_3asize = gwa_zpocomp-j_3asize.
          READ TABLE gt_msrp1 INTO gs_msrp WITH KEY matnr = gwa_zpocomp-matnr
                                                    j_3asize = gwa_zpocomp-j_3asize
                                                    j_3atltyp = 'CHD'.
          IF sy-subrc IS INITIAL.
            wa_data_t-ccasin = gs_msrp-j_3afield2.
          ENDIF.
          wa_data_t-comp_qty = gwa_zpocomp-menge * wa_data-menge.
          wa_data_t-comp_val = gwa_zpocomp-netpr * wa_data_t-comp_qty.
          APPEND wa_data_t TO i_data_size.
          CLEAR : gwa_zpocomp, wa_data_t-comp_netpr.
        ENDLOOP.
      ENDIF.
    ENDLOOP.
    FREE li_data.

  ELSEIF p_sh_pln = 'X'.
    CLEAR : li_data[].
    li_data[] = i_data_size[].
    CLEAR : i_data_size[].
*   SORT li_data BY ebeln ebelp etenr eindt.

    LOOP AT li_data INTO wa_data.
      READ TABLE gi_shppln INTO gw_shppln WITH KEY ebeln     = wa_data-ebeln
                                                   ebelp     = wa_data-ebelp
                                                   j_3aetenr = wa_data-etenr.
      IF sy-subrc = 0.
        CLEAR l_count.
        LOOP AT gi_shppln INTO gw_shppln WHERE ebeln     = wa_data-ebeln AND
                                               ebelp     = wa_data-ebelp AND
                                               j_3aetenr = wa_data-etenr.
          ADD 1 TO l_count.
          IF l_count = 1.
            wa_data-xblnr = gw_shppln-xblnr.
            wa_data-erdat = gw_shppln-erdat.
            wa_data-eindt_s = gw_shppln-eindt.
            wa_data-menge_s = gw_shppln-menge.
* BOC by DGHOSAL on 5/21/2018
            wa_data-ebtyp = gw_shppln-ebtyp.
            READ TABLE gt_t163f INTO gs_t163f WITH KEY
                                ebtyp = gw_shppln-ebtyp
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              wa_data-ebtxt = gs_t163f-ebtxt.
            ENDIF.
* EOC by DGHOSAL on 5/21/2018
            APPEND wa_data TO i_data_size.
          ELSE.
            CLEAR : wa_data-qty_book,wa_data-amnt_book,wa_data-netpr,wa_data-qty_cnc, wa_data-qty_intra,wa_data-amnt_intra,
                    wa_data-qty_rcv,wa_data-amnt_rcv,wa_data-qty_wip,wa_data-amnt_wip,wa_data-qty_var,wa_data-stprs,
                    wa_data-volum,wa_data-wip_vol,wa_data-tot_ctn,wa_data-kbetr,wa_data-qty_book_pc,wa_data-qty_cnc_pc,
                    wa_data-qty_intra_pc,wa_data-qty_rcv_pc,wa_data-qty_wip_pc,wa_data-qty_var_pc,wa_data-j_3apqty,wa_data-msrp,
                    wa_data-zpre_pack_qty.

            wa_data-xblnr = gw_shppln-xblnr.
            wa_data-erdat = gw_shppln-erdat.
            wa_data-eindt_s = gw_shppln-eindt.
            wa_data-menge_s = gw_shppln-menge.
* BOC by DGHOSAL on 5/21/2018
            wa_data-ebtyp = gw_shppln-ebtyp.
            READ TABLE gt_t163f INTO gs_t163f WITH KEY
                                ebtyp = gw_shppln-ebtyp
                                BINARY SEARCH.
            IF sy-subrc IS INITIAL.
              wa_data-ebtxt = gs_t163f-ebtxt.
            ENDIF.
* EOC by DGHOSAL on 5/21/2018
            APPEND wa_data TO i_data_size.
          ENDIF.
        ENDLOOP.

      ELSE.
        APPEND wa_data TO i_data_size.
      ENDIF.
    ENDLOOP.

    IF NOT s_eindt2[] IS INITIAL.
      DELETE i_data_size WHERE NOT eindt_s IN s_eindt2.
    ENDIF.

    IF NOT s_erdat[] IS INITIAL.
      DELETE i_data_size WHERE NOT erdat IN s_erdat.
    ENDIF.

  ENDIF.

* To Filter Invoice Party
  IF s_inpty[] IS NOT INITIAL.
    DELETE i_data_size WHERE pi_lifn2 NOT IN s_inpty.
  ENDIF.

* To Filter Freight Forwarder
  IF s_frfor[] IS NOT INITIAL.
    DELETE i_data_size WHERE cr_lifn2 NOT IN s_frfor.
  ENDIF.

* To Filter Ordering Address
  IF s_ordar[] IS NOT INITIAL.
    DELETE i_data_size WHERE ord_lifn2 NOT IN s_ordar.
  ENDIF.

* To Filter Goods Supplier
  IF s_gsupp[] IS NOT INITIAL.
    DELETE i_data_size WHERE lifn2 NOT IN s_gsupp.
  ENDIF.

*}  INSERT
ENDFORM.                    " data_size_wise
*&---------------------------------------------------------------------*
*&      Form  get_add_data
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM get_add_data .
* get purch grp name
  SELECT ekgrp
         eknam INTO CORRESPONDING FIELDS OF TABLE i_t024_h
         FROM t024
  WHERE ekgrp IN s_ekgrp.

* get gs code.
  CLEAR:  v_output. "i_data_t[],  REFRESH i_data_t[].
  CLEAR: itgendr[], itaggrp[], itgszgp[], itprdct[], itprdsc[], itfabct[], itcolln[],
         itprdha[], itevent[], itbrgtp[].

*  i_data_t[] = i_data[].
*  SORT i_data_t BY ebeln.
*  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING ebeln.
  IF it_ebeln IS NOT INITIAL. "data_t
    CALL FUNCTION 'CONVERSION_EXIT_PARVW_INPUT'
      EXPORTING
        input  = v_input
      IMPORTING
        output = v_output.
* MahendraP added to get data of OA and PI details.
    CALL FUNCTION 'CONVERSION_EXIT_PARVW_INPUT'
      EXPORTING
        input  = v_input2
      IMPORTING
        output = v_output2.

    CALL FUNCTION 'CONVERSION_EXIT_PARVW_INPUT'
      EXPORTING
        input  = v_input3
      IMPORTING
        output = v_output3.

* chandimaw - 24/05/2012 - freight forwarder
    CALL FUNCTION 'CONVERSION_EXIT_PARVW_INPUT'
      EXPORTING
        input  = v_input4
      IMPORTING
        output = v_output4.

    SELECT ebeln
           parvw
           lifn2 INTO CORRESPONDING FIELDS OF TABLE  i_ekpa_h
           FROM ekpa
           FOR ALL ENTRIES IN it_ebeln "data_t
           WHERE ebeln = it_ebeln-ebeln AND  "data_t-
                 ebelp = '00000' AND
                 ( parvw = v_output OR
                 parvw = v_output2 OR   "MahendraP added on 2011-02-24
                 parvw = v_output3 OR   "MahendraP added on 2011-02-2
    parvw = v_output4 ).  "chandimaw - 24/05/2012 - freight forwarder

* End of Modification MahendraP
*    CLEAR i_ekpa_tmp. REFRESH i_ekpa_tmp.
*    CLEAR i_ekpa_h. REFRESH i_ekpa_h.
*    i_ekpa_tmp = i_ekpa.
*    DELETE ADJACENT DUPLICATES FROM i_ekpa_tmp COMPARING ebeln.
*    i_ekpa_h = i_ekpa_tmp.

  ENDIF.

* get vendor name
*  CLEAR: i_data_t[].  REFRESH i_data_t[].
*  i_data_t[] = i_data[].
*  SORT i_data_t BY lifnr.
*  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING lifnr.
*  LOOP AT i_data_t INTO wa_data.
*    wa_lifnr-lifnr = wa_data-lifnr.
*    APPEND wa_lifnr TO i_lifnr.
*  ENDLOOP.
  LOOP AT i_ekpa_h INTO wa_ekpa.
    wa_lifnr-lifnr = wa_ekpa-lifn2.
    COLLECT wa_lifnr INTO i_lifnr.
  ENDLOOP.

  SORT i_lifnr BY lifnr.
*  DELETE ADJACENT DUPLICATES FROM i_lifnr COMPARING lifnr.
  IF i_lifnr IS NOT INITIAL.
    SELECT lifnr
           name1
           land1 INTO CORRESPONDING FIELDS OF TABLE i_lfa1_h
           FROM lfa1
           FOR ALL ENTRIES IN i_lifnr
    WHERE lifnr = i_lifnr-lifnr.
*    CLEAR i_lfa1_h. REFRESH i_lfa1_h.
*    CLEAR i_lfa1_tmp. REFRESH i_lfa1_tmp.
*    i_lfa1_tmp = i_lfa1.
*    DELETE ADJACENT DUPLICATES FROM i_lfa1_tmp COMPARING lifnr.
*    i_lfa1_h = i_lfa1_tmp.

  ENDIF.

* get SO acc name
  IF it_zzkunnr IS NOT INITIAL.
    SELECT kunnr
           name1 INTO CORRESPONDING FIELDS OF TABLE i_kna1_h
           FROM kna1
           FOR ALL ENTRIES IN it_zzkunnr
    WHERE kunnr = it_zzkunnr-zzkunnr.
  ENDIF.

* get cust PO
  SORT it_zzvgbel BY zzvgbel.
  IF it_zzvgbel IS NOT INITIAL.
    SELECT vbeln
           bstnk vdatu gueen
* BOC by DGHOSAL on 5/21/2018
           vkorg vtweg spart
* EOC by DGHOSAL on 5/21/2018
           bsark  "Added for CH-2237 315873 Add SO PO type in Material PO report
           INTO CORRESPONDING FIELDS OF TABLE i_vbak_h
           FROM vbak
           FOR ALL ENTRIES IN it_zzvgbel
    WHERE vbeln = it_zzvgbel-zzvgbel.
  ENDIF.

* BOC by DGHOSAL on 5/21/2018
  SELECT kunnr
         vkorg
         vtweg
         spart
         kunn2
         knref
         FROM knvp
         INTO TABLE gt_knvp
         FOR ALL ENTRIES IN i_data
         WHERE kunnr = i_data-zzkunnr
           AND parvw = 'WE'
  AND kunn2 = i_data-ekunnr.
  IF sy-subrc IS INITIAL.
    SORT gt_knvp BY kunnr vkorg vtweg spart kunn2.
  ENDIF.

  SELECT kunnr
         vkorg
         vtweg
         spart
         dirshp
         FROM zedi_config
         INTO TABLE gt_edicon
         FOR ALL ENTRIES IN i_data
  WHERE kunnr = i_data-zzkunnr.
  IF sy-subrc IS INITIAL.
    SORT gt_edicon BY kunnr vkorg vtweg spart.
  ENDIF.
* EOC by DGHOSAL on 5/21/2018


* get mat des and color
  i_mara_tmp[] = i_mara[].
  DELETE ADJACENT DUPLICATES FROM i_mara_tmp COMPARING matnr.
  i_mara_h[] = i_mara_tmp[].
  REFRESH i_mara_tmp.

  IF i_mara_h  IS NOT INITIAL.
    SELECT matnr
           maktx INTO CORRESPONDING FIELDS OF TABLE i_makt_h
         FROM makt
         FOR ALL ENTRIES IN i_mara_h
         WHERE matnr = i_mara_h-matnr AND
    spras = 'EN'.

*   UPC
    SELECT * INTO TABLE i_mean FROM mean
    FOR ALL ENTRIES IN i_mara_h
    WHERE matnr = i_mara_h-matnr AND
          eantp NE 'Y1'.  " + CH-2685 : Ruchira : 19-July-2023

    SELECT spart zzval AS matnr spras zzdesc INTO TABLE gi_color_desc
    FROM zmlangdesc
    FOR ALL ENTRIES IN i_mara_h
    WHERE fieldname = 'NORMT' AND
    zzval     = i_mara_h-matnr.
  ENDIF.

* tot qty intran
  IF i_data IS NOT INITIAL.
    SELECT ekes~ebeln ekes~ebelp ekes~etens
* BOC by DGHOSAL on 6/9/2018 for SAP-75
           ekes~ebtyp ekes~eindt
* EOC by DGHOSAL on 6/9/2018 for SAP-75
           ekes~j_3asize ekes~menge ekes~dabmg
         INTO CORRESPONDING FIELDS OF TABLE i_ekes
         FROM ekes INNER JOIN vbup ON ekes~vbeln = vbup~vbeln AND
                                      ekes~vbelp = vbup~posnr
         FOR ALL ENTRIES IN i_data
         WHERE ekes~ebeln = i_data-ebeln AND
               ekes~ebelp = i_data-ebelp AND
               ekes~j_3asize = i_data-j_3asize AND
    ( vbup~wbsta = 'A' OR vbup~wbsta = 'B' ).
* BOC by DGHOSAL on 6/9/2018 for SAP-75
    IF sy-subrc IS INITIAL.
      i_ekes_ibd[] = i_ekes[].
      DELETE i_ekes_ibd WHERE dabmg IS NOT INITIAL.
      SORT i_ekes_ibd BY ebeln ebelp j_3asize eindt.
    ENDIF.
* EOC by DGHOSAL on 6/9/2018 for SAP-75
    SELECT ebeln ebelp wemng FROM eket INTO TABLE i_eket
                                       FOR ALL ENTRIES IN i_data
                                      WHERE ebeln EQ i_data-ebeln
    AND ebelp EQ i_data-ebelp.
    IF NOT i_eket[] IS INITIAL.
      SORT i_eket BY ebeln ebelp.
      LOOP AT i_eket INTO wa_eket.
        COLLECT wa_eket INTO i_eket1.
      ENDLOOP.
      REFRESH i_eket.
      i_eket[] = i_eket1[].
    ENDIF.
  ENDIF.

* Fetch data for Shipping Instruction from table T027B.
  SELECT spras evers evtxt
    INTO CORRESPONDING FIELDS OF TABLE i_t027b_h
    FROM t027b
  WHERE spras = sy-langu.

* Fetch data for Material Std. Price from table MBEW.
  IF i_mara[]  IS NOT INITIAL.   "
    SELECT matnr bwkey bwtar stprs
      INTO CORRESPONDING FIELDS OF TABLE i_mbew
      FROM mbew
      FOR ALL ENTRIES IN i_mara
      WHERE matnr = i_mara-matnr AND
    bwkey = i_mara-werks.
    "    vprsv EQ 'S'.
    SORT i_mbew BY matnr bwkey.
    DELETE ADJACENT DUPLICATES FROM i_mbew COMPARING matnr bwkey.
    i_mbew_h[] = i_mbew[].
    CLEAR: i_mbew[].
    IF p_msrp IS NOT INITIAL.
*BoC-CH-3245-ECDK927942-MSRP_COMPAT and MSRP logic change.
*   Compare at msrp for bcbg
      SELECT SINGLE kunnr INTO gv_factory
      FROM kna1
      WHERE sortl = 'BCBG61' AND
      ktokd = 'X001'.

      IF NOT gv_factory IS INITIAL.

* BOC by DGHOSAL on 6/19/2018
        DELETE gt_knvv WHERE kunnr = gv_factory.
        DELETE gt_zats_cust_lbl WHERE kunnr = gv_factory.
* EOC by DGHOSAL on 6/19/2018
*EoC-CH-3245-ECDK927942-MSRP_COMPAT and MSRP logic change.
*BoA-CH-3245-ECDK927942-MSRP_COMPAT and MSRP logic change.
**      TYPES: BEGIN OF lty_kunnr,
**               kunnr TYPE kunnr,
**             END OF lty_kunnr,
**             lrty_kunnr TYPE RANGE OF kunnr.
**      DATA: lt_kunnr TYPE STANDARD TABLE OF lty_kunnr WITH HEADER LINE,
**            lr_kunnr TYPE lrty_kunnr.
***   Compare at msrp for bcbg
**      SELECT kunnr INTO TABLE @lt_kunnr
**      FROM kna1
**      FOR ALL ENTRIES IN @i_data
**      WHERE kunnr = @i_data-zzkunnr AND
**            ktokd = 'X001'.
**      IF lt_kunnr[] IS NOT INITIAL.
*** Convert Internal table to range table to use it for further processing
**        lr_kunnr = VALUE rsdsselopt_t( FOR ls_kunnr IN lt_kunnr
**                                     ( sign = if_fsbp_const_range=>sign_include
**                                       option = if_fsbp_const_range=>option_equal
**                                       low = ls_kunnr ) ).
**        DELETE gt_knvv WHERE kunnr IN lr_kunnr.
**        DELETE gt_zats_cust_lbl WHERE kunnr IN lr_kunnr.
*EoA-CH-3245-ECDK927942-MSRP_COMPAT and MSRP logic change.

        SELECT a~matnr a~knumh b~j_3asize b~j_3atltyp a~vkorg b~j_3afield1 a~kunnr INTO TABLE gt_compat "" CH-3245-ECDK927942-315873-Added Kunnr MSRP_COMPAT and MSRP logic change.
        FROM kotk980 AS a
        INNER JOIN j_3avast AS b ON a~knumh = b~knumh
        FOR ALL ENTRIES IN i_mara
        WHERE a~kappl  = 'V'            AND
              a~kschl  = 'XVAS'         AND
              a~vkorg  = i_mara-werks   AND
              a~kunnr  = gv_factory     AND " Commented CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
*              kunnr IN lr_kunnr AND          " Added CH-3245-ECDK927942-315873-MSRP_COMPAT and MSRP logic change.
              a~matnr  = i_mara-matnr   AND
        a~datbi GE sy-datum.

        DELETE gt_compat WHERE j_3atltyp NE 'CPM'.
      ENDIF.

    ENDIF.
  ENDIF.
* Fetch data for Order Cancel Date from table VBAP.
*  CLEAR: i_data_t[].  REFRESH i_data_t[].
*  i_data_t[] = i_data[].
*  SORT i_data_t BY zzvgbel.
*  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING zzvgbel.
*  IF it_zzvgbel[]  IS NOT INITIAL.  "data_t
*    SORT it_zzvgbel.
*    SELECT vbeln  gueen " posnr
*      INTO CORRESPONDING FIELDS OF TABLE i_vbap_h
*      FROM vbak "vbap
*      FOR ALL ENTRIES IN it_zzvgbel "i_data_t
*      WHERE vbeln = it_zzvgbel-zzvgbel.     "i_data_t-zzvgbel.
**    DELETE ADJACENT DUPLICATES FROM i_vbap COMPARING vbeln.
**    i_vbap_h[] = i_vbap[].
**    CLEAR: i_vbap[].
*  ENDIF.

* Fetch data for Profit Center from table MARC.
  IF i_mara IS NOT INITIAL.
    SELECT matnr werks prctr herkl
      INTO CORRESPONDING FIELDS OF TABLE i_marc_h
      FROM marc
      FOR ALL ENTRIES IN i_mara
      WHERE matnr = i_mara-matnr AND
            werks = i_mara-werks AND
    prctr IN s_prctr.
  ENDIF.

  IF p_mat NE 'X'.
    IF it_knumv IS NOT INITIAL.
      SELECT knumv kposn stunr zaehk j_3aetenr kbetr
      INTO CORRESPONDING FIELDS OF TABLE i_konv_fob
      FROM konv
      FOR ALL ENTRIES IN it_knumv
      WHERE knumv = it_knumv-knumv AND
            kposn = it_knumv-kposn AND
      j_3aetenr = it_knumv-etenr.

      SORT i_konv_fob BY knumv kposn j_3aetenr ASCENDING.
      DELETE ADJACENT DUPLICATES FROM i_konv_fob COMPARING knumv kposn j_3aetenr.

      i_konv_fob_h = i_konv_fob.
    ENDIF.
  ENDIF.

** Get the port of entry descriptions
  SELECT add_info AS zport bezei INTO CORRESPONDING FIELDS OF TABLE it_zport
    FROM vtadd02t
  WHERE spras = sy-langu.

  "$ Region - attSam added on 31.10.2011
  SELECT zzhanger zzhangerdesc INTO CORRESPONDING FIELDS OF TABLE i_zhanger_h
  FROM zhanger.
*  IF i_zhanger[] IS NOT INITIAL.
*    SELECT zzhanger zzhangerdesc
*      INTO CORRESPONDING FIELDS OF TABLE i_zhanger_h
*      FROM zhanger
*      FOR ALL ENTRIES IN i_zhanger
*      WHERE zzhanger = i_zhanger-zzhanger.
*  ENDIF.

**** **** get material status description
  CLEAR i_data_t[]. REFRESH i_data_t[].
  i_data_t[] = i_data[].
  SORT i_data_t BY mstae.
  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING mstae.

  IF i_data_t IS NOT INITIAL.
    SELECT * INTO CORRESPONDING FIELDS OF TABLE gt_t141t
      FROM t141t
      FOR ALL ENTRIES IN i_data_t
      WHERE spras = sy-langu AND
    mmsta = i_data_t-mstae.

    gt_t141t_h[] = gt_t141t[].
  ENDIF.
  CLEAR i_data_t[]. REFRESH i_data_t[].

* Standardization: Get new MM field descriptions
  SELECT * INTO TABLE itgendr FROM ztgendr.
  SELECT * INTO TABLE itaggrp FROM ztaggrp.
  SELECT * INTO TABLE itbrgtp FROM ztbrgtp.
  SELECT * INTO TABLE itgszgp FROM ztgszgp.
  SELECT * INTO TABLE itprdct FROM ztprdct.
  SELECT * INTO TABLE itprdsc FROM ztprdsc.
  SELECT * INTO TABLE itfabct FROM ztfabct.
  SELECT * INTO TABLE itevent FROM ztevent.
  SELECT * INTO TABLE itcolln FROM ztcolln.
  SELECT * INTO TABLE itprdha FROM zroycodes
  WHERE zzlevel = '2'.
  SELECT * INTO TABLE itadesc FROM t163i WHERE spras EQ sy-langu.
  SELECT * INTO TABLE itcat FROM t163y WHERE spras EQ sy-langu.
  SELECT * INTO TABLE itcoltp FROM ztcoltp.
  SELECT * INTO TABLE itcuftp FROM ztcuftp.
  SELECT * INTO TABLE itfapyr FROM ztfapyr.
  SELECT * INTO TABLE itsilht FROM ztsilht.
  SELECT * INTO TABLE it_ztopdcl FROM ztopdcl.

  " sw1

  SELECT * INTO TABLE : lt_ztactvt FROM ztactvt,
           lt_zttheme FROM zttheme,
          lt_ztbkpkd FROM ztbkpkd,
          lt_ztbdftn  FROM ztbdftn,
        lt_ztbusun  FROM ztbusun,
lt_ztchorg  FROM ztchorg,
lt_ztchar2  FROM ztchar2,
lt_ztclass  FROM ztclass,
lt_ztdenft  FROM ztdenft ,
lt_ztdepmt  FROM ztdepmt ,
lt_ztfabat  FROM ztfabat ,
lt_ztfabnm  FROM ztfabnm ,
lt_ztfabst  FROM ztfabst ,
lt_ztftacc  FROM ztftacc ,
lt_zthwtrt  FROM zthwtrt ,
lt_zthemfn  FROM zthemfn ,
lt_ztlengt  FROM ztlengt ,
lt_ztmettp  FROM ztmettp ,
lt_ztpatrn  FROM ztpatrn ,
lt_ztpresn  FROM ztpresn,
lt_ztprcpt  FROM ztprcpt ,
lt_ztprdgr  FROM ztprdgr ,
lt_ztstone  FROM ztstone ,
lt_ztsclas  FROM ztsclas ,
lt_ztwaist  FROM ztwaist,
lt_ztwashy FROM ztwashy,
lt_ztwashs  FROM ztwashs ,
lt_ztwasht  FROM ztwasht ,
lt_ztlgopn  FROM ztlgopn,
lt_ztsilht  FROM ztsilht ,
lt_ztchars  FROM ztchars ,
lt_ztfabrn  FROM ztfabrn ,
lt_ztfapyr  FROM ztfapyr ,
lt_zhlht  FROM zhlht ,
lt_ztitplt FROM ztitplt,
lt_ztnctyp FROM ztnctyp,
lt_ztsetct FROM ztsetct,
lt_ztrpmnt FROM ztrpmnt,
lt_zshaftht FROM zshaftht,
lt_ztslvtp FROM ztslvtp,
lt_zstdet FROM zstdet,
lt_ztstfsh FROM ztstfsh,
lt_zinvstatus FROM zinvstatus.



*{ Begin of Change -9999011257 "Piyush Payasi
  REFRESH i_data_t[].
  i_data_t[] = i_data[].
  SORT i_data_t BY zznfabrn.
  DELETE ADJACENT DUPLICATES FROM i_data_t COMPARING zznfabrn.
  IF i_data_t[] IS NOT INITIAL.
    SELECT * INTO TABLE i_fabrn
    FROM ztfabrn
    FOR ALL ENTRIES IN i_data_t
    WHERE zznfabrn = i_data_t-zznfabrn.
  ENDIF.
*} End of Change -9999011257 "Piyush Payasi

  IF it_zkunnr[] IS NOT INITIAL.
*
    SELECT kunnr name1
      FROM kna1
        INTO TABLE it_cname
          FOR ALL ENTRIES IN it_zkunnr
    WHERE kunnr EQ it_zkunnr-zkunnr.
*
  ENDIF.
  REFRESH i_ekpv.
  IF i_data IS NOT INITIAL.
    SELECT ebeln ebelp kunnr vstel ladgr INTO TABLE i_ekpv
         FROM ekpv
         FOR ALL ENTRIES IN i_data
         WHERE ebeln = i_data-ebeln AND
    ebelp = i_data-ebelp.
  ENDIF.
*
ENDFORM.                    " get_add_data
*&---------------------------------------------------------------------*
*&      Form  build_layout_rev
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM build_layout_rev .
  wa_layout-no_input          = 'X'.
*  wa_layout-colwidth_optimize = 'X'.
*  wa_layout-expand_all        = 'X'.
  wa_layout-window_titlebar   = 'PO Status Report'(004) .
  wa_layout-totals_text       = 'Totals'(005).
  wa_layout-zebra             = 'X'.

ENDFORM.                    " build_layout_rev
*&---------------------------------------------------------------------*
*&      Form  build_field_catalog_rev
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM build_field_catalog_rev .

  DATA colno TYPE i.
  CLEAR colno.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'WERKS'.
  i_fieldcatalog-seltext_l   = 'Plant'(006).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '06'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EKGRP'.
  i_fieldcatalog-seltext_m   = 'Purch. Group'(007).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '12'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EKNAM'.
  i_fieldcatalog-seltext_l   = 'Purch. Group name'(008).      "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EINDT'.
  i_fieldcatalog-seltext_l   = 'Delivery Date'(009).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '16'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EBELN'.
  i_fieldcatalog-seltext_m   = 'PO Number'(010).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  i_fieldcatalog-hotspot     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EBELP'.
  i_fieldcatalog-seltext_l   = 'Line number'(011).   "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '12'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'KNTTP'.
  i_fieldcatalog-seltext_l   = text-124.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '2'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'KNTTX'.
  i_fieldcatalog-seltext_l   = text-128.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PSTYP'.
  i_fieldcatalog-seltext_l   = text-130.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '02'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PTEXT'.
  i_fieldcatalog-seltext_l   = text-129.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EKUNNR'.
  i_fieldcatalog-seltext_l   = text-125.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* BOC by DGHOSAL on 5/21/2018
  i_fieldcatalog-fieldname   = 'KNAME_SH'.
  i_fieldcatalog-seltext_l   = 'Ship-to Name'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'KNREF'.
  i_fieldcatalog-seltext_l   = 'Ship-to Partner Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '30'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 20 to 30
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'DIRSHP'.
  i_fieldcatalog-seltext_l   = 'Direct with EDI'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EOC by DGHOSAL on 5/21/2018

  i_fieldcatalog-fieldname   = 'EMLIF'.
  i_fieldcatalog-seltext_l   = text-126.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'LBLKZ'.
  i_fieldcatalog-seltext_l   = text-127.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '2'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ELIKZ'.
  i_fieldcatalog-seltext_l   = text-131.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '2'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZTERM'.
  i_fieldcatalog-seltext_l   = text-132.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '4'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'LIFNR'.
  i_fieldcatalog-seltext_l   = 'Vendor Code'(012).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'VEN_NAM'.
  i_fieldcatalog-seltext_m   = 'Vendor Name'(013).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'LIFN2'.
  i_fieldcatalog-seltext_l   = 'Goods Supplier Code'(014).   "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'SUP_NAM'.
  i_fieldcatalog-seltext_l   = 'Goods Supplier Name'(015).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'LAND1'.
  i_fieldcatalog-seltext_m   = 'C.O.O.'(016).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'HERKL'.
  i_fieldcatalog-seltext_m   = 'C.O.O (Material)'(134).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZXPORTDAT'.
  i_fieldcatalog-seltext_l   = 'X-Port Date'(017).   "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZFCRDAT'.
  i_fieldcatalog-seltext_l   = 'CR Date'(135).   "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZONBDAT'.
  i_fieldcatalog-seltext_l   = 'Onboard Date'(136).   "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'AFNAM'.
  i_fieldcatalog-seltext_l   = 'Requisitioner'(120).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT Start
  IF p_postat = 'X' OR p_polac = 'X'. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
* { Boc - CH-2948-ECDK927161-311464-14-Nov-2023

    i_fieldcatalog-fieldname   = 'SPART'.
    i_fieldcatalog-seltext_l   = 'Division'(152).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'VTEXT'.
    i_fieldcatalog-seltext_l   = 'Division Name'(153).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '20'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

* } EoC - CH-2948-ECDK927161-311464-14-Nov-2023


    i_fieldcatalog-fieldname   = 'BSGRU'.
*    i_fieldcatalog-seltext_m   = 'Reaon for Ord. code'(123).  " -HKT ECDK911110 Change BSGRU field name 14.12.2017
    i_fieldcatalog-seltext_m   = 'PO Ord. Reason Code'(123).   " +HKT ECDK911110 Change BSGRU field name 14.12.2017
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '17'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'BEZEI'.
*    i_fieldcatalog-seltext_m   = 'Reason for Ord.'(122).   " -HKT ECDK911110 Change BEZEI field name 14.12.2017
    i_fieldcatalog-seltext_m   = 'PO Ordering Reason'(122). " +HKT ECDK911110 Change BEZEI field name 14.12.2017
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '17'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.
* + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT END
  IF p_mat = 'X'.
    i_fieldcatalog-fieldname   = 'ZCMSNO'.
    i_fieldcatalog-seltext_m   = 'CMS#'(041).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '20'.
    i_fieldcatalog-do_sum   = 'X'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'ZZNRFDESC'.
    i_fieldcatalog-seltext_l   = 'NRF Size Des./Ratio'(081).    "Modified
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '40'.
    i_fieldcatalog-do_sum      = ''.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'PASIN'.
    i_fieldcatalog-seltext_l   = 'Parent ASIN'(144).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '12'.
    i_fieldcatalog-no_zero     = 'X'.   "+ SriRam : LF 9999013477 :4/02/2015
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

  ENDIF.

  "$ Region - attSam added on 31.10.2011
  i_fieldcatalog-fieldname   = 'ZZHANGER'.
  i_fieldcatalog-seltext_l   = 'Packaging Type'(088).      "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  i_fieldcatalog-do_sum      = ''.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZHANGERDESC'.
  i_fieldcatalog-seltext_l   = 'Packaging Type Description'(090).    "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  i_fieldcatalog-do_sum      = ''.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  "$ Endregion - attSam added on 31.10.2011

  i_fieldcatalog-fieldname   = 'ZZKUNNR'.
  i_fieldcatalog-seltext_l   = 'Sold-to Customer'(018).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PTO_NAM'.
  i_fieldcatalog-seltext_m   = 'Customer Name'(019).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'BSTNK'.
  i_fieldcatalog-seltext_m   = 'Cust PO #'(020).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ORD_LIFN2'.
  i_fieldcatalog-seltext_l   = 'Ordering Party'(083).        "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '22'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ORD_NAME1'.
  i_fieldcatalog-seltext_l   = 'Ordering Party Name'(084).       "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PI_LIFN2'.
  i_fieldcatalog-seltext_l   = 'Pur.Inv.Party'(085).             "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '22'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PI_NAME1'.
  i_fieldcatalog-seltext_l   = 'Pur.Inv.Name'(086).                "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* chandimaw - 24/05/2012 - freight forwarder
  i_fieldcatalog-fieldname   = 'CR_LIFN2'.
  i_fieldcatalog-seltext_l   = 'Freight Forwarder'(101).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.                              "Modified
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'CR_NAME1'.
  i_fieldcatalog-seltext_l   = 'Freight Forwarder Name'(102).         "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* end chandimaw - 24/05/2012

  i_fieldcatalog-fieldname   = 'BEDNR'.
  i_fieldcatalog-seltext_m   = 'Tracking Number'(087).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* End of adding

  i_fieldcatalog-fieldname   = 'ZZVGBEL'.
  i_fieldcatalog-seltext_l   = 'Order No.'(021).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* Begin of Addition For CH-2237 315873 Add SO PO type in Material PO report.
  i_fieldcatalog-fieldname   = 'BSARK'.
  i_fieldcatalog-seltext_l   = 'SO PO Type.'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* End of Addition For CH-2237 315873 Add SO PO type in Material PO report.

  i_fieldcatalog-fieldname   = 'LGORT'.
  i_fieldcatalog-seltext_m   = 'St Loc'(022).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MATNR'.
  i_fieldcatalog-seltext_m   = 'Material'(023).
  i_fieldcatalog-ref_tabname = 'EKPO'.     "+PJDK939569
  i_fieldcatalog-ref_fieldname = 'MATNR'.  "+PJDK939569
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'LBL'.
  i_fieldcatalog-seltext_l   = 'Label'(024).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MAKTX'.
  i_fieldcatalog-seltext_l   = 'Material Description'(025).        "Modified
  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '35'.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MEINS'.
  i_fieldcatalog-seltext_m   = 'UOM'(040).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '3'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'NORMT'.
  i_fieldcatalog-seltext_l   = 'Color Description'(026).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EVTXT'.
  i_fieldcatalog-seltext_m   = 'Ship Mode'(044).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZDIRORT'.               "TD
  i_fieldcatalog-seltext_m   = 'PO Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZPORTENTRY'.
  i_fieldcatalog-seltext_m   = 'Port of Entry'(045).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZPORT_DESC'.
  i_fieldcatalog-seltext_m   = 'Port of Entry Name'(082).
  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '30'.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  IF p_polac IS INITIAL. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
    i_fieldcatalog-fieldname   = 'STPRS'.
    i_fieldcatalog-seltext_m   = 'Standard Cost'(046).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
  i_fieldcatalog-fieldname   = 'VDATU'.
  i_fieldcatalog-seltext_l   = 'Customer Due Date'(047).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
  i_fieldcatalog-fieldname   = 'SONET'.
  i_fieldcatalog-seltext_l   = 'SO Net Price'(156).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'SOVAL'.
  i_fieldcatalog-seltext_l   = 'SO Value'(157).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'DELNO'.
  i_fieldcatalog-seltext_l   = 'Delivery No'(158).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'CONID'.
  i_fieldcatalog-seltext_l   = 'Container ID'(159).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'CUSST'.
  i_fieldcatalog-seltext_l   = 'Customer Start Date'(154).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'CUSCA'.
  i_fieldcatalog-seltext_l   = 'Customer cancel Date'(155).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button

  i_fieldcatalog-fieldname   = 'ZZOLLA'.
  i_fieldcatalog-seltext_m   = 'Port of Exit'(050).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZOLLA_DESC'.
  i_fieldcatalog-seltext_m   = 'Port of Exit Name'(080).
  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'GUEEN'.
  i_fieldcatalog-seltext_l   = 'Customer SO cancel Date'(051).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'PRCTR'.
  i_fieldcatalog-seltext_m   = 'Profit Center'(052).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '14'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'WIP_VOL'.
  i_fieldcatalog-seltext_l   = 'Total WIP Volume (FT3)'(057).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '23'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'UNSEZ'.
  i_fieldcatalog-seltext_m   = 'Factory No'(055).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'AEDAT'.
  i_fieldcatalog-seltext_l   = 'PO Creation date'."(056).
  i_fieldcatalog-seltext_m   = 'PO Creation date'."(056).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.


  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ERNAM'.
  i_fieldcatalog-seltext_l   = 'PO Creation By'(142).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '17'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  IF p_size = 'X'.
    i_fieldcatalog-fieldname   = 'J_3ASIZE'.
    i_fieldcatalog-seltext_l   = 'Material Size'(027).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'J_3AKORD1'.        "asangad 04112011
    i_fieldcatalog-seltext_l   = 'Size'(091).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'J_3AKORD2'.         "asangad 04112011
    i_fieldcatalog-seltext_l   = 'Width'(092).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

  ENDIF.

  i_fieldcatalog-fieldname   = 'QTY_BOOK'.
  i_fieldcatalog-seltext_m   = 'Tot Qty Booked'(028).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'AMNT_BOOK'.
  i_fieldcatalog-seltext_l   = 'Total PO amount'(029).          "PO Booked Amount gajaba 20090820
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_CNC'.
  i_fieldcatalog-seltext_l   = 'Total Canceled'(030).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_INTRA'.
  i_fieldcatalog-seltext_m   = 'Tot Qty In tran'(031).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  IF p_mat = 'X'.
    i_fieldcatalog-fieldname   = 'AMNT_INTRA'.
    i_fieldcatalog-seltext_m   = 'Tot Amt InTran'(032).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '18'.
    i_fieldcatalog-do_sum   = 'X'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.

  i_fieldcatalog-fieldname   = 'QTY_RCV'.
  i_fieldcatalog-seltext_l   = 'Tot Qty Rcv'(033).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  IF p_mat = 'X'.
    i_fieldcatalog-fieldname   = 'AMNT_RCV'.
    i_fieldcatalog-seltext_m   = 'Tot Amt Rcv'(034).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '18'.
    i_fieldcatalog-do_sum   = 'X'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.

  i_fieldcatalog-fieldname   = 'QTY_WIP'.
  i_fieldcatalog-seltext_m   = 'WIP Balance'(035).          "PO Balance gajaba 20090820
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'AMNT_WIP'.
  i_fieldcatalog-seltext_l   = 'WIP amount'(036).        "PO Open amount gajaba 20090820
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_VAR'.
  i_fieldcatalog-seltext_l   = 'Variance PO vs Shipped'(037).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'TOT_CTN'.
  i_fieldcatalog-seltext_l   = 'Total no of cartons'(058).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  i_fieldcatalog-no_zero     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'IHREZ'.
  i_fieldcatalog-seltext_l   = 'PO Reference #'(062).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '12'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  IF p_polac IS INITIAL. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
    i_fieldcatalog-fieldname   = 'NETPR'.
    i_fieldcatalog-seltext_l   = 'FOB Price'(063).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '13'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
* Begin of +SP13May2010
*  i_fieldcatalog-fieldname   = 'ZKUNNR'.
*  i_fieldcatalog-seltext_l   = 'Mat. For Customer'(064).
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '20'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZPRE_PACK_QTY'.
  i_fieldcatalog-seltext_l   = 'PPK Quantity'(066).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '16'.
  i_fieldcatalog-no_zero     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'WRKST'.
  i_fieldcatalog-seltext_l   = 'PLM Product Number'(065).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '48'. " CH-3245-315873-ECDK927942-Extend the truncation field length from 25 to 48
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'BISMT'.
  i_fieldcatalog-seltext_l   = 'Style Number'(121).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'INCO1'.
  i_fieldcatalog-seltext_l   = 'PO Incoterm'(067).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'SUBMI'.
  i_fieldcatalog-seltext_l   = 'Collective Number'(147).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '17'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
  i_fieldcatalog-fieldname   = 'ZEXEMPT'.
  i_fieldcatalog-seltext_l   = 'Price Exemption'(133).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967
* chandimaw - 13/07/2012 - add costing inco term
  i_fieldcatalog-fieldname   = 'COST_INCO1'.
  i_fieldcatalog-seltext_l   = 'Costing Incoterm'(104).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '23'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* end chandimaw - 13/07/2012

  i_fieldcatalog-fieldname   = 'J_3AEXFCM'.
  i_fieldcatalog-seltext_l   = 'Ex factory Date'(068).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZOFFERDAT'.
  i_fieldcatalog-seltext_l   = 'Original Delivery date'(069).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZEXFACT'.
  i_fieldcatalog-seltext_l   = 'Original Ex factory date'(070).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MVGR1'.
  i_fieldcatalog-seltext_l   = 'Sub Profit Center'(071).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  "$ Region - attSam added on 31.10.2011
  i_fieldcatalog-fieldname   = 'MVGR1_DESC'.
  i_fieldcatalog-seltext_l   = 'Sub Profit Center Description'(089).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  "$ Endregion - attSam added on 31.10.2011

  i_fieldcatalog-fieldname   = 'KBETR'.
  i_fieldcatalog-seltext_l   = 'Sales Price'(072).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  i_fieldcatalog-no_zero     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  "Begin of changes by SRIRAM 9999013477
  i_fieldcatalog-fieldname   = 'KONWA'.
  i_fieldcatalog-seltext_l   = 'Sales Price Currency'(113).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  i_fieldcatalog-no_zero     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  "End of changes by SRIRAM 9999013477

  i_fieldcatalog-fieldname   = 'MWAER'.               "TD
  i_fieldcatalog-seltext_l   = 'Group Currency'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  i_fieldcatalog-no_zero     = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'J_3APQTY'.
  i_fieldcatalog-seltext_l   = 'Pcs/Carton'(079).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '14'.
  i_fieldcatalog-no_zero     = '0'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_BOOK_PC'.
  i_fieldcatalog-seltext_m   = 'Tot PO Qty in PC'(073).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_CNC_PC'.
  i_fieldcatalog-seltext_l   = 'Total Canceled in PC'(074).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_INTRA_PC'.
  i_fieldcatalog-seltext_m   = 'Tot Qty In tran in PC'(075).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '32'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_RCV_PC'.
  i_fieldcatalog-seltext_l   = 'Tot Qty Rcv in PC'(076).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '32'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_WIP_PC'.
  i_fieldcatalog-seltext_m   = 'WIP Bal in PC'(077).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'QTY_VAR_PC'.
  i_fieldcatalog-seltext_l   = 'Var.PO vs Shipped in PC'(078).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'.
  i_fieldcatalog-do_sum   = 'X'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MSTAE'.
  i_fieldcatalog-seltext_l   = 'Material Status'(093).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '22'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MTSTB'.
  i_fieldcatalog-seltext_l   = 'Material Status Text'(096).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  IF p_msrp IS NOT INITIAL.
    i_fieldcatalog-fieldname   = 'MSRP'.
    i_fieldcatalog-seltext_l   = 'MSRP'(097).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    i_fieldcatalog-no_zero     = 'X'.   "+ SriRam : LF 9999013477 :4/02/2015
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.

  IF p_size IS NOT INITIAL.
    i_fieldcatalog-fieldname   = 'PASIN'.
    i_fieldcatalog-seltext_l   = 'Parent ASIN'(144).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '12'.
    i_fieldcatalog-no_zero     = 'X'.   "+ SriRam : LF 9999013477 :4/02/2015
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'CASIN'.
    i_fieldcatalog-seltext_l   = 'Child ASIN'(145).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '12'.
    i_fieldcatalog-no_zero     = 'X'.   "+ SriRam : LF 9999013477 :4/02/2015
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.

  i_fieldcatalog-fieldname   = 'WAERS'.
  i_fieldcatalog-seltext_l   = 'Currency'(098).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*{  INSERT  PJDK926501  14.08.2012  MP

  IF p_ppk_br EQ 'X'.

    i_fieldcatalog-fieldname   = 'COMP_MATNR'.
    i_fieldcatalog-seltext_l   = 'Component Material'(105).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '25'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'COMP_J_3ASIZE'.
    i_fieldcatalog-seltext_l   = 'Component Grid Value'(106).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '25'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'CCASIN'.
    i_fieldcatalog-seltext_l   = 'Component ASIN'(146).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '12'.
    i_fieldcatalog-no_zero     = 'X'.   "+ SriRam : LF 9999013477 :4/02/2015
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'COMP_NETPR'.
    i_fieldcatalog-seltext_l   = 'Component Unit price'(107).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '25'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'COMP_QTY'.
    i_fieldcatalog-seltext_l   = 'Component Qty'(108).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '18'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'COMP_VAL'.
    i_fieldcatalog-seltext_l   = 'Component Value'(109).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '18'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'COMP_EAN11'.
    i_fieldcatalog-seltext_m   = 'Component UPC'(151).
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '18'. " CH-3245-315873-ECDK927942-Extend the truncation field length from 12 to 18
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

  ENDIF.

  "$ Region attSam added on 30 Aug 2012 - Show first sales flag
  i_fieldcatalog-fieldname   = 'ZZFRSL'.
  i_fieldcatalog-seltext_l   = 'First Sales Flag'(110).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  "$ Endregion attSam added on 30 Aug 2012 - Show first sales flag

*}  INSERT
*{  INSERT  PJDK928062  26.11.2012  MP
  i_fieldcatalog-fieldname   = 'INSMK'.
  i_fieldcatalog-seltext_l   = 'Stock Type'(111).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'DDTEXT'.
  i_fieldcatalog-seltext_l   = 'Stock Type Desc'(112).
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '30'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*}  INSERT

* Data Standardization: Add new MM fields and descriptions
  i_fieldcatalog-fieldname   = 'ZZNGENDR'.
  i_fieldcatalog-seltext_l   = 'Gender'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNGENDRTXT'.
  i_fieldcatalog-seltext_l   = 'Gender Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNAGGRP'.
  i_fieldcatalog-seltext_l   = 'Age Group'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNAGGRPTXT'.
  i_fieldcatalog-seltext_l   = 'Age Group Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNGSZGP'.
  i_fieldcatalog-seltext_l   = 'Size Group'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNGSZGPTXT'.
  i_fieldcatalog-seltext_l   = 'Size Group Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSEASN'.
  i_fieldcatalog-seltext_l   = 'Season'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSEASNTXT'.
  i_fieldcatalog-seltext_l   = 'Season Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZYEAR'.
  i_fieldcatalog-seltext_l   = 'Season Year'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZSNYRTXT'.
  i_fieldcatalog-seltext_l   = 'Season Year Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNCOLTP'.
*  i_fieldcatalog-seltext_l   = 'Collar Type'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '11'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNCOLTPTXT'.
*  i_fieldcatalog-seltext_l   = 'Collar Type Description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '40'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNCUFTP'.
*  i_fieldcatalog-seltext_l   = 'Cuff Type'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '11'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNCUFTPTXT'.
*  i_fieldcatalog-seltext_l   = 'Cuff Type Description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '40'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNFAPYR'.
*  i_fieldcatalog-seltext_l   = 'Fashion Pyramid'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '15'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.
*
*  i_fieldcatalog-fieldname   = 'ZZNFAPYRTXT'.
*  i_fieldcatalog-seltext_l   = 'Fashion Pyramid Description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '40'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.


*  i_fieldcatalog-fieldname   = 'ZZNSILHT'.
*  i_fieldcatalog-seltext_l   = 'Silhouette'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '10'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.
*
*  i_fieldcatalog-fieldname   = 'ZZNSILHTTXT'.
*  i_fieldcatalog-seltext_l   = 'Silhouette Description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '40'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.



  i_fieldcatalog-fieldname   = 'ZZNPRDCT'.
  i_fieldcatalog-seltext_l   = 'Product Category'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '20'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPRDCTTXT'.
  i_fieldcatalog-seltext_l   = 'Product Category Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNPRDSC'.
*  i_fieldcatalog-seltext_l   = 'Product Sub Category'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '25'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNPRDSCTXT'.
*  i_fieldcatalog-seltext_l   = 'Product Sub Category Description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '40'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABCT'.
  i_fieldcatalog-seltext_l   = 'Fabric Category'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABCTTXT'.
  i_fieldcatalog-seltext_l   = 'Fabric Category Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*{ Begin of Change -9999011257 "Piyush Payasi
  i_fieldcatalog-fieldname   = 'ZZNFABRN'.
  i_fieldcatalog-seltext_l   = 'Fabric Concept'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABRNTXT'.
  i_fieldcatalog-seltext_l   = 'Fabric Concept Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*} End of Change -9999011257

*  ( Begin of Change-9999012212 "SRI RAM
  i_fieldcatalog-fieldname   = 'ZZNRPMNT'.
  i_fieldcatalog-seltext_l   = 'Replenishment'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*  ) End of Change -9999012212

  i_fieldcatalog-fieldname   = 'ZZNCOLLN'.
  i_fieldcatalog-seltext_l   = 'Collection'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCOLLNTXT'.
  i_fieldcatalog-seltext_l   = 'Collection Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRAND'.
  i_fieldcatalog-seltext_l   = 'Brand'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRANDTXT'.
  i_fieldcatalog-seltext_l   = 'Brand Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRGRP'.
  i_fieldcatalog-seltext_l   = 'Brand Group'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRGRPTXT'.
  i_fieldcatalog-seltext_l   = 'Brand Group Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRGTP'.
  i_fieldcatalog-seltext_l   = 'Brand Group Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBRGTPTXT'.
  i_fieldcatalog-seltext_l   = 'Brand Group Type Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZPRDHA'.
  i_fieldcatalog-seltext_l   = 'Royalty Code'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 15 to 18
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZLICDESC'.
  i_fieldcatalog-seltext_l   = 'Licensor Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZPRDESC'.
  i_fieldcatalog-seltext_l   = 'Property Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSTMTH'.
  i_fieldcatalog-seltext_l   = 'In-store Month'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNEVENT'.
  i_fieldcatalog-seltext_l   = 'Event'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNEVENTTXT'.
  i_fieldcatalog-seltext_l   = 'Event Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*{  INSERT   PJDK930237  06.05.2013 NR
  IF p_sh_pln = 'X'.
    i_fieldcatalog-fieldname   = 'XBLNR'.
    i_fieldcatalog-seltext_l   = 'Conf. Ref#'.                                 "'Shipment Plan'.   "Change done by sriram
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '35'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 30 to 35
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'MENGE_S'.
    i_fieldcatalog-seltext_l   = 'Conf. Control Qty'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'EINDT_S'.
    i_fieldcatalog-seltext_l   = 'Ship ETA'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'ERDAT'.
    i_fieldcatalog-seltext_l   = 'Conf. Date'.                              "'Ship ETD'.     "change done by Sri Ram
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'EBTYP'.
    i_fieldcatalog-seltext_l   = 'Conf. Category'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'EBTXT'.
    i_fieldcatalog-seltext_l   = 'Conf. Cat. Description'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '20'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 15 to 20
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.
*}
*  *++
  i_fieldcatalog-fieldname   = 'ZKUNNR'.
  i_fieldcatalog-seltext_l   = 'Material for Customer'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '30'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*
  i_fieldcatalog-fieldname   = 'CUSTNAME'.
  i_fieldcatalog-seltext_l   = 'Material for Customer description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*++
*start "FNT Change NF 10/17/2017
  i_fieldcatalog-fieldname   = 'RESWK'.
  i_fieldcatalog-seltext_l   = 'Supplying Plant'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'KUNNR'.
*  i_fieldcatalog-seltext_l   = 'Ship-to Customer'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '10'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'VSTEL'.
  i_fieldcatalog-seltext_l   = 'Shipping Point'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'LADGR'.
  i_fieldcatalog-seltext_l   = 'Loading Group'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'RESLO'.
  i_fieldcatalog-seltext_l   = 'Issuing Storage Loc.'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
*end "FNT Change NF 10/17/2017

  i_fieldcatalog-fieldname   = 'ZZLATECD'.
  i_fieldcatalog-seltext_m   = 'Late Code'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZLATEDESC'.
  i_fieldcatalog-seltext_m   = 'Late Code Desc'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '40'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 20 to 40
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EAN11'.
  i_fieldcatalog-seltext_m   = 'UPC'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 12 to 18
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  IF p_msrp IS NOT INITIAL.

* Begin of changes - ECDK915177 - Pio Fernando
*    IF gv_msrp_control IS INITIAL.
* End of changes - ECDK915177 - Pio Fernando

    i_fieldcatalog-fieldname   = 'MSRPCAD'.
    i_fieldcatalog-seltext_m   = 'MSRP (CAD)'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '12'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

* Begin of changes - ECDK915177 - Pio Fernando
*    ENDIF.
* End of changes - ECDK915177 - Pio Fernando

    i_fieldcatalog-fieldname   = 'MSRP_COMPAT'.
    i_fieldcatalog-seltext_m   = 'Compare At MSRP'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '15'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.
  i_fieldcatalog-fieldname   = 'COL_DESC_FR'.
  i_fieldcatalog-seltext_m   = 'French Color Desc'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 20 to 50
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* BOC by DGHOSAL on 4/20/2018 for BCBG
  i_fieldcatalog-fieldname   = 'J_3ACOL'.
  i_fieldcatalog-seltext_m   = 'Color'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EOC by DGHOSAL on 4/20/2018 for BCBG


* BOC by DGHOSAL on 6/9/2018 for SAP-75
  i_fieldcatalog-fieldname   = 'IBD_DATE'.
  i_fieldcatalog-seltext_m   = 'ETA Warehouse (IBD)'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EOC by DGHOSAL on 6/9/2018 for SAP-75


*Add AP 12/06/2020
  i_fieldcatalog-fieldname   = 'FRGKE '.
  i_fieldcatalog-seltext_m   = 'Release Indicator'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EAEDAT'.
  i_fieldcatalog-seltext_m   = 'PO Item Change Date'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*End Add

*Add AP 15/07/2022, ED1K900279
  i_fieldcatalog-fieldname   = 'OFFER_DATE'.
  i_fieldcatalog-seltext_m   = 'Offer Date'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*End Add

*-- Begin of changes - ECDK920847 - SQADIR

  i_fieldcatalog-fieldname   = 'REDAT'.
  i_fieldcatalog-seltext_m   = 'PO Release Date'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*-- End of changes - ECDK920847 - SQADIR

* Begin of changes - ECDK922248  Ruchira Sampath
  i_fieldcatalog-fieldname   = 'EINDT_PB'.
  i_fieldcatalog-seltext_m   = 'Booked ETA PB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ERDAT_PB'.
  i_fieldcatalog-seltext_m   = 'Booked Date PB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'XBLNR_PB'.
  i_fieldcatalog-seltext_m   = 'Reference # PB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 10 to 35
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EINDT_AB'.
  i_fieldcatalog-seltext_m   = 'Booked ETA AB'.
  i_fieldcatalog-seltext_l   = 'Booked ETA AB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ERDAT_AB'.
  i_fieldcatalog-seltext_m   = 'Booked ETD AB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'XBLNR_AB'.
  i_fieldcatalog-seltext_m   = 'Reference # AB'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 10 to 35
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'XBLNR_LA'.
  i_fieldcatalog-seltext_m   = 'Reference # LA'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '35'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 10 to 35
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* End of changes - ECDK922248 Ruchira Sampath



*Add AP 09/02/2022,ECDK923295
**  i_fieldcatalog-fieldname   = 'DOCNUM'.
**  i_fieldcatalog-seltext_m   = 'IDoc number'.
**  i_fieldcatalog-col_pos     = colno.
**  i_fieldcatalog-outputlen   = '17'.
**  APPEND i_fieldcatalog TO i_fieldcatalog.
**  CLEAR  i_fieldcatalog.
**  ADD 1 TO colno.
**
**
**  i_fieldcatalog-fieldname   = 'STATUS'.
**  i_fieldcatalog-seltext_m   = 'Status of IDoc'.
**  i_fieldcatalog-col_pos     = colno.
**  i_fieldcatalog-outputlen   = '15'.
**  APPEND i_fieldcatalog TO i_fieldcatalog.
**  CLEAR  i_fieldcatalog.
**  ADD 1 TO colno.
**
**
**  i_fieldcatalog-fieldname   = 'STATXT'.
**  i_fieldcatalog-seltext_m   = 'Text for status code'.
**  i_fieldcatalog-col_pos     = colno.
**  i_fieldcatalog-outputlen   = '50'.
**  APPEND i_fieldcatalog TO i_fieldcatalog.
**  CLEAR  i_fieldcatalog.
**  ADD 1 TO colno.
**
**  i_fieldcatalog-fieldname   = 'CREDAT'.
**  i_fieldcatalog-seltext_m   = 'Date status IDOC record was created'.
**  i_fieldcatalog-col_pos     = colno.
**  i_fieldcatalog-outputlen   = '40'.
**  APPEND i_fieldcatalog TO i_fieldcatalog.
**  CLEAR  i_fieldcatalog.
**  ADD 1 TO colno.



*End Add

* BOC by PFERNANDO on 7/23/2018
  IF p_postat = 'X' OR p_polac = 'X'. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
    i_fieldcatalog-fieldname   = 'TOT_PO_FOB'.
    i_fieldcatalog-seltext_m   = 'Tot PO Amount in FOB'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '20'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.

    i_fieldcatalog-fieldname   = 'TOT_PO_STD'.
    i_fieldcatalog-seltext_l   = 'Tot PO Amount in Std Cost'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '25'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.
* EOC by DGHOSAL on 7/23/2018 for BGBC

* BOC by RUCHIRA on 7/20/2021
  i_fieldcatalog-fieldname   = 'ZZHTS1'.
  i_fieldcatalog-seltext_m   = 'HTS Code'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '17'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZHTS1DESC'.
  i_fieldcatalog-seltext_l   = 'HTS Code Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '200'. "CH-3245-315873-ECDK927942-Extend the truncation field length from 25 to 200
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
* EOC by RUCHIRA on 7/20/2021

* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
  i_fieldcatalog-fieldname   = 'ZZNOPDCL'.
  i_fieldcatalog-seltext_m   = 'Othr.Prdct.Clssf.'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '15'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNOPDCLTXT'.
  i_fieldcatalog-seltext_l   = 'Othr.Prduct Classification Desc.'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

  " sw1

  i_fieldcatalog-fieldname   = 'ZZNACTVT'.
  i_fieldcatalog-seltext_l   = 'Activity'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNACTVTXT'.
  i_fieldcatalog-seltext_l   = 'Activity description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNTHEME'.
  i_fieldcatalog-seltext_l   = 'Theme'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNTHEMETXT'.
  i_fieldcatalog-seltext_l   = 'Theme description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.

  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNBKPKD'.
  i_fieldcatalog-seltext_l   = 'Back Pocket Detail'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBKPKDTXT'.
  i_fieldcatalog-seltext_l   = 'Back Pocket Detail description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBDFTN'.
  i_fieldcatalog-seltext_l   = 'Brand Fit Name'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBDFTNTXT'.
  i_fieldcatalog-seltext_l   = 'Brand Fit Name description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNBUSUN'.
  i_fieldcatalog-seltext_l   = 'Business Unit Level'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZTBUSUNTXT'.
  i_fieldcatalog-seltext_l   = 'Business Unit Level description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCHORG'.
  i_fieldcatalog-seltext_l   = 'Channel Origination'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '500'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCHORGTXT'.
  i_fieldcatalog-seltext_l   = 'Channel Origination description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZNCHAR2'.
  i_fieldcatalog-seltext_l   = 'Character'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCHAR2TXT'.
  i_fieldcatalog-seltext_l   = 'Character description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNCHAR2TXT'.
*  i_fieldcatalog-seltext_l   = 'Character description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '50'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCLASS'.
  i_fieldcatalog-seltext_l   = 'Class '.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCLASSTXT '.
  i_fieldcatalog-seltext_l   = 'Class description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNDENFT'.
  i_fieldcatalog-seltext_l   = 'Denim Fit'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNDENFTTXT'.
  i_fieldcatalog-seltext_l   = 'Denim Fit description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNDEPMT'.
  i_fieldcatalog-seltext_l   = 'Department'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNDEPMTXT'.
  i_fieldcatalog-seltext_l   = 'Department description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABAT'.
  i_fieldcatalog-seltext_l   = 'Fabric Attribute'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABATXT'.
  i_fieldcatalog-seltext_l   = 'Fabric Attribute description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNFABNM'.
  i_fieldcatalog-seltext_l   = 'Fabric Name'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNFABNMTXT'.
  i_fieldcatalog-seltext_l   = 'Fabric Name description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNFABST'.
  i_fieldcatalog-seltext_l   = 'Fabric Sustainability'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFABSTXT'.
  i_fieldcatalog-seltext_l   = 'Fabric Sustainability description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFTACC'.
  i_fieldcatalog-seltext_l   = 'Fit Accommodation'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFTACCTXT'.
  i_fieldcatalog-seltext_l   = 'Fit Accommodation description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNHWTRT'.
  i_fieldcatalog-seltext_l   = 'Hardware Treatment'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNHWTRTTXT'.
  i_fieldcatalog-seltext_l   = 'Hardware Treatment description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNHEMFN'.
  i_fieldcatalog-seltext_l   = 'Hem Finish'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNHEMFNTXT'.
  i_fieldcatalog-seltext_l   = 'Hem Finish description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNLENGT'.
  i_fieldcatalog-seltext_l   = 'Length'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNLENGTXT'.
  i_fieldcatalog-seltext_l   = 'Length description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNMETTP'.
  i_fieldcatalog-seltext_l   = 'Metal Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNMETTPTXT'.
  i_fieldcatalog-seltext_l   = 'Metal Type description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPATRN'.
  i_fieldcatalog-seltext_l   = 'Pattern'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPATRNTXT'.
  i_fieldcatalog-seltext_l   = 'Pattern description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPRESN'.
  i_fieldcatalog-seltext_l   = 'Presentation'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZNPRESNTXT'.
  i_fieldcatalog-seltext_l   = 'Presentation description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPRCPT'.
  i_fieldcatalog-seltext_l   = 'Price Point'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZNPRCPTXT'.
  i_fieldcatalog-seltext_l   = 'Price Point description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.
  i_fieldcatalog-fieldname   = 'ZZNPRDGR'.
  i_fieldcatalog-seltext_l   = 'Product Group'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNPRDGRTXT'.
  i_fieldcatalog-seltext_l   = 'Product Group description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSTONE'.
  i_fieldcatalog-seltext_l   = 'Stone'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSTONETXT'.
  i_fieldcatalog-seltext_l   = 'Stone description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSCLAS'.
  i_fieldcatalog-seltext_l   = 'Sub-Class'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSCLASTXT'.
  i_fieldcatalog-seltext_l   = 'Sub-Class description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWAIST'.
  i_fieldcatalog-seltext_l   = 'Waist Rise'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWAISTXT'.
  i_fieldcatalog-seltext_l   = 'Waist Rise description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHY'.
  i_fieldcatalog-seltext_l   = 'Wash'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHYTXT'.
  i_fieldcatalog-seltext_l   = 'Wash description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHS'.
  i_fieldcatalog-seltext_l   = 'Wash Sustainability'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHSTXT'.
  i_fieldcatalog-seltext_l   = 'Wash Sustainability description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHT'.
  i_fieldcatalog-seltext_l   = 'Wash Treatment'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNWASHTXT'. "'ZZNWASHTTXT'.
  i_fieldcatalog-seltext_l   = 'Wash Treatment description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNLGOPN'.
  i_fieldcatalog-seltext_l   = 'Leg Opening'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNLGOPNTXT'.
  i_fieldcatalog-seltext_l   = 'Leg Opening  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSILHT'.
  i_fieldcatalog-seltext_l   = 'Silhouette'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSILHTTXT'.
  i_fieldcatalog-seltext_l   = 'Silhouette  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCHARS'.
  i_fieldcatalog-seltext_l   = 'Characteristic'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNCHARSTXT'.
  i_fieldcatalog-seltext_l   = 'Characteristic  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZCONSTYPEDESC'.
  i_fieldcatalog-seltext_l   = 'Construction Type  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZCONSTYPE'.
  i_fieldcatalog-seltext_l   = 'Construction Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNFABRN'.
*  i_fieldcatalog-seltext_l   = 'Fabric Concept'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '5'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.
*
*  i_fieldcatalog-fieldname   = 'ZZNFABRNTXT'.
*  i_fieldcatalog-seltext_l   = 'Fabric Concept  description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '50'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFAPYR'.
  i_fieldcatalog-seltext_l   = 'Fashion Pyramid'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNFAPYRTXT'.
  i_fieldcatalog-seltext_l   = 'Fashion Pyramid  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZHLHT'.
  i_fieldcatalog-seltext_l   = 'Heel Height'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZHLHTDESC'.
  i_fieldcatalog-seltext_l   = 'Heel Height  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNSTMTH'.
*  i_fieldcatalog-seltext_l   = 'In store month'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '5'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNSTMTHTXT'.
*  i_fieldcatalog-seltext_l   = 'In-Store Month  description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '50'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNITPLT'.
  i_fieldcatalog-seltext_l   = 'Item Plate'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNITPLTTXT'.
  i_fieldcatalog-seltext_l   = 'Item Plate  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNNCTYP'.
  i_fieldcatalog-seltext_l   = 'Neckline/Collar Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNNCTYPTXT'.
  i_fieldcatalog-seltext_l   = 'Neckline/Collar Type  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZNSETCT'.
  i_fieldcatalog-seltext_l   = 'Piece Count'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSETCTTXT'.
  i_fieldcatalog-seltext_l   = 'Piece Count  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


*  i_fieldcatalog-fieldname   = 'ZZNRPMNT'.
*  i_fieldcatalog-seltext_l   = 'Replenishment'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '5'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.
*
*  i_fieldcatalog-fieldname   = 'ZZNRPMNTTXT'.
*  i_fieldcatalog-seltext_l   = 'Replenishment  description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '50'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZSHAFTHTDESC'.
  i_fieldcatalog-seltext_l   = 'Shaft Height  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZSHAFTHT'.
  i_fieldcatalog-seltext_l   = 'Shaft Height'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZNSLVTP'.
  i_fieldcatalog-seltext_l   = 'Sleeve Type'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSLVTPTXT'.
  i_fieldcatalog-seltext_l   = 'Sleeve Type  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZSTDETDESC'.
  i_fieldcatalog-seltext_l   = 'Style Detail  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZSTDET'.
  i_fieldcatalog-seltext_l   = 'Style Detail'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSTFSH'.
  i_fieldcatalog-seltext_l   = 'Style/Finish'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'ZZNSTFSHTXT'.
  i_fieldcatalog-seltext_l   = 'Style/Finish  description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ZZINVSTAT'.
  i_fieldcatalog-seltext_l   = 'Inventory Status'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '5'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname  = 'ZZINVDESC'.
  i_fieldcatalog-seltext_l   = 'Inventory Status description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '50'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

*  i_fieldcatalog-fieldname   = 'ZZNTHEME'.
*  i_fieldcatalog-seltext_l   = 'Theme'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '5'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.
*
*  i_fieldcatalog-fieldname  = 'ZZNTHEMETXT'.
*  i_fieldcatalog-seltext_l  = 'Theme description'.
*  i_fieldcatalog-col_pos     = colno.
*  i_fieldcatalog-outputlen   = '5'.
*  APPEND i_fieldcatalog TO i_fieldcatalog.
*  CLEAR  i_fieldcatalog.
*  ADD 1 TO colno.


* Begin of Addition For CH-2221 315873 GOH Flag
  IF p_mat = 'X' OR p_size ='X'.
    i_fieldcatalog-fieldname   = 'GOH_text'.   " Flag text YES or NO
    i_fieldcatalog-seltext_l   = 'GOH Flag'.
    i_fieldcatalog-col_pos     = colno.
    i_fieldcatalog-outputlen   = '10'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    ADD 1 TO colno.
  ENDIF.
* End of Addition For CH-2221 315873 GOH Flag

* Begin of changes - ECDK915177 - Pio Fernando
  IF gv_msrp_control = abap_true AND p_msrp = abap_true.
    PERFORM build_fieldcatalog_msrp CHANGING colno.
  ENDIF.
* End of changes - ECDK915177 - Pio Fernando
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
  IF p_polac = 'X'.
    PERFORM build_alvfield USING 'FOB_STD'        text-160 15 '' '' '' .         "FOB XB00 (Std.)
    PERFORM build_alvfield USING 'FREIGHT_PO'     text-161 15 '' '' '' .         "Freight XR01( PO)
    PERFORM build_alvfield USING 'FREIGHT_STD'    text-162 15 '' '' '' .         "Freight XR01( Std.)
    PERFORM build_alvfield USING 'MARKUP_PO'      text-163 15 '' '' '' .         "Mark-Up,XCOM(PO)
    PERFORM build_alvfield USING 'MARKUP_STD'     text-164 15 '' '' '' .         "Mark-Up,XCOM(Std.)
    PERFORM build_alvfield USING 'MARKUP_PO_PER'  text-165 15 '' '' '' .         "Mark-Up,XCOM(PO)%
    PERFORM build_alvfield USING 'MARKUP_STD_PER' text-166 15 '' '' '' .         "Mark-Up,XCOM(Std.)%
    PERFORM build_alvfield USING 'DUTY_PO'        text-167 15 '' '' '' .         "Duty, XDTY (PO)
    PERFORM build_alvfield USING 'DUTY_STD'       text-168 15 '' '' '' .         "Duty, XDTY (Std.)
    PERFORM build_alvfield USING 'DUTY_VAR_SVP'   text-169 15 '' '' '' .         "Duty Var. (Std vs PO)
    PERFORM build_alvfield USING 'MISC_PO'        text-170 15 '' '' '' .         "Miscellaneous, XMSC (PO)
    PERFORM build_alvfield USING 'MISC_STD'       text-171 15 '' '' '' .         "Miscellaneous, XMSC (Std.)
    PERFORM build_alvfield USING 'OTHERS_PO'      text-172 15 '' '' '' .         "Others, XOTH (PO)
    PERFORM build_alvfield USING 'OTHERS_STD'     text-173 15 '' '' '' .         "Others, XOTH (Std.)
    PERFORM build_alvfield USING 'DRAYAGE_PO'     text-174 15 '' '' '' .         "Drayage, XDRY (PO)
    PERFORM build_alvfield USING 'DRAYAGE_STD'    text-175 15 '' '' '' .         "Drayage, XDRY (Std.)
    PERFORM build_alvfield USING 'TOT_PO_PRC'     text-176 15 '' '' '' .         "Total PO Price per UOM
    PERFORM build_alvfield USING 'TOT_STDPRC'     text-046 15 '' '' '' .         "Total Standard Price - Supress FOB Price(NETPR)from Purchase order status
    PERFORM build_alvfield USING 'FOB_PO'         text-177 15 '' '' '' .         "FOB XB00 (PO) - Suppress Standard Cost(STPRS) from Purchase order status
  ENDIF.
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.

ENDFORM.                    " build_field_catalog_rev
*&---------------------------------------------------------------------*
*&      Form  display_alv_report_rev
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM display_alv_report_rev .
  DATA : lv_save(1) VALUE 'A'.
  v_repid = sy-repid.
**Avoid column truncating in report printing
*  wa_grid_set-no_colwopt = 'X'.
  AUTHORITY-CHECK OBJECT 'S_ALV_LAYO'
             ID 'ACTVT' FIELD '23'.

  IF sy-subrc NE 0.
    lv_save = 'U'.
  ENDIF.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      i_callback_program      = v_repid
      is_layout               = wa_layout
      it_fieldcat             = i_fieldcatalog[]
      i_callback_user_command = 'USER_COMMAND'
      it_sort                 = i_sortcat
      i_grid_settings         = wa_grid_set
      i_grid_title            = 'Material Size PO Report'(039)
      i_save                  = lv_save
      is_variant              = v_variant
    TABLES
      t_outtab                = i_data_size
    EXCEPTIONS
      program_error           = 1
      OTHERS                  = 2.

  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
ENDFORM.                    " display_alv_report_rev
*&---------------------------------------------------------------------*
*&      Form  display_alv_report_mat
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM display_alv_report_mat .
  DATA : lv_save(1) VALUE 'A'.

  AUTHORITY-CHECK OBJECT 'S_ALV_LAYO'
               ID 'ACTVT' FIELD '23'.

  IF sy-subrc NE 0.
    lv_save = 'U'.
  ENDIF.

  v_repid = sy-repid.
*  wa_grid_set-no_colwopt = 'X'.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      i_callback_program      = v_repid
      is_layout               = wa_layout
      it_fieldcat             = i_fieldcatalog[]
      i_callback_user_command = 'USER_COMMAND'
      it_sort                 = i_sortcat
      i_grid_settings         = wa_grid_set
      i_grid_title            = 'Material PO Report'(038)
      i_save                  = lv_save
      is_variant              = v_variant
    TABLES
      t_outtab                = i_data_mat
    EXCEPTIONS
      program_error           = 1
      OTHERS                  = 2.

  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.                    " display_alv_report_mat
*&---------------------------------------------------------------------*
*&      Form  f_initialize_variant
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM f_initialize_variant .

* REPLACE:PJDK925380:29/05/2012:MW - {
*  CLEAR v_variant.
*  v_save           = 'A'.
*  v_repname        = sy-repid.
*  v_variant-report = v_repname.
**option specific variants
*  IF p_mat = 'X'.
*    v_variant-handle = '1'.
*  ELSEIF p_size = 'X'.
*    v_variant-handle = '2'.
**  ELSEIF p_so_hed = 'X'.
**    v_variant-handle = '3'.
*  ENDIF.

  CLEAR v_variant.
  CLEAR v_var.              ""Insert CH-2451-ECDK926220-27-Apr-2023
  MOVE sy-slset TO v_var.     "Insert CH-2451-ECDK926220-27-Apr-2023
  v_save           = 'A'.

  IF p_postat = 'X' OR p_polac = 'X'. "CH-3245-ECDK927942-315873-Added Po landed cost logic.
    IF p_mat = 'X'.
      v_variant-handle = '1'.
    ELSEIF p_size = 'X'.
      v_variant-handle = '2'.
    ENDIF.
    v_repname = sy-repid.

  ELSEIF p_pocpan = 'X'.
    IF p_povsc = 'X'.
      v_variant-handle = '1'.
    ELSEIF p_povin = 'X'.
      v_variant-handle = '2'.
    ELSEIF p_compan = 'X'.
      v_variant-handle = '3'.
    ENDIF.
    v_repname = 'ZMM_COST_VARIANCE'.

*Add AP, 02/08/2022, ED1K900279
  ELSEIF p_pocha = 'X'.
    v_variant-handle = '1'.
    v_repname = sy-repid.
*End Add

  ENDIF.

  v_variant-report = v_repname.
* REPLACE:PJDK925380:29/05/2012:MW - }

  v_x_variant      = v_variant.

*  CALL FUNCTION 'REUSE_ALV_VARIANT_DEFAULT_GET'
*    EXPORTING
*      i_save     = v_save
*    CHANGING
*      cs_variant = v_x_variant
*    EXCEPTIONS
*      not_found  = 2.

  IF sy-subrc = 0.
*    p_vari = v_x_variant-variant.
  ELSE.
*    CLEAR p_vari.
  ENDIF.

ENDFORM.                    " f_initialize_variant
*&---------------------------------------------------------------------*
*&      Form  f_f4_for_variant
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM f_f4_for_variant .

  CALL FUNCTION 'REUSE_ALV_VARIANT_F4'
    EXPORTING
      is_variant = v_variant
      i_save     = v_save
    IMPORTING
      e_exit     = v_exit
      es_variant = v_x_variant
    EXCEPTIONS
      not_found  = 2.

  IF sy-subrc = 2.
    MESSAGE ID sy-msgid TYPE 'S' NUMBER sy-msgno
            WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ELSE.
    IF v_exit = space.
      p_vari = v_x_variant-variant.
    ENDIF.
  ENDIF.

ENDFORM.                    " f_f4_for_variant
*&---------------------------------------------------------------------*
*&      Form  f_at_selection_screen
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM f_at_selection_screen .

* alv layout variant
  IF NOT p_vari IS INITIAL.

    MOVE v_variant TO v_x_variant.
    MOVE p_vari    TO v_x_variant-variant.

    CALL FUNCTION 'REUSE_ALV_VARIANT_EXISTENCE'
      EXPORTING
        i_save     = v_save
      CHANGING
        cs_variant = v_x_variant.
    v_variant = v_x_variant.

  ELSE.
    PERFORM f_initialize_variant.
  ENDIF.

ENDFORM.                    " f_at_selection_screen
*&---------------------------------------------------------------------*
*&      Form  build_sortcat_rev
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM build_sortcat_rev .
  DATA colno1 TYPE i.
  CLEAR colno1.
  ADD 1 TO colno1.

  wa_sort-spos      = colno1.
  wa_sort-fieldname = 'WERKS'.
  wa_sort-up        = 'X'.
  wa_sort-subtot    = 'X'.
  APPEND wa_sort TO i_sortcat.
  ADD 1 TO colno1.

ENDFORM.                    " build_sortcat_rev
*&---------------------------------------------------------------------*
*&      Form  user_command
*&---------------------------------------------------------------------*
*       Customised user commands
*----------------------------------------------------------------------*
*
FORM user_command USING r_ucomm     LIKE sy-ucomm
                        rs_selfield TYPE slis_selfield.

  IF r_ucomm EQ '&ZREF'.
*    PERFORM get_data.
*    PERFORM calculate.
*    IF p_so_itm = 'X' OR p_so_hed ='X'.
*      PERFORM summarize.
*    ENDIF.
*    PERFORM del_unwntd_data.
*To refresh ALV
**    rs_selfield-refresh    = 'X'.
*    rs_selfield-col_stable = 'X'.
*    rs_selfield-row_stable = 'X'.
  ELSEIF r_ucomm EQ '&IC1'.
    IF rs_selfield-fieldname = 'EBELN'.
      SET PARAMETER ID 'BES' FIELD rs_selfield-value.
      CALL TRANSACTION 'ME23N' AND SKIP FIRST SCREEN.
      rs_selfield-row_stable = 'X'.
      rs_selfield-col_stable = 'X'.
      rs_selfield-refresh = 'X'.
    ENDIF.
  ENDIF.

ENDFORM.                    "user_command
*&---------------------------------------------------------------------*
*&      Form  authorization_check
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM authorization_check .
  DATA: li_t001w    TYPE TABLE OF t001w,
        lv_actvt(2) VALUE '03',  " Display
        lv_text1    TYPE string,
        li_tspa     TYPE TABLE OF tspa,
        lwa_tspa    TYPE tspa,
        lv_text2    TYPE string.

  FIELD-SYMBOLS <f_t001w> TYPE t001w.

*Check Plant
  IF NOT s_werks IS INITIAL.
    SELECT werks INTO CORRESPONDING FIELDS OF TABLE li_t001w
      FROM t001w
    WHERE werks IN s_werks.

    LOOP AT li_t001w ASSIGNING <f_t001w>.
      AUTHORITY-CHECK OBJECT 'ZMM_WERKS' "'M_BEST_WRK'
               ID 'ACTVT' FIELD lv_actvt
               ID 'WERKS' FIELD <f_t001w>-werks.

      IF sy-subrc <> 0.
        MESSAGE e022(zmsg) WITH 'No read authorization to plant' <f_t001w>-werks.
        EXIT.
      ENDIF.
    ENDLOOP.
  ENDIF.
**Check Division
*  SELECT spart INTO CORRESPONDING FIELDS OF TABLE li_tspa
*  FROM tspa
*  WHERE spart IN s_spart.
*
*  LOOP AT li_tspa INTO lwa_tspa.
*    AUTHORITY-CHECK OBJECT 'ZSPART'
*           ID 'SPART' FIELD lwa_tspa-spart
*           ID 'ACTVT' FIELD lv_actvt.
*
*    IF sy-subrc <> 0.
*      CONCATENATE text-102 lwa_tspa-spart INTO lv_text1 SEPARATED BY space.
*
*      MESSAGE e077(rp) WITH lv_text1.
*      EXIT.
*    ENDIF.
*  ENDLOOP.
ENDFORM.                    " authorization_check
*&---------------------------------------------------------------------*
*&      Form  sales_price
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sales_price .
  FIELD-SYMBOLS : <f_sales> TYPE ty_sales.
  DATA: lv_datum TYPE sy-datum.

*attSam added a comment - Sales Order is maintained in the PO only for PTO scenario, otherwise no SO in PO
  IF it_zzvgbel[] IS NOT INITIAL.  "
    SELECT a~vbeln a~knumv
           b~posnr b~matnr
           b~abgru  "chandimaw - 23/11/2011 - sales price issue when SO lines rejected
           a~vdatu b~j_3acada " CH-3155-315873-ECDK927707-New fields in purchase order status radio button
           c~etenr c~j_3asize
       INTO CORRESPONDING FIELDS OF TABLE i_sales
       FROM vbak AS a
                 INNER JOIN vbap AS b
                    ON a~vbeln = b~vbeln
                 INNER JOIN vbep AS c
                    ON b~vbeln = c~vbeln
                   AND b~posnr = c~posnr
       FOR ALL ENTRIES IN it_zzvgbel
    WHERE a~vbeln = it_zzvgbel-zzvgbel.

*    DELETE i_sales WHERE abgru IS NOT INITIAL.  "chandimaw - 23/11/2011 - sales price issue when SO lines rejected <-- PJDK926032:04/07/2012:MalindaW
    i_sales_knumv[] = i_sales[].
    SORT i_sales_knumv BY knumv.
    DELETE ADJACENT DUPLICATES FROM i_sales_knumv COMPARING knumv.
    REFRESH r_kschl.
    r_kschl-low = 'XP00'.
    r_kschl-option = 'EQ'.
    r_kschl-sign   = 'I'.
    APPEND r_kschl.
    r_kschl-low = 'XP10'.
    APPEND r_kschl.
    r_kschl-low = 'XP20'.
    APPEND r_kschl.

    IF i_sales_knumv[] IS NOT INITIAL.
*   attSam -- Offshore please delte these unwanted part if its really not need
*   REPLACE:PJDK925986:02/07/2012:MalindaW {{{
*      "Active conditions only
*      SELECT knumv kposn kschl j_3aetenr kbetr kpein
*        INTO CORRESPONDING FIELDS OF TABLE i_sales_konv
*        FROM konv
*         FOR ALL ENTRIES IN i_sales_knumv
*       WHERE knumv = i_sales_knumv-knumv AND
*             kschl IN r_kschl AND
*             kinak = ''.
*
*      IF sy-subrc = 0.
*        LOOP AT i_sales ASSIGNING <f_sales>. "INTO wa_sales.
*          LOOP AT i_sales_konv INTO wa_sales_konv
*                                WHERE knumv = <f_sales>-knumv AND
*                                      kposn = <f_sales>-posnr AND
*                                      j_3aetenr = <f_sales>-etenr.
*            <f_sales>-kschl = wa_sales_konv-kschl.
*            <f_sales>-kbetr = wa_sales_konv-kbetr.
*          ENDLOOP.
*        ENDLOOP.
*      ELSE.
*        "Active and Inactive conditions
*        SELECT knumv kposn kschl j_3aetenr kbetr kpein
*          INTO CORRESPONDING FIELDS OF TABLE i_sales_konv
*          FROM konv
*           FOR ALL ENTRIES IN i_sales_knumv
*         WHERE knumv = i_sales_knumv-knumv AND
*               kschl IN r_kschl.
*        "Check Condition Priority : XP20->XP10->XP00
*        LOOP AT i_sales ASSIGNING <f_sales>. "INTO wa_sales.
*          LOOP AT i_sales_konv INTO wa_sales_konv
*                                WHERE knumv = <f_sales>-knumv AND
*                                      kposn = <f_sales>-posnr AND
*                                      kschl = 'XP10' AND
*                                      j_3aetenr = <f_sales>-etenr.
*            <f_sales>-kschl = wa_sales_konv-kschl.
*            <f_sales>-kbetr = wa_sales_konv-kbetr.
*          ENDLOOP.
*          IF sy-subrc NE 0.
*            LOOP AT i_sales_konv INTO wa_sales_konv
*                                  WHERE knumv = <f_sales>-knumv AND
*                                        kposn = <f_sales>-posnr AND
*                                        kschl = 'XP20' AND
*                                        j_3aetenr = <f_sales>-etenr.
*              <f_sales>-kschl = wa_sales_konv-kschl.
*              <f_sales>-kbetr = wa_sales_konv-kbetr.
*            ENDLOOP.
*            IF sy-subrc NE 0.
*              LOOP AT i_sales_konv INTO wa_sales_konv
*                                    WHERE knumv = <f_sales>-knumv AND
*                                          kposn = <f_sales>-posnr AND
*                                          kschl = 'XP00' AND
*                                          j_3aetenr = <f_sales>-etenr.
*                <f_sales>-kschl = wa_sales_konv-kschl.
*                <f_sales>-kbetr = wa_sales_konv-kbetr.
*              ENDLOOP.
*            ENDIF.
*          ENDIF.
*        ENDLOOP.
*      ENDIF.
*      SORT i_sales BY knumv posnr etenr kschl DESCENDING.

*-------------------------------------------------------------------------------------------------------------------------------
*-------------------------------------------------------------------------------------------------------------------------------
*      "Fetch active and inactive conditions
*      SELECT knumv kposn kschl j_3aetenr kbetr kpein kinak
*        INTO CORRESPONDING FIELDS OF TABLE i_sales_konv
*        FROM konv
*         FOR ALL ENTRIES IN i_sales_knumv
*       WHERE knumv = i_sales_knumv-knumv AND
*             kschl IN r_kschl.
*
*      IF sy-subrc = 0.
*        LOOP AT i_sales_konv INTO wa_sales_konv WHERE kinak = ''. "Active conditions
*          LOOP AT i_sales ASSIGNING <f_sales> WHERE knumv = wa_sales_konv-knumv AND
*                                                    posnr = wa_sales_konv-kposn AND
*                                                    etenr = wa_sales_konv-j_3aetenr.
*            <f_sales>-kschl = wa_sales_konv-kschl.
*            <f_sales>-kbetr = wa_sales_konv-kbetr.
*          ENDLOOP.
*        ENDLOOP.
**        IF sy-subrc NE 0. "No active contitions "<-- PJDK926034:04/07/2012
*        "Inactive conditions
**          LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP10' AND kinak = 'X'. "Priority 1 "<-- PJDK926020:04/07/2012
*        LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP10' AND kinak NE ''. "Priority 1 "<-- PJDK926020:04/07/2012
*          LOOP AT i_sales ASSIGNING <f_sales> WHERE knumv = wa_sales_konv-knumv AND
*                                                    posnr = wa_sales_konv-kposn AND
*                                                    etenr = wa_sales_konv-j_3aetenr AND
*                                                    kschl = ''. "<-- PJDK926034:04/07/2012
*            <f_sales>-kschl = wa_sales_konv-kschl.
*            <f_sales>-kbetr = wa_sales_konv-kbetr.
*          ENDLOOP.
*        ENDLOOP.
*        IF sy-subrc NE 0.
**            LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP20' AND kinak = 'X'. "Priority 2 "<-- PJDK926020:04/07/2012
*          LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP20' AND kinak NE ''. "Priority 2 "<-- PJDK926020:04/07/2012
*            LOOP AT i_sales ASSIGNING <f_sales> WHERE knumv = wa_sales_konv-knumv AND
*                                                      posnr = wa_sales_konv-kposn AND
*                                                      etenr = wa_sales_konv-j_3aetenr AND
*                                                      kschl = ''. "<-- PJDK926034:04/07/2012.
*              <f_sales>-kschl = wa_sales_konv-kschl.
*              <f_sales>-kbetr = wa_sales_konv-kbetr.
*            ENDLOOP.
*          ENDLOOP.
*          IF sy-subrc NE 0.
**              LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP00' AND kinak = 'X'. "Priority 3 "<-- PJDK926020:04/07/2012
*            LOOP AT i_sales_konv INTO wa_sales_konv WHERE kschl = 'XP00' AND kinak NE ''. "Priority 3 "<-- PJDK926020:04/07/2012
*              LOOP AT i_sales ASSIGNING <f_sales> WHERE knumv = wa_sales_konv-knumv AND
*                                                        posnr = wa_sales_konv-kposn AND
*                                                        etenr = wa_sales_konv-j_3aetenr AND
*                                                        kschl = ''. "<-- PJDK926034:04/07/2012.
*                <f_sales>-kschl = wa_sales_konv-kschl.
*                <f_sales>-kbetr = wa_sales_konv-kbetr.
*              ENDLOOP.
*            ENDLOOP.
*          ENDIF.
*        ENDIF.
**        ENDIF. "<-- PJDK926034:04/07/2012
*      ENDIF.

      SELECT knumv kposn kschl j_3aetenr kbetr kpein kinak waers
        INTO CORRESPONDING FIELDS OF TABLE i_sales_konv
        FROM konv
         FOR ALL ENTRIES IN i_sales_knumv
       WHERE knumv = i_sales_knumv-knumv AND
      kschl IN r_kschl.

      IF sy-subrc = 0.
        LOOP AT i_sales_knumv INTO wa_sales. "Process for each condition record

          LOOP AT i_sales ASSIGNING <f_sales> WHERE knumv = wa_sales-knumv.
            "Read active condition
            CLEAR wa_sales_konv.
            READ TABLE i_sales_konv INTO wa_sales_konv
            WITH KEY knumv     = <f_sales>-knumv
                     kposn     = <f_sales>-posnr
                     j_3aetenr = <f_sales>-etenr
                     kinak     = ''.

            IF sy-subrc = 0.
              "Active condition record found
              <f_sales>-kschl = wa_sales_konv-kschl.
              <f_sales>-kbetr = wa_sales_konv-kbetr.
              <f_sales>-waers = wa_sales_konv-waers.
            ELSE.
              "No active condition record
              "Inactive condition priority 1 - XP10
              LOOP AT i_sales_konv INTO wa_sales_konv WHERE knumv     = <f_sales>-knumv AND
                                                            kposn     = <f_sales>-posnr AND
                                                            kschl     = 'XP10' AND
                                                            j_3aetenr = <f_sales>-etenr AND
                                                            kinak     NE ''.
                <f_sales>-kschl = wa_sales_konv-kschl.
                <f_sales>-kbetr = wa_sales_konv-kbetr.
                <f_sales>-waers = wa_sales_konv-waers.
              ENDLOOP.
              "Inactive condition priority 2 - XP20
              IF sy-subrc NE 0.
                LOOP AT i_sales_konv INTO wa_sales_konv WHERE knumv     = <f_sales>-knumv AND
                                                              kposn     = <f_sales>-posnr AND
                                                              kschl     = 'XP20' AND
                                                              j_3aetenr = <f_sales>-etenr AND
                                                              kinak     NE ''.
                  <f_sales>-kschl = wa_sales_konv-kschl.
                  <f_sales>-kbetr = wa_sales_konv-kbetr.
                  <f_sales>-waers = wa_sales_konv-waers.
                ENDLOOP.
                "Inactive condition priority 3 - XP00
                IF sy-subrc NE 0.
                  LOOP AT i_sales_konv INTO wa_sales_konv WHERE knumv     = <f_sales>-knumv AND
                                                                kposn     = <f_sales>-posnr AND
                                                                kschl     = 'XP00' AND
                                                                j_3aetenr = <f_sales>-etenr AND
                                                                kinak     NE ''.
                    <f_sales>-kschl = wa_sales_konv-kschl.
                    <f_sales>-kbetr = wa_sales_konv-kbetr.
                    <f_sales>-waers = wa_sales_konv-waers.
                  ENDLOOP.
                ENDIF.
              ENDIF.
            ENDIF.
          ENDLOOP.
        ENDLOOP.
      ENDIF.
*-------------------------------------------------------------------------------------------------------------------------------
*-------------------------------------------------------------------------------------------------------------------------------
**   REPLACE:PJDK925986:02/07/2012:MalindaW }}}
    ENDIF.
    CLEAR:  i_sales_knumv[], i_sales_konv[], wa_sales.
* REPLACE:PJDK925980:MalindaW }}}
  ENDIF.

*attSam - Here Sales Price captured for NON PTO scenarios, that is there is no sales order
*         maintained in the PO
*code commented by SRIRAM 9999013477
*  IF i_data_null_so IS NOT INITIAL.
**--------------------------------------------------------------------*
** Take the Material to MVKE table (just MATNR as input).
** Here, you will get only one entry (because in LF, one material
** is never maintained in more than one sales org) for the Sales org.
** Take this Sales org to A905 with the material to get the condition
** record number
**--------------------------------------------------------------------*
*    SELECT matnr vkorg
*      INTO CORRESPONDING FIELDS OF TABLE li_mvke
*      FROM mvke
*      FOR ALL ENTRIES IN i_data_null_so
*      WHERE matnr = i_data_null_so-matnr.
*
*    FREE : i_data_null_so.
*    CHECK li_mvke IS NOT INITIAL.
*
*
*    SELECT vkorg matnr knumh
*      INTO CORRESPONDING FIELDS OF TABLE i_a905
*      FROM a905
*      FOR ALL ENTRIES IN li_mvke "i_mvke_sales
*      WHERE kappl = 'V'
*        AND kschl = 'XP00'
*        AND vkorg = li_mvke-vkorg  "Assumption: Sales org which will be same as Plant WERKS
*        AND matnr = li_mvke-matnr
*        AND kfrst = ''
*        AND datbi GE sy-datum.
*
*    SORT i_a905 BY vkorg matnr knumh.     "sri
*
**    SELECT knumh kopos kschl kbetr
*    IF i_a905[] IS NOT INITIAL.  "inseted line--DS21122010
*      SELECT knumh kbetr konwa
*       INTO CORRESPONDING FIELDS OF TABLE i_sales_4_a905
*       FROM konp
*       FOR ALL ENTRIES IN i_a905
*       WHERE knumh = i_a905-knumh AND
*             kschl = 'XP00'.
*    ENDIF.                             "inseted line--DS21122010
* End of Commented by Sriram. 9999013477

*Start of changes done by SRIRAM 8/1/2015 9999013477
  SORT lt_ekpo BY matnr werks.
  DELETE ADJACENT DUPLICATES FROM lt_ekpo COMPARING matnr werks.
  IF NOT lt_ekpo[] IS INITIAL.
    SELECT  vkorg matnr knumh
          INTO TABLE i_a905
          FROM a905
          FOR ALL ENTRIES IN lt_ekpo "i_mvke_sales
          WHERE kappl = 'V'
            AND kschl = 'XP00'
            AND vkorg = lt_ekpo-werks  "Assumption: Sales org which will be same as Plant WERKS
            AND matnr = lt_ekpo-matnr
            AND kfrst = ''
    AND datbi GE sy-datum.


    IF i_a905[] IS NOT INITIAL.
      SORT i_a905 BY matnr.

      SELECT knumh kbetr konwa
       INTO TABLE i_sales_4_a905
       FROM konp
       FOR ALL ENTRIES IN i_a905
       WHERE knumh = i_a905-knumh AND
      kschl = 'XP00'.
    ENDIF.
*endif.
*        Code commented by SriRam - 9999013477 4-02-2015
**  if entry not found in A905 table for EKPO Material then fetch based on TVKWZ
*    IF i_sales_4_a905[] IS INITIAL.
*      SORT lt_ekpo BY werks.
*      DELETE ADJACENT DUPLICATES FROM lt_ekpo COMPARING werks.
*      IF NOT lt_ekpo IS INITIAL.
*        SELECT * FROM tvkwz
*            INTO TABLE lt_tvkwz
*            FOR ALL ENTRIES IN lt_ekpo
*            WHERE werks = lt_ekpo-werks.
*      ENDIF.
*
*      IF lt_tvkwz[] IS NOT INITIAL.
*        SELECT vkorg matnr knumh
*              INTO TABLE i_a905
*              FROM a905
*              FOR ALL ENTRIES IN lt_tvkwz
*              WHERE vkorg = lt_tvkwz-vkorg.
*
*        IF i_a905[] IS NOT INITIAL.
*          SELECT knumh kbetr konwa
*                 INTO TABLE i_sales_4_a905
*                 FROM konp
*                 FOR ALL ENTRIES IN i_a905
*                 WHERE knumh = i_a905-knumh AND
*                       kschl = 'XP00'.
*        ENDIF.
*      ENDIF.
*    ENDIF.
* End of Changes done by SRIRAM 8/1/2015 9999013477
*        end of Code commented by SriRam - 9999013477 4-02-2015
  ENDIF.
ENDFORM.                    " sales_price
*&---------------------------------------------------------------------*
*&      Form  collect_data
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM collect_data .
  IF s_ekgrp[] IS INITIAL.
    s_ekgrp-sign   = 'I'.
    s_ekgrp-option = 'EQ'.
  ENDIF.

* get plant/val.key/comp. code data for Group Currency
  SELECT a~werks
    INTO TABLE @DATA(li_plant)
    FROM t001w AS a
      INNER JOIN t001k AS b
        ON b~bwkey = a~bwkey
      INNER JOIN t001a AS c
        ON c~bukrs = b~bukrs AND
           c~curtp = '30'
  ORDER BY a~werks.

  SELECT a~mandt, a~mwaer
    INTO TABLE @DATA(li_clnt)
    FROM t000 AS a
    WHERE a~mandt = @sy-mandt
  ORDER BY a~mandt.

* BOC by DGHOSAL on 5/21/2018
  IF i_data[] IS NOT INITIAL.
    SELECT matnr, vkorg, dwerk
      FROM mvke
      INTO TABLE @DATA(li_mvke)
      FOR ALL ENTRIES IN @i_data[]
      WHERE matnr = @i_data-matnr
    AND dwerk = @i_data-werks.
    IF sy-subrc IS INITIAL.
      SORT li_mvke BY matnr dwerk.
    ENDIF.
  ENDIF.
* EOC by DGHOSAL on 5/21/2018

  DATA: lv_plant LIKE LINE OF li_plant,
        lv_clnt  LIKE LINE OF li_clnt.

*  read table li_plant into lv_plant index 1.
  READ TABLE li_clnt INTO lv_clnt INDEX 1.


  LOOP AT i_data ASSIGNING <f_data>.

* BOC by DGHOSAL on 5/21/2018
    READ TABLE li_mvke INTO DATA(ls_mvke) WITH KEY
                       matnr = <f_data>-matnr
                       dwerk = <f_data>-werks
                       BINARY SEARCH.
    IF sy-subrc IS INITIAL.
      <f_data>-vkorg = ls_mvke-vkorg.
    ENDIF.
* EOC by DGHOSAL on 5/21/2018

    wa_mara-matnr = <f_data>-matnr.
    wa_mara-werks = <f_data>-werks.
    wa_mara-normt = <f_data>-normt.
* BOC by DGHOSAL on 5/21/2018
    wa_mara-vkorg = <f_data>-vkorg.
* EOC by DGHOSAL on 5/21/2018
    COLLECT wa_mara INTO i_mara.

    READ TABLE li_plant INTO lv_plant WITH KEY werks = <f_data>-werks.      "TD
    IF sy-subrc = 0.
      <f_data>-mwaer = lv_clnt-mwaer.
    ENDIF.

    IF s_ekgrp IS  INITIAL.
      s_ekgrp-low   = <f_data>-ekgrp.
      COLLECT s_ekgrp.
    ENDIF.

    wa_ebeln = <f_data>-ebeln.
    COLLECT wa_ebeln INTO it_ebeln.

    wa_lifnr-lifnr = <f_data>-lifnr.
    COLLECT wa_lifnr INTO i_lifnr.

    wa_zzkunnr-zzkunnr = <f_data>-zzkunnr.
    COLLECT wa_zzkunnr INTO it_zzkunnr.

* BOC by DGHOSAL on 5/21/2018
    wa_zzkunnr-zzkunnr = <f_data>-ekunnr.
    COLLECT wa_zzkunnr INTO it_zzkunnr.
* EOC by DGHOSAL on 5/21/2018

    wa_zzvgbel-zzvgbel = <f_data>-zzvgbel.
    COLLECT wa_zzvgbel INTO it_zzvgbel.

    wa_knumv-knumv = <f_data>-knumv.
    wa_knumv-kposn = <f_data>-ebelp.
    wa_knumv-etenr = <f_data>-etenr.
    COLLECT wa_knumv INTO it_knumv.

    IF <f_data>-zzolla IS NOT INITIAL.
      wa_zzolla-zzolla = <f_data>-zzolla.
    ELSEIF <f_data>-zzolla2 IS NOT INITIAL.
      wa_zzolla-zzolla = <f_data>-zzolla2.
      <f_data>-zzolla  = <f_data>-zzolla2.
    ENDIF.

    COLLECT wa_zzolla INTO it_zzolla_copy.

    "$ Region - attSam added on 31.10.2011
    wa_zhanger-zzhanger = <f_data>-zzhanger.
    COLLECT wa_zhanger INTO i_zhanger.
    "$ Endregion - attSam added on 31.10.2011

* Start of Aaddition 9999013477 by SriRam
*  for getting MSRP value
    lw_ekpo-ebeln = <f_data>-ebeln.
    lw_ekpo-ebelp = <f_data>-ebelp.
    lw_ekpo-matnr = <f_data>-matnr.
    lw_ekpo-werks = <f_data>-werks.
    lw_ekpo-afnam = <f_data>-afnam.         "Added By SriRam
    APPEND lw_ekpo TO lt_ekpo.
    CLEAR lw_ekpo.
* End of Addition 9999013477 by Sri Ram
*
    IF <f_data>-zkunnr IS NOT INITIAL.
      wa_zkunnr-zkunnr = <f_data>-zkunnr.
      COLLECT wa_zkunnr INTO it_zkunnr.
    ENDIF .
*
  ENDLOOP.
ENDFORM.                    " collect_data
*&---------------------------------------------------------------------*
*&      Form  make_sales_org
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM make_sales_org .
  DATA : i_tvko  TYPE STANDARD TABLE OF tvkwz,
         wa_tvko TYPE tvkwz.

  SELECT vkorg vtweg werks INTO CORRESPONDING FIELDS OF TABLE i_tvko  "Added werks for CH-3449-ECDK928571-315873-26.July.2024-Calculation of number cartons
    FROM tvkwz
  WHERE werks IN s_werks.

  LOOP AT i_tvko INTO wa_tvko.
    s_vkorg-low  = wa_tvko-vkorg.
    s_vkorg-sign = 'I'.
    s_vkorg-option = 'EQ'.
    APPEND s_vkorg.
  ENDLOOP.
  gt_tvko[] = i_tvko[]. "CH-3449-ECDK928571-315873-26.July.2024-Calculation of number cartons
ENDFORM.                    " make_sales_org
*&---------------------------------------------------------------------*
*&      Form  f_call_cost_variance_rep
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM f_call_cost_variance_rep .
  CLEAR gi_rsparams[].
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic..
  IF p_polac EQ abap_true.
* Copy the screen field of PO status to PO cost/price analysis to fetch additional fields for PO landed cost.
    s_werks1[] = s_werks[].
    s_ebeln1[] = s_ebeln[].
    s_aedat1[] = s_aedat[].
    s_ekgrp1[] = s_ekgrp[].
    s_eindt1[] = s_eindt[].
    s_matnr1[] = s_matnr[].
    s_gsupp1[] = s_gsupp[].
    s_inco11[] = s_inco1[].
    s_evers1[] = s_evers[].
    s_land11[] = s_land1[].
    s_mvgr11[] = s_mvgr12[].
    s_prctr1[] = s_prctr[].
    s_seasn1[] = s_seasn[].
    s_brand1[] = s_brand[].
    s_pstyp1[] = s_pstyp[].
    s_exfcm1[] = s_exfcm[].
    s_reswk1[] = s_reswk[].
    s_exemp[]  = s_exempt[].
* Clear the layout field as its specific to PO status screen.
    CLEAR: p_vari, p_povin, p_compan.
* Always fetch PO standard cost logic if p_polac radio button is selected.
    p_povsc = abap_true.
* Export radio button value to differentiate p_polac value from p_pocpa
    DATA(lv_polac) = p_polac.
    EXPORT lv_polac TO MEMORY ID 'POLAC'. " sent to report zmm_cost_variance
  ENDIF.
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
  CALL FUNCTION 'RS_REFRESH_FROM_SELECTOPTIONS'
    EXPORTING
      curr_report     = sy-repid
    TABLES
      selection_table = gi_rsparams
    EXCEPTIONS
      not_found       = 1
      no_report       = 2
      OTHERS          = 3.

  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ELSE.
    PERFORM f_get_param_for_submit.
    IF sy-batch EQ space.
      SUBMIT zmm_cost_variance WITH SELECTION-TABLE gi_rsparams AND RETURN.
    ELSE.
      SUBMIT zmm_cost_variance TO SAP-SPOOL
                               SPOOL PARAMETERS print_parameters
                               WITHOUT SPOOL DYNPRO
                               WITH SELECTION-TABLE gi_rsparams AND RETURN.
    ENDIF.
  ENDIF.
ENDFORM.                    " f_call_cost_variance_rep
*&---------------------------------------------------------------------*
*&      Form  f_get_param_for_submit
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_0305   text
*----------------------------------------------------------------------*
FORM f_get_param_for_submit.
  FIELD-SYMBOLS: <fs_rsparams> TYPE rsparams.

  DELETE gi_rsparams WHERE selname = 'P_POSTAT'.
  DELETE gi_rsparams WHERE selname = 'P_POLAC'. "CH-3245-ECDK927942-315873-Added Po landed cost logic..
  DELETE gi_rsparams WHERE selname = 'P_POCPAN'.
  DELETE gi_rsparams WHERE selname = 'P_MAT'.
  DELETE gi_rsparams WHERE selname = 'P_SIZE'.
  DELETE gi_rsparams WHERE selname = 'P_DEL'.
  DELETE gi_rsparams WHERE selname = 'P_D_ONLY'.
  DELETE gi_rsparams WHERE selname = 'S_WERKS'.
  DELETE gi_rsparams WHERE selname = 'S_LGORT'.
  DELETE gi_rsparams WHERE selname = 'S_EKGRP'.
  DELETE gi_rsparams WHERE selname = 'S_EINDT'.
  DELETE gi_rsparams WHERE selname = 'S_EBELN'.
  DELETE gi_rsparams WHERE selname = 'S_AEDAT'.
  DELETE gi_rsparams WHERE selname = 'S_ERNAM'.
  DELETE gi_rsparams WHERE selname = 'S_LIFNR'.
  DELETE gi_rsparams WHERE selname = 'S_EVERS'.
  DELETE gi_rsparams WHERE selname = 'S_SHPDT'.
  DELETE gi_rsparams WHERE selname = 'S_MATNR'.
  DELETE gi_rsparams WHERE selname = 'S_WRKST'.
  DELETE gi_rsparams WHERE selname = 'S_BISMT'.
  DELETE gi_rsparams WHERE selname = 'S_LAND1'.
  DELETE gi_rsparams WHERE selname = 'S_IHREZ'.
  DELETE gi_rsparams WHERE selname = 'S_PSTYP'.
  DELETE gi_rsparams WHERE selname = 'S_ZKUNNR'.
  DELETE gi_rsparams WHERE selname = 'S_INCO1'.
  DELETE gi_rsparams WHERE selname = 'S_PRCTR'.
  DELETE gi_rsparams WHERE selname = 'S_MVGR12'.
  DELETE gi_rsparams WHERE selname = 'S_MSTAE'.
  DELETE gi_rsparams WHERE selname = 'S_RESWK'. "FNT Change

* Standardiztion additions
  DELETE gi_rsparams WHERE selname = 'S_BRAND'.
  DELETE gi_rsparams WHERE selname = 'S_COLLN'.
  DELETE gi_rsparams WHERE selname = 'S_BRGRP'.
  DELETE gi_rsparams WHERE selname = 'S_BRGTP'.
  DELETE gi_rsparams WHERE selname = 'S_GENDR'.
  DELETE gi_rsparams WHERE selname = 'S_AGGRP'.
  DELETE gi_rsparams WHERE selname = 'S_GSZGP'.
  DELETE gi_rsparams WHERE selname = 'S_SEASN'.
  DELETE gi_rsparams WHERE selname = 'S_PRDCT'.
  DELETE gi_rsparams WHERE selname = 'S_PRDSC'.
  DELETE gi_rsparams WHERE selname = 'S_FABCT'.
  DELETE gi_rsparams WHERE selname = 'S_PRDHA'.
  DELETE gi_rsparams WHERE selname = 'S_STMTH'.
  DELETE gi_rsparams WHERE selname = 'S_EVENT'.
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
  DELETE gi_rsparams WHERE selname = 'S_EXEMPT'.
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967

  LOOP AT gi_rsparams ASSIGNING <fs_rsparams>.
    CASE <fs_rsparams>-selname.
      WHEN 'P_POVSC' OR 'P_POVIN' OR 'P_COMPAN' OR 'S_NAME1'.
      WHEN OTHERS.
        SHIFT <fs_rsparams>-selname BY 1 PLACES RIGHT.
        CONDENSE <fs_rsparams>-selname.
    ENDCASE.
  ENDLOOP.
ENDFORM.                    " f_get_param_for_submit
*&---------------------------------------------------------------------*
*&      Form  get_ppk_data
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM get_ppk_data .
  DATA : li_data TYPE TABLE OF t_data.

  FIELD-SYMBOLS : <f_zpocomp> TYPE gt_zpocomp.
  CLEAR : gi_zpocomp[], gi_zpocomp.

  li_data[] = i_data[].
  DELETE li_data WHERE mtart NE 'XPPK'.
  IF li_data IS NOT INITIAL.
    SORT li_data BY ebeln ebelp.

    SELECT ebeln ebelp matnr j_3asize menge netpr
      INTO CORRESPONDING FIELDS OF TABLE gi_zpocomp
      FROM zpocomp
      FOR ALL ENTRIES IN li_data
      WHERE ebeln = li_data-ebeln AND
    ebelp = li_data-ebelp.
    IF sy-subrc = 0.
      SORT gi_zpocomp BY ebeln ebelp.
    ENDIF.

    SELECT matnr, vkorg, dwerk
           FROM mvke
           INTO TABLE @DATA(li_mvke1)
           FOR ALL ENTRIES IN @gi_zpocomp[]
           WHERE matnr = @gi_zpocomp-matnr
    AND dwerk IN @s_werks.
    IF sy-subrc IS INITIAL.
      SORT li_mvke1 BY matnr dwerk.
    ENDIF.

    SELECT a~matnr a~kunnr a~knumh b~j_3asize b~j_3atltyp a~vkorg b~j_3afield1 b~j_3afield2 INTO TABLE gt_msrp1
      FROM kotk980 AS a
      INNER JOIN j_3avast AS b ON a~knumh = b~knumh
      FOR ALL ENTRIES IN li_mvke1
      WHERE a~kappl  = 'V'            AND
            a~kschl  = 'XVAS'         AND
            a~vkorg  = li_mvke1-vkorg   AND
            a~matnr  = li_mvke1-matnr   AND
    a~datbi GE sy-datum.
    IF sy-subrc IS INITIAL.
      SORT gt_msrp BY matnr vkorg kunnr.
    ENDIF.
  ENDIF.

*  BoC : CH-1778  :Ruchira : 05/06/2022
  DATA(li_zpocomp) = gi_zpocomp.
  SORT li_zpocomp BY matnr j_3asize.
  DELETE ADJACENT DUPLICATES FROM li_zpocomp COMPARING matnr j_3asize.
  IF li_zpocomp IS NOT INITIAL.
    CLEAR gi_compupc.

    SELECT matnr, meinh, lfnum, ean11, eantp, hpean, sgt_catv, j_3akordx
    FROM mean
    INTO CORRESPONDING FIELDS OF TABLE @gi_compupc
    FOR ALL ENTRIES IN @li_zpocomp
    WHERE matnr     = @li_zpocomp-matnr AND
          j_3akordx = @li_zpocomp-j_3asize.

    SORT gi_compupc BY matnr j_3akordx.
  ENDIF.
*  EoC : CH-1778  :Ruchira : 05/06/2022
  FREE li_data.
ENDFORM.                    " get_ppk_data


*&---------------------------------------------------------------------*
*&      Form  get_shp_plan
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM get_shp_plan .
  DATA : li_data TYPE TABLE OF t_data.

  CLEAR : gi_shppln[].

* Read booking cofirmations for all PO lines
  li_data[] = i_data[].
  IF NOT li_data[] IS INITIAL.
    SORT li_data BY ebeln ebelp.
    DELETE ADJACENT DUPLICATES FROM li_data COMPARING ebeln ebelp.

    IF NOT li_data[] IS INITIAL.

      SELECT ebeln ebelp etens ebtyp eindt erdat menge xblnr j_3asize j_3aetenr
      INTO TABLE gi_shppln
      FROM ekes
      FOR ALL ENTRIES IN li_data
      WHERE ebeln = li_data-ebeln AND
      ebelp = li_data-ebelp.

      IF sy-subrc = 0.
* BOC by DGHOSAL on 5/21/2018
*        DELETE gi_shppln WHERE ebtyp NE 'AB'.
        DELETE gi_shppln WHERE ebtyp NE 'AB'
                           AND ebtyp NE 'AA'.
* EOC by DGHOSAL on 5/21/2018
        SORT gi_shppln BY ebeln ebelp.
      ENDIF.

    ENDIF.
  ENDIF.

  FREE li_data.

ENDFORM.                    " get_shp_plan

*&---------------------------------------------------------------------*
*&      Form  f_f4_for_year
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      <--P_S_ZYEAR_LOW  text
*----------------------------------------------------------------------*
FORM f_f4_for_year CHANGING p_year TYPE zyear.
  DATA: h_fields         LIKE help_value OCCURS 0 WITH HEADER LINE,
        h_select_values  LIKE help_vtab  OCCURS 0 WITH HEADER LINE,
        h_t002t_tab      LIKE t002t      OCCURS 0 WITH HEADER LINE,
        h_value_tab(100) OCCURS 0 WITH HEADER LINE,
        h_year           LIKE tfacd-vjahr.


  h_fields-tabname    = 'TFACD'.
  h_fields-fieldname  = 'VJAHR'.
  h_fields-selectflag = 'X'.
  APPEND h_fields.

  h_year = '2000'.
  DO 100 TIMES.
    h_value_tab = h_year.
    APPEND h_value_tab.
    ADD 1 TO h_year.
  ENDDO.

  CALL FUNCTION 'HELP_VALUES_GET_WITH_TABLE_EXT'
    EXPORTING
      fieldname     = 'VJAHR'
      tabname       = 'TFACD'
      no_conversion = ' '
    IMPORTING
      select_value  = p_year
    TABLES
      fields        = h_fields
      select_values = h_select_values
      valuetab      = h_value_tab.
ENDFORM.                    " f_f4_for_year

* Begin of changes - ECDK915177 - Pio Fernando
*&---------------------------------------------------------------------*
*&      Form  BUILD_FIELDCATALOG_MSRP
*&---------------------------------------------------------------------*
FORM build_fieldcatalog_msrp  CHANGING p_colno.
  SORT gt_curr BY waers.
  LOOP AT gt_curr INTO DATA(lwa_curr).
    CONCATENATE 'MSRP_' lwa_curr-seq INTO gv_var.
    i_fieldcatalog-fieldname   = gv_var.
    CONCATENATE 'MSRP(' lwa_curr-waers ')' INTO gv_var.
    i_fieldcatalog-seltext_l   = gv_var.
    i_fieldcatalog-col_pos     = p_colno.
    i_fieldcatalog-outputlen   = 15.
    i_fieldcatalog-no_zero     = 'X'.
    APPEND i_fieldcatalog TO i_fieldcatalog.
    CLEAR  i_fieldcatalog.
    p_colno = p_colno + 1.
  ENDLOOP.
ENDFORM.
* End of changes - ECDK915177 - Pio Fernando


FORM load_format.

  TYPES: BEGIN OF ty_col_h,
           col_heder(50) TYPE c,
         END OF ty_col_h.
  DATA: lt_col_h TYPE STANDARD TABLE OF ty_col_h,
        ls_col_h TYPE ty_col_h.

  DATA: lt_lfieldcat     TYPE  lvc_t_fcat,
        ls_fieldcat      TYPE  lvc_s_fcat,
        lt_lfieldcat_1   TYPE  lvc_t_fcat,
        ls_lfieldcat_1   TYPE  lvc_s_fcat,
        ls_fieldcat_slis TYPE  slis_fieldcat_alv,
        dy_table         TYPE REF TO data,
        dy_line          TYPE REF TO data,
**        p_file           LIKE rlgrap-filename,

        lt_csv_format    TYPE truxs_t_text_data,
        ls_csv_format    LIKE LINE OF lt_csv_format,
        lv_header(6000)  TYPE c,
        lv_field         TYPE c,
        lv_filename      TYPE string,
        lv_week          TYPE kweek,
        lv_date          TYPE scdatum.


*-- Date format settings

  TYPES: BEGIN OF lt_data,
           ebeln          LIKE ekko-ebeln,           "Po No.
           ebelp          LIKE ekpo-ebelp,           "Line number
           matnr          LIKE ekpo-matnr,           "Material
           j_3asize       LIKE eket-j_3asize,        "Material Size
           eindt          TYPE char10, "LIKE eket-eindt,           "Due Date
           etenr          LIKE eket-etenr,           "Delivery Schedule Line Counter
           werks          LIKE ekpo-werks,           "Plant
           ekunnr         LIKE ekpo-kunnr,           "Customer Number
           emlif          LIKE ekpo-emlif,
           lblkz          LIKE ekpo-lblkz,
           knttx          LIKE t163i-knttx,
           ptext          LIKE t163y-ptext,
           zterm          LIKE ekko-zterm,
           ekgrp          LIKE ekko-ekgrp,           "Purch. Group
           eknam          LIKE t024-eknam,           "Purch. Group name
           lifnr          LIKE ekko-lifnr,           "Vendor Code
           ven_nam        LIKE lfa1-name1,           "Vendor Name
           lifn2          LIKE ekpa-lifn2,           "Goods Supplier Code
           sup_nam        LIKE lfa1-name1,           "Goods Supplier Name
           land1          LIKE lfa1-land1,           "Country of origin (GS Partner)
           zzxportdat     TYPE char10, "LIKE ekpo-zzxportdat,    "Ship Date
           zzkunnr        LIKE ekpo-zzkunnr,         "Customer PTO SO account code
           pto_nam        LIKE kna1-name1,           "Ref. Number PTO So account Name
           bstnk          LIKE vbak-bstnk,           "Cust PO #
           zzvgbel        LIKE ekpo-zzvgbel,         "Order No.
           lgort          LIKE ekpo-lgort,           "Ship-to
           j_4kscat       LIKE eket-j_4kscat,
           lbl(3)         TYPE c,                    "(EKET-J_4KSCAT)Label
           maktx          LIKE makt-maktx,           "Material Name
           normt          LIKE mara-normt,           "Color Description
           kposn          TYPE konv-kposn,          "line item "Add Nilakshi_09/11/09
           netpr          TYPE ekpo-netpr,          "FOB price  "Add Nilakshi_09/11/09
           qty_book       LIKE eket-menge,           "Tot Qty Booked
           amnt_book      LIKE ekpo-effwr,          "Tot Amt Booked
           j_3aelikz      LIKE eket-j_3aelikz,
           elikz          LIKE ekpo-elikz,
           meins          LIKE ekpo-meins,          "Unit of Measure LJ20090403
           qty_cnc        LIKE eket-menge,   "Total Canceled(qty booked - qty rcv)
           qty_intra      LIKE ekes-menge,   "Tot Qty In tran
           amnt_intra     LIKE konv-kwert,  "Tot Amt InTran(KWERT/Qty Bkd*Qty intra)
           qty_rcv        LIKE eket-wemng,   "Tot Qty  Rcv
           amnt_rcv       LIKE konv-kwert,   "Tot Amt Rcv (sum KWERT/Qty Booked*QtyRcv)
           qty_wip        LIKE eket-menge,   "WIP Bal (Tot Qty Booked-Tot Qty  Rcv)
           amnt_wip       LIKE konv-kwert,   "WIP Amt (KWERT/Tot Qty Booked*TotQtyWIP)
           qty_var        LIKE eket-menge,   "Var PO vs Shipped WIP Bal-Qty In tran
           loekz          LIKE ekpo-loekz,
           knumv          LIKE ekko-knumv,
           zcmsno         LIKE ekko-zcmsno,
           ihrez          TYPE ekko-ihrez,
           evers          LIKE ekpo-evers,        "Ship Mode/Shipping Instructions.
           evtxt          LIKE t027b-evtxt,       "Ship Mode Text
           zzportentry    LIKE ekpo-zzportentry,  "Port of Entry.
           zzportentry2   LIKE ekko-zzportentry,  "Port of Entry from EKKO LJ24AUG2010.
           stprs          LIKE mbew-stprs,        "Standard Cost.
           vdatu          TYPE char10, "LIKE vbak-vdatu,        "Customer Due Date.
           zzeindt        TYPE char10, "LIKE ekko-zzeindt,      "Arrival Date.
           zzolla         LIKE ekpo-zzolla,       "Port of Exit.
           zzolla2        LIKE ekko-zzolla,       "Port of Exit from EKKO LJ24AUG2010
           gueen          TYPE char10, "LIKE vbak-gueen,     "Customer SO Cancel Date
           prctr          LIKE marc-prctr,        "Profit Center
           volum          LIKE mara-volum,        "Volume
           wip_vol        LIKE eket-menge,        "Total WIP Volume
           tot_ctn        LIKE eket-menge,        " total no of cartons   gajaba 20090819
           unsez          LIKE ekko-unsez,        "Factory No
           aedat          TYPE char10, "LIKE ekko-aedat,        "Purchase Order Creation Date
           ernam          LIKE ekko-ernam,        "Purchase Order Created By
* MahendraP added to get ordering address and invoicing party.
           ord_lifn2      LIKE ekpa-lifn2,           "Ordering Address Code
           ord_name1      LIKE lfa1-name1,           "Ordering Address Name
           pi_lifn2       LIKE ekpa-lifn2,           "Invoicing Partty Code
           pi_name1       LIKE lfa1-name1,           "Invoicing Partty Name
* End of modification.
* chandimaw - 24/05/2012 - freight forwarder
           cr_lifn2       LIKE ekpa-lifn2,           "Freight Forwarder Code
           cr_name1       LIKE lfa1-name1,           "Freight Forwarder Name
           zkunnr         LIKE mara-zzkunnr,      "Customer Number
           zpre_pack_qty  LIKE mara-zpre_pack_qty, "Pre-Pack Quantity
           wrkst          LIKE mara-wrkst,       "PLM Product Number
           bismt          LIKE mara-bismt,       "Style Number
           inco1          LIKE ekko-inco1,        "Incoterms (Part 1)
           submi          LIKE ekko-submi,        "Collective Number
           cost_inco1     LIKE ekpo-inco1,        "Costing inco term - chandimaw - 13/07/2012 - add costing inco term to the report
           zzofferdat     TYPE char10, "LIKE ekpo-zzofferdat,   "Original Delivery date
           zzexfact       TYPE char10, "LIKE ekpo-zzexfact,     "Original Ex factory date
           j_3aexfcm      TYPE char10, "LIKE ekpo-j_3aexfcm,    "AFS Manual Ex Factory Date
           pstyp          LIKE ekpo-pstyp,        "Item Category <-- PJDK925334:24/05/2012:MW
           knttp          LIKE ekpo-knttp,        "Account Assignment Category <-- PJDK925334:24/05/2012:MW
           mvgr1          LIKE mvke-mvgr1,        "Sub Profit Center
           mvgr1_desc     TYPE tvm1t-bezei,       "SPC Description "attSam added on 31.10.2011
           mtpos_mara     LIKE mara-mtpos_mara,   "General item category group
           kbetr          LIKE konv-kbetr,        "Sales Price
           qty_book_pc    LIKE eket-menge,
           qty_cnc_pc     LIKE eket-menge,
           qty_intra_pc   LIKE eket-menge,
           qty_rcv_pc     LIKE eket-menge,
           qty_wip_pc     LIKE eket-menge,
           qty_var_pc     LIKE eket-menge,             " Var. Po Vs shiped
           zznrfdesc      TYPE mara-zznrfdesc,         "NRF Size Description
           zzhanger       TYPE mara-zzhanger,          "attSam added on 31.10.2011
           zzhangerdesc   TYPE zhanger-zzhangerdesc,   "attSam added on 31.10.2011
           j_3apqty       TYPE /afs/mvke-j_3apqty,     "AFS Pack Quantity
           zzolla_desc    TYPE vtadd01t-bezei,         "Description
           zport_desc     TYPE vtadd02t-bezei,         "Port of entry name
           bednr          LIKE ekpo-bednr,             " Added by mahendrap on 2011-03-18.
           afnam          LIKE ekpo-afnam,             " Requisitioner                                         "Added by Sri Ram
           mstae          LIKE  mara-mstae,            "asangad 04112011
           mtstb          LIKE  t141t-mtstb,            "asangad 11112011
           j_3akord1      LIKE  j_3apgen-j_3akord1,
           j_3akord2      LIKE  j_3apgen-j_3akord2,
           msrp           TYPE  konv-kbetr, " J_3AVAST-J_3AFIELD1 - we need it in a currency field - YasanthaJ 17/02/2011 - Ver 17
           waers          LIKE  ekko-waers,    " YasanthaJ 17/02/2011 - Ver 17
           j_3anetp       LIKE  eket-j_3anetp, " YasanthaJ 17/02/2011 - Ver 17
*{  INSERT  PJDK926501  14.08.2012  MP
           menge          TYPE ekpo-menge,
           mtart          TYPE mara-mtart,
           comp_matnr     TYPE zpocomp-matnr,
           comp_j_3asize  TYPE zpocomp-j_3asize,
           comp_netpr     TYPE zpocomp-netpr,
           comp_qty       TYPE zpocomp-menge,
           comp_val       TYPE zpocomp-netpr,
           ccasin         TYPE j_3acustf1,      "Component Chile ASIN
           zzfrsl         TYPE ekko-zzfrsl,     " First Sales Flag
           konwa          TYPE konp-konwa,        "Sales Price Currency
*}  INSERT
           insmk          TYPE ekpo-insmk,         "PJDK928062 26.11.2012  MPf
           ddtext         TYPE dd07t-ddtext,      "PJDK928062 26.11.2012  MP
*{  INSERT  PJDK930237  03.05.2013  NR
           xblnr          TYPE ekes-xblnr,
           erdat          TYPE char10, "TYPE ekes-erdat,
           eindt_s        TYPE char10, "ekes-eindt,
           menge_s        TYPE ekes-menge,
*}  INSERT
           zzngendr       TYPE mara-zzngendr,
           zzngendrtxt    TYPE ztgendr-zzngendrtxt,
           zznaggrp       TYPE mara-zznaggrp,
           zznaggrptxt    TYPE ztaggrp-zznaggrptxt,
           zzngszgp       TYPE mara-zzngszgp,
           zzngszgptxt    TYPE ztgszgp-zzngszgptxt,
           zznseasn       TYPE mara-zznseasn,
           zznseasntxt    TYPE ztseasn-zznseasntxt,
           zyear          TYPE ztseasn-zyear,
           zzsnyrtxt      TYPE ztseasn-zzsnyrtxt,
           zznprdct       TYPE mara-zznprdct,
           zznprdcttxt    TYPE ztprdct-zznprdcttxt,
           zznprdsc       TYPE mara-zznprdsc,
           zznprdsctxt    TYPE ztprdsc-zznprdsctxt,
           zznfabct       TYPE mara-zznfabct,
           zznfabcttxt    TYPE ztfabct-zznfabcttxt,
           zznfabrn       TYPE mara-zznfabrn,        "PIYUSH PAYASI -9999011257
           zznfabrntxt    TYPE ztfabrn-zznfabrntxt,  "PIYUSH PAYASI -9999011257
           zznrpmnt       TYPE mara-zznrpmnt,        "SRIRAM -9999012212
           zzncoltp       TYPE mara-zzncoltp,
           zzncoltptxt    TYPE ztcoltp-zzncoltptxt,
           zzncuftp       TYPE mara-zzncuftp,
           zzncuftptxt    TYPE ztcuftp-zzncuftptxt,
           zznfapyr       TYPE mara-zznfapyr,
           zznfapyrtxt    TYPE ztfapyr-zznfapyrtxt,
           zznsilht       TYPE mara-zznsilht,
           zznsilhttxt    TYPE ztsilht-zznsilhttxt,
           zzncolln       TYPE mara-zzncolln,
           zzncollntxt    TYPE ztcolln-zzncollntxt,
           zznbrand       TYPE mara-zznbrand,
           zznbrandtxt    TYPE ztbrand-zznbrandtxt,
           zznbrgrp       TYPE ztbrgrp-zznbrgrp,
           zznbrgrptxt    TYPE ztbrgrp-zznbrgrptxt,
           zznbrgtp       TYPE ztbrgtp-zznbrgtp,
           zznbrgtptxt    TYPE ztbrgtp-zznbrgtptxt,
           zprdha         TYPE zroyalty-zprdha,
           zzlicdesc      TYPE zroycodes-zzlicdesc,
           zzprdesc       TYPE zroycodes-zzprdesc,
           zznstmth       TYPE mara-zznstmth,
           zznevent       TYPE mara-zznevent,
           zzneventtxt    TYPE ztevent-zzneventtxt,
           custname       TYPE kna1-name1,
           zzdirort       TYPE ekpo-zzdirort,
           mwaer          TYPE t000-mwaer,
           reswk          TYPE ekko-reswk, "Supplying (Issuing) Plant in Stock Transport Order
           kunnr          TYPE ekpv-kunnr, "Customer Number
           vstel          TYPE ekpv-vstel, "Shipping Point/Receiving Point
           ladgr          TYPE ekpv-ladgr, "Loading Group
           reslo          TYPE ekpo-reslo, "Issuing Storage Location for Stock Transport Order
           bsgru          TYPE ekpo-bsgru, " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
           bezei          TYPE bezei40, " + ECDK910055  ( GBGMM-R-048 ) 06.10.2017 HKT
           zzlatecd       TYPE ekpo-zzlatecd,
           zzlatecd1      TYPE ekko-zzlatecd,
           zlatedesc      TYPE zlatecode-zlatedesc,
* BOC by DGHOSAL on 01/09/2018 ticket # 9999020967
           zexempt        TYPE zexempt,
* EOC by DGHOSAL on 01/09/2018 ticket # 9999020967

* BCBG additional fields for Wafai
           ean11          TYPE mean-ean11,
           col_desc_fr    TYPE zzdesc,
           msrpcad        TYPE j_3avast-j_3afield1,
           msrp_compat    TYPE j_3avast-j_3afield1,
           herkl          TYPE mara-herkl,
           zzhanger_po    TYPE ekpo-zzhanger,
* END BCBG
* BOC by DGHOSAL on 4/20/2018 for BCBG
           j_3acol        TYPE j_3acol,
           vkorg          TYPE mvke-vkorg,
* EOC by DGHOSAL on 4/20/2018 for BCBG
           zzfcrdat       TYPE char10, "ekpo-zzfcrdat,
           zzonbdat       TYPE char10, "ekpo-zzonbdat,
           ibd_date       TYPE char10, "bbein,
* BOC by DGHOSAL on 5/21/2018
           ebtyp          TYPE ebtyp, " Confirmation Category
           ebtxt          TYPE ebtxt, " Confirmation Category: Description
           knref          TYPE knref, " Ship-to Partner Description
           kname_sh       TYPE name1, " Ship to name
           dirshp         TYPE zdirlbl, " Direct Ship Label
           pasin          TYPE j_3acustf1, "Parent ASIN
           casin          TYPE j_3acustf1, "Child ASIN
* EOC by DGHOSAL on 5/21/2018
* BOC by PFERNANDO on 7/23/2018
           tot_po_fob     TYPE konv-kwert,
           tot_po_std     TYPE konv-kwert,
* EOC by PFERNANDO on 7/23/2018
* Begin of changes - ECDK915177 - Pio Fernando
           msrp_01        TYPE kbetr,
           msrp_02        TYPE kbetr,
           msrp_03        TYPE kbetr,
           msrp_04        TYPE kbetr,
           msrp_05        TYPE kbetr,
           msrp_06        TYPE kbetr,
           msrp_07        TYPE kbetr,
           msrp_08        TYPE kbetr,
           msrp_09        TYPE kbetr,
           msrp_10        TYPE kbetr,
* End of changes - ECDK915177 - Pio Fernando

           redat          TYPE char10,                      " CH-2052
           frgke          TYPE ekko-frgke,    "" AP 12/06/2020
           eaedat         TYPE char10, "ekpo-aedat, " +ECDK920591 by SQADIR on 6/12/2020
* BoC RUCHIRA : CH-1071 07/21/2021
           zzhts1         TYPE mara-zzhts1,
           zzhts1desc     TYPE mara-zzhts1desc,
* EoC RUCHIRA : CH-1071 07/21/2021

**************************************************************************************
*  Add Fields After MDM Changes : BoC : Ruchira : 28-Oct-2022
**************************************************************************************

* BoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification
           zznopdcl       TYPE mara-zznopdcl,
           zznopdcltxt    TYPE ztopdcl-zznopdcltxt,
* EoC : CH-XXXX :Ruchira:06.01.2021 Add Other Product Classification

* BoC : CH-1778 : Ruchira : 05/09/2022 Add Component UPC
           comp_ean11     TYPE mean-ean11,
* EoC : CH-1778 : Ruchira : 05/09/2022 Add Component UPC

           zznactvt       TYPE mara-zznactvt,
           zznactvtxt     TYPE ztactvt-zznactvtxt,
           zzntheme       TYPE mara-zzntheme,
           zznthemetxt    TYPE zttheme-zznthemetxt,
           zznbkpkd       TYPE mara-zznbkpkd,
           zznbkpkdtxt    TYPE ztbkpkd-zznbkpkdtxt,
           zznbdftn       TYPE mara-zznbdftn,
           zznbdftntxt    TYPE ztbdftn-zznbdftntxt,
           zznbusun       TYPE mara-zznbusun,
           ztbusuntxt     TYPE ztbusun-ztbusuntxt,
           zznchorg       TYPE mara-zznchorg,
           zznchorgtxt    TYPE ztchorg-zznchorgtxt,
           zznchar2       TYPE mara-zznchar2,
           zznchar2txt    TYPE ztchar2-zznchar2txt,
           zznclass       TYPE mara-zznclass,
           zznclasstxt    TYPE ztclass-zznclasstxt,
           zzndenft       TYPE mara-zzndenft,
           zzndenfttxt    TYPE ztdenft-zzndenfttxt,
           zzndepmt       TYPE mara-zzndepmt,
           zzndepmtxt     TYPE ztdepmt-zzndepmtxt,
           zznfabat       TYPE mara-zznfabat,
           zznfabatxt     TYPE ztfabat-zznfabatxt,
           zznfabnm       TYPE mara-zznfabnm,
           zznfabnmtxt    TYPE ztfabnm-zznfabnmtxt,
           zznfabst       TYPE mara-zznfabst,
           zznfabstxt     TYPE ztfabst-zznfabstxt,
           zznftacc       TYPE mara-zznftacc,
           zznftacctxt    TYPE ztftacc-zznftacctxt,
           zznhwtrt       TYPE mara-zznhwtrt,
           zznhwtrttxt    TYPE zthwtrt-zznhwtrttxt,
           zznhemfn       TYPE mara-zznhemfn,
           zznhemfntxt    TYPE zthemfn-zznhemfntxt,
           zznlengt       TYPE mara-zznlengt,
           zznlengtxt     TYPE ztlengt-zznlengtxt,
           zznmettp       TYPE mara-zznmettp,
           zznmettptxt    TYPE ztmettp-zznmettptxt,
           zznpatrn       TYPE mara-zznpatrn,
           zznpatrntxt    TYPE ztpatrn-zznpatrntxt,
           zznpresn       TYPE mara-zznpresn,
           zznpresntxt    TYPE ztpresn-zznpresntxt,
           zznprcpt       TYPE mara-zznprcpt,
           zznprcptxt     TYPE ztprcpt-zznprcptxt,
           zznprdgr       TYPE mara-zznprdgr,
           zznprdgrtxt    TYPE ztprdgr-zznprdgrtxt,
           zznstone       TYPE mara-zznstone,
           zznstonetxt    TYPE ztstone-zznstonetxt,
           zznsclas       TYPE mara-zznsclas,
           zznsclastxt    TYPE ztsclas-zznsclastxt,
           zznwaist       TYPE mara-zznwaist,
           zznwaistxt     TYPE ztwaist-zznwaistxt,
           zznwashy       TYPE mara-zznwashy,
           zznwashytxt    TYPE ztwashy-zznwashytxt,
           zznwashs       TYPE mara-zznwashs,
           zznwashstxt    TYPE ztwashs-zznwashstxt,
           zznwasht       TYPE mara-zznwasht,
           zznwashtxt     TYPE ztwasht-zznwashtxt,
           zznlgopn       TYPE mara-zznlgopn,
           zznlgopntxt    TYPE ztlgopn-zznlgopntxt,
           zznchars       TYPE mara-zznchars,
           zzncharstxt    TYPE ztchars-zzncharstxt,
           zzconstype     TYPE mara-zzconstype,
           zzconstypedesc TYPE zconstype-zzconstypedesc,
*ZZNFABRN TYPE mara-ZZNFABRN,
*ZZNFABRNTXT TYPE ZTFABRN-ZZNFABRNTXT,
*ZZNFAPYR TYPE mara-ZZNFAPYR,
*ZZNFAPYRTXT TYPE ZTFAPYR-ZZNFAPYRTXT,
           zzhlht         TYPE mara-zzhlht,
           zzhlhtdesc     TYPE zhlht-zzhlhtdesc,
*ZZNSTMTH TYPE mara-ZZNSTMTH,
*ZZNSTMTHTXT TYPE ZTSTMTH-ZZNSTMTHTXT,
           zznitplt       TYPE mara-zznitplt,
           zznitplttxt    TYPE ztitplt-zznitplttxt,
           zznnctyp       TYPE mara-zznnctyp,
           zznnctyptxt    TYPE ztnctyp-zznnctyptxt,
           zznsetct       TYPE mara-zznsetct,
           zznsetcttxt    TYPE ztsetct-zznsetcttxt,
*ZZNRPMNT TYPE mara-ZZNRPMNT,
*ZZNRPMNTTXT TYPE ZTRPMNT-ZZNRPMNTTXT,
           zzshaftht      TYPE mara-zzshaftht,
           zzshafthtdesc  TYPE zshaftht-zzshafthtdesc,
           zznslvtp       TYPE mara-zznslvtp,
           zznslvtptxt    TYPE ztslvtp-zznslvtptxt,
           zzstdet        TYPE mara-zzstdet,
           zzstdetdesc    TYPE zstdet-zzstdetdesc,
           zznstfsh       TYPE mara-zznstfsh,
           zznstfshtxt    TYPE ztstfsh-zznstfshtxt,
           zzinvstat      TYPE mara-zzinvstat,
           zzinvdesc      TYPE zinvstatus-zzinvdesc,

*Add AP , 10/11/2022
           offer_date     TYPE char10,
*End Add

*Add AP 31/03/2023
**         ZZLATECD       TYPE ekpo-zzlatecd,  " Add AP 31/03/2023
           spart          LIKE mara-spart,    "Insert ECDK927161-CH-2948-14-Nov-2023
           vtext          TYPE tspat-vtext,        "Insert ECDK927161-CH-2948-14-Nov-2023
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button.
           sonet          TYPE vbap-netpr,    "SO Net Price
           soval          TYPE vbap-netpr,    "SO Value
           delno          TYPE ekes-vbeln,    "Delivery No
           conid          TYPE ekes-xblnr,    "Container ID
           cusst          TYPE char10,        "Customer Start Date
           cusca          TYPE char10,        "Customer Cancel Date
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
           fob_std        TYPE ck_twt,          "FOB XB00 (Std.)
           freight_po     TYPE ck_twt,          "Freight XR01( PO)
           freight_std    TYPE ck_twt,          "Freight XR01( Std.)
           markup_po      TYPE ck_twt,          "Mark-Up,XCOM(PO)
           markup_std     TYPE ck_twt,          "Mark-Up,XCOM(Std.)
           markup_po_per  TYPE konv-kbetr,      "Mark-Up, XCOM (PO)%   Added By SriRam  11/06/2015
           markup_std_per TYPE konv-kbetr,      " Mar-Up, XCOM(Std.)% - Added By SriRam  11/06/2015
           duty_po        TYPE ck_twt,          "Duty, XDTY (PO)
           duty_std       TYPE ck_twt,          "Duty, XDTY (Std.)
           duty_var_svp   TYPE ck_twt,          "Duty Var. (Std vs PO)
           misc_po        TYPE ck_twt,          "Miscellaneous, XMSC (PO)
           misc_std       TYPE ck_twt,          "Miscellaneous, XMSC (Std.)
           others_po      TYPE ck_twt,          "Others, XOTH (PO)
           others_std     TYPE ck_twt,          "Others, XOTH (Std.)
           drayage_po     TYPE ck_twt,          "Drayage XDRY (PO)
           drayage_std    TYPE ck_twt,          "Drayage XDRY (Std.)
           tot_po_prc     TYPE ck_twt,          "Total PO Price per UOM
           fob_po         TYPE ck_twt,          "FOB XB00 (PO)
           tot_stdprc     TYPE ck_twt,          "Total Standard Price
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.

**************************************************************************************
*  Add Fields After MDM Changes : EoC : Ruchira : 28-Oct-2022
**************************************************************************************
         END OF lt_data.


  DATA: lwa_data    TYPE lt_data,
        li_data_mat TYPE TABLE OF lt_data.

  lv_date    = sy-datum - 7 . """Assume current date is Monday
  CALL FUNCTION 'DATE_GET_WEEK'
    EXPORTING
      date = lv_date
    IMPORTING
      week = lv_week.
*"----------------Begin of Change-CH-2451-ECDK92622027-Apr-2023----------------------
  IF p_check EQ 'X'.
    CONCATENATE p_file 'ZPORPT_'  sy-datum '_' sy-uzeit '_' v_var  '.csv' INTO p_file.
  ELSE.
*"--------------------  End of Change-CH-2451-ECDK92622027-Apr-2023--------------------
    IF p_d_only = 'X'.
      CONCATENATE p_file 'PO_SNAPSHOT_DEL_'  lv_week+4(2) lv_week(4)  '.csv' INTO p_file.
    ELSE.
      CONCATENATE p_file 'PO_SNAPSHOT_'  lv_week+4(2) lv_week(4) '.csv' INTO p_file.
    ENDIF.
  ENDIF.


  FIELD-SYMBOLS:<fs_tab> TYPE table.
  FIELD-SYMBOLS:<fs_line> TYPE any.
  FIELD-SYMBOLS:<fs_t> TYPE any.
  FIELD-SYMBOLS:<fs_s> TYPE any.
  FIELD-SYMBOLS:<fs_dt> TYPE char10.

*fieldcatalog_tab
*Move slis fcat to lvc
  LOOP AT i_fieldcatalog INTO ls_fieldcat_slis.
    MOVE-CORRESPONDING ls_fieldcat_slis TO  ls_lfieldcat_1.
    IF ls_lfieldcat_1-fieldname = 'AEDAT'.
      ls_lfieldcat_1-datatype = 'CHAR'.
      ls_lfieldcat_1-inttype = 'C'.
    ENDIF.
    APPEND  ls_lfieldcat_1 TO lt_lfieldcat_1.
  ENDLOOP.

  LOOP AT i_data_mat INTO wa_data.
    MOVE-CORRESPONDING wa_data TO lwa_data.
    APPEND lwa_data TO li_data_mat.
    CLEAR lwa_data.
  ENDLOOP.

*Get var. with lvc fcat
  CALL FUNCTION 'LVC_VARIANT_SELECT'
    EXPORTING
      i_dialog            = ' '
      i_user_specific     = 'X'
      i_default           = 'X'
      it_default_fieldcat = lt_lfieldcat_1
    IMPORTING
      et_fieldcat         = lt_lfieldcat
    CHANGING
      cs_variant          = v_x_variant.

  DELETE lt_lfieldcat WHERE no_out = 'X'.
  DELETE lt_lfieldcat WHERE tech = 'X'.



*Get output with selected layout in to internal table
  CALL METHOD cl_alv_table_create=>create_dynamic_table
    EXPORTING
      it_fieldcatalog = lt_lfieldcat
    IMPORTING
      ep_table        = dy_table.

  ASSIGN dy_table->* TO <fs_tab>.
  IF <fs_tab> IS ASSIGNED.
    CREATE DATA dy_line LIKE LINE OF <fs_tab>.
    ASSIGN dy_line->* TO <fs_line>.
  ENDIF.

*  LOOP AT i_data_mat INTO wa_data.
  LOOP AT li_data_mat INTO lwa_data.
    LOOP AT lt_lfieldcat INTO ls_fieldcat.
      ASSIGN COMPONENT ls_fieldcat-fieldname
                      OF STRUCTURE <fs_line> TO <fs_t>.
      IF sy-subrc = 0.
        ASSIGN COMPONENT ls_fieldcat-fieldname
                    OF STRUCTURE lwa_data TO <fs_s>.
        IF sy-subrc = 0.
*Remove ','
          CLEAR lv_field.
          DESCRIBE FIELD <fs_s> TYPE  lv_field.
          IF lv_field = 'C'. "" Only the Charater filed
            REPLACE ALL  OCCURRENCES OF ','  IN <fs_s>  WITH ''.
          ENDIF.
*--Change Date Format
*-- Begin of insert - ECDK920602


          IF ls_fieldcat-fieldname = 'EINDT' OR
          ls_fieldcat-fieldname = 'ZZEINDT' OR
          ls_fieldcat-fieldname = 'EINDT_S' OR
          ls_fieldcat-fieldname = 'ZZXPORTDAT' OR
          ls_fieldcat-fieldname = 'VDATU' OR
          ls_fieldcat-fieldname = 'GUEEN' OR
          ls_fieldcat-fieldname = 'AEDAT' OR
          ls_fieldcat-fieldname = 'ZZOFFERDAT' OR
          ls_fieldcat-fieldname = 'ZZEXFACT' OR
          ls_fieldcat-fieldname = 'J_3AEXFCM' OR
          ls_fieldcat-fieldname = 'ERDAT' OR
          ls_fieldcat-fieldname = 'ZZFCRDAT' OR
          ls_fieldcat-fieldname = 'ZZONBDAT' OR
          ls_fieldcat-fieldname = 'IBD_DATE' OR
          ls_fieldcat-fieldname = 'EAEDAT'   OR
          ls_fieldcat-fieldname = 'REDAT'   OR
          ls_fieldcat-fieldname = 'OFFER_DATE'.


            CONCATENATE <fs_s>+4(2) '/' <fs_s>+6(2) '/' <fs_s>(4) INTO <fs_s>.

          ENDIF.
*-- End of insert - ECDK920602
          <fs_t> = <fs_s>.
        ENDIF.
      ENDIF.
    ENDLOOP.
    APPEND <fs_line> TO <fs_tab>.
  ENDLOOP.



*Get Alv grid col. header description
  SORT i_fieldcatalog  BY fieldname.
  SORT lt_lfieldcat BY col_pos.
  LOOP AT   lt_lfieldcat INTO ls_fieldcat.
    READ TABLE i_fieldcatalog INTO ls_fieldcat_slis  WITH  KEY fieldname  = ls_fieldcat-fieldname BINARY SEARCH.
    IF sy-subrc = 0.
      IF ls_fieldcat_slis-seltext_l IS NOT INITIAL.
        ls_col_h-col_heder = ls_fieldcat_slis-seltext_l.
      ELSE.
        ls_col_h-col_heder = ls_fieldcat_slis-seltext_m.
      ENDIF.
      APPEND ls_col_h TO lt_col_h.
    ENDIF.
  ENDLOOP.


*Header setup in to one col.
  LOOP AT lt_col_h INTO ls_col_h.
    IF sy-tabix = 1.
      MOVE ls_col_h-col_heder TO lv_header.
    ELSE.
      CONCATENATE  lv_header ',' ls_col_h-col_heder   INTO lv_header.
    ENDIF.
  ENDLOOP.


* Converting the output internal table data into Text  format with ','
  CALL FUNCTION 'SAP_CONVERT_TO_TEX_FORMAT'
    EXPORTING
      i_field_seperator    = ','
    TABLES
      i_tab_sap_data       = <fs_tab>
    CHANGING
      i_tab_converted_data = lt_csv_format
    EXCEPTIONS
      conversion_failed    = 1
      OTHERS               = 2.
  IF sy-subrc <> 0.
* Implement suitable error handling here
  ENDIF.

  lv_filename = p_file.

*Transfer data to App. server as as a . csv file
  OPEN DATASET lv_filename  FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
  TRANSFER lv_header TO lv_filename.

  LOOP AT lt_csv_format INTO ls_csv_format.
    TRANSFER ls_csv_format TO lv_filename.
  ENDLOOP.

  WRITE:/ 'The file has been downloaded at: ', lv_filename.
  CLOSE DATASET lv_filename.



ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  F_F4_FOR_PO_TYPE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM f_f4_for_po_type .

  SELECT zdirort,zdirordes FROM zdirshpval
  INTO TABLE @DATA(it_zdirshpval). "S_ZDIORT-low

  CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      retfield    = 'ZDIRORT'
      dynpprog    = sy-repid
      dynpnr      = sy-dynnr
      dynprofield = 'S_ZDIORT-LOW'
      value_org   = 'S'
    TABLES
      value_tab   = it_zdirshpval.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  FETCH_BOOKING_DATES
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM fetch_booking_dates .

  DATA(li_data) = i_data[].

  SORT li_data BY ebeln ebelp.
  DELETE ADJACENT DUPLICATES FROM li_data COMPARING ebeln ebelp.
  IF li_data IS NOT INITIAL.
    CLEAR gi_bkdates.
    SELECT ebeln, ebelp, etens, ebtyp ,eindt , erdat, xblnr,
    vbeln "CH-3155-315873-ECDK927707-New fields in purchase order status radio button
    FROM ekes INTO CORRESPONDING FIELDS OF TABLE @gi_bkdates
    FOR ALL ENTRIES IN @li_data
    WHERE ebeln = @li_data-ebeln  AND
          ebelp = @li_data-ebelp  AND
    ( ebtyp EQ 'AB' OR ebtyp EQ 'PB' OR ebtyp EQ 'LA' ).
  ENDIF.

ENDFORM.
*BoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
*&---------------------------------------------------------------------*
*&      Form  FETCH_BOOKING_DATES
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM so_delivery_details .

  DATA(li_data) = i_data[].

  SORT li_data BY ebeln ebelp.
  DELETE ADJACENT DUPLICATES FROM li_data COMPARING ebeln ebelp.
  IF li_data IS NOT INITIAL.
    CLEAR gi_ekkn.
    SELECT ebeln, ebelp, vbeln, vbelp
    FROM ekkn INTO CORRESPONDING FIELDS OF TABLE @gi_ekkn
    FOR ALL ENTRIES IN @li_data
    WHERE ebeln = @li_data-ebeln  AND
          ebelp = @li_data-ebelp.
    IF sy-subrc EQ 0 AND gi_ekkn IS NOT INITIAL.
*Fetch SO Net price
      CLEAR gi_sonet.
      SELECT vbeln, posnr, netpr
      FROM vbap INTO CORRESPONDING FIELDS OF TABLE @gi_sonet
      FOR ALL ENTRIES IN @gi_ekkn
      WHERE vbeln = @gi_ekkn-vbeln  AND
            posnr = @gi_ekkn-vbelp.
    ENDIF.
  ENDIF.

ENDFORM.
*EoA-CH-3155-315873-ECDK927707-New fields in purchase order status radio button
*&---------------------------------------------------------------------*
*&      Form  BUILD_LAYOUT_POANS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM build_layout_poans .

  wa_layout-no_input          = 'X'.
*  wa_layout-colwidth_optimize = 'X'.
*  wa_layout-expand_all        = 'X'.
  wa_layout-window_titlebar   = 'PO Changes Analysis' .
  wa_layout-totals_text       = 'Totals'.
  wa_layout-zebra             = 'X'.


ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  BUILD_FIELD_CATALOG_POANS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM build_field_catalog_poans .

  DATA colno TYPE i.
  CLEAR colno.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'UDATE'.
  i_fieldcatalog-seltext_l   = 'Changed Date'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'BUKRS'.
  i_fieldcatalog-seltext_m   = 'Plant'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '04'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EBELN'.
  i_fieldcatalog-seltext_l   = 'PO Number'.      "Modified
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'EBELP'.
  i_fieldcatalog-seltext_l   = 'Line Item'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '05'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'MATNR'.
  i_fieldcatalog-seltext_l   = 'Material Number'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '18'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'ETENR'.
  i_fieldcatalog-seltext_l   = 'Shedule Line Item'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '04'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'USERNAME'.
  i_fieldcatalog-seltext_l   = 'User Name'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'FNAME'.
  i_fieldcatalog-seltext_l   = 'Change Fileds'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'FTEXT'.
  i_fieldcatalog-seltext_l   = 'Field Description'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '25'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.


  i_fieldcatalog-fieldname   = 'CHNGIND'.
  i_fieldcatalog-seltext_l   = 'Change Id'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'F_OLD'.
  i_fieldcatalog-seltext_l   = 'Old Value'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

  i_fieldcatalog-fieldname   = 'F_NEW'.
  i_fieldcatalog-seltext_l   = 'New Value'.
  i_fieldcatalog-col_pos     = colno.
  i_fieldcatalog-outputlen   = '10'.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
  ADD 1 TO colno.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  BUILD_SORTCAT_POANS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM build_sortcat_poans .

  DATA colno1 TYPE i.
  CLEAR colno1.
  ADD 1 TO colno1.

  wa_sort-spos      = colno1.
  wa_sort-fieldname = 'BUKRS'.
  wa_sort-up        = 'X'.
  wa_sort-subtot    = 'X'.
  APPEND wa_sort TO i_sortcat.
  ADD 1 TO colno1.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_REPORT_POANS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM display_alv_report_poans .

  DATA : lv_save(1) VALUE 'A'.
  v_repid = sy-repid.
**Avoid column truncating in report printing
*  wa_grid_set-no_colwopt = 'X'.
  AUTHORITY-CHECK OBJECT 'S_ALV_LAYO'
             ID 'ACTVT' FIELD '23'.

  IF sy-subrc NE 0.
    lv_save = 'U'.
  ENDIF.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      i_callback_program      = v_repid
      is_layout               = wa_layout
      it_fieldcat             = i_fieldcatalog[]
      i_callback_user_command = 'USER_COMMAND'
      it_sort                 = i_sortcat
      i_grid_settings         = wa_grid_set
      i_grid_title            = 'PO Changes Analysis'
      i_save                  = lv_save
      is_variant              = v_variant
    TABLES
      t_outtab                = gt_itab
    EXCEPTIONS
      program_error           = 1
      OTHERS                  = 2.

  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_PO_CHANGES
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_po_changes .

  DATA: BEGIN OF icdhdr OCCURS 50.
          INCLUDE STRUCTURE cdhdr.
  DATA: END OF icdhdr.

  DATA: BEGIN OF icdshw OCCURS 50.
          INCLUDE STRUCTURE cdshw.
  DATA: END OF icdshw.

  DATA: BEGIN OF itab OCCURS 50,
          BEGIN OF ekkey,
            ebeln LIKE eket-ebeln,
            ebelp LIKE eket-ebelp,
            matnr LIKE ekpo-matnr, " Add AP 12/09/2022
            etenr LIKE eket-etenr,
          END OF ekkey,
          bukrs    LIKE ekko-bukrs,
          changenr LIKE cdhdr-changenr,
          udate    LIKE cdhdr-udate,
          utime    LIKE cdhdr-utime,
          username LIKE cdhdr-username,
          chngind  LIKE cdshw-chngind,
          ftext    LIKE cdshw-ftext,
          outlen   LIKE cdshw-outlen,
          fname    LIKE cdshw-fname,
          f_old    LIKE cdshw-f_old,
          f_new    LIKE cdshw-f_new,
        END OF itab.

  SELECT a~ebeln , a~aedat,a~bukrs "" b~matnr
    FROM ekko AS a  ""INNER JOIN  ekpo AS b ON a~ebeln = b~ebeln
     INTO TABLE @DATA(lt_ekko)

     WHERE a~ebeln IN @s1_ebeln AND
     a~bukrs IN @s1_werks AND
     a~aedat IN @s1_date.""  AND"" Po Creation date
**     b~matnr IN @sl_matnr.



*  SELECT * FROM ekko WHERE ebeln IN s1_ebeln AND
*                           bukrs IN s1_werks.
  LOOP AT lt_ekko INTO DATA(ls_ekko).
    CLEAR cdhdr.
**    CLEAR cdpos.
    cdhdr-objectclas = 'EINKBELEG'.
    cdhdr-objectid   = ls_ekko-ebeln.


    CALL FUNCTION 'CHANGEDOCUMENT_READ_HEADERS'
      EXPORTING
        date_of_change    = cdhdr-udate
        objectclass       = cdhdr-objectclas
        objectid          = cdhdr-objectid
        time_of_change    = cdhdr-utime
        username          = cdhdr-username
      TABLES
        i_cdhdr           = icdhdr
      EXCEPTIONS
        no_position_found = 1
        OTHERS            = 2.

    CHECK sy-subrc EQ 0.
    DELETE icdhdr WHERE change_ind EQ 'I'.
    CHECK NOT icdhdr[] IS INITIAL.
    LOOP AT icdhdr.
      CHECK icdhdr-username IN s1_user.
      CALL FUNCTION 'CHANGEDOCUMENT_READ_POSITIONS'
        EXPORTING
          changenumber      = icdhdr-changenr
        IMPORTING
          header            = cdhdr
        TABLES
          editpos           = icdshw
        EXCEPTIONS
          no_position_found = 1
          OTHERS            = 2.
      CHECK sy-subrc EQ 0.
      LOOP AT icdshw.
**      WHERE  FNAME = 'ZZJ_3AEXFCM' OR
**                          FNAME = 'MENGE'.
        CHECK icdshw-text_case EQ space.
        MOVE-CORRESPONDING icdshw TO itab.
        MOVE-CORRESPONDING icdhdr TO itab.
        MOVE icdshw-tabkey+3 TO itab-ekkey.
        MOVE ls_ekko-bukrs TO itab-bukrs.
        APPEND itab.
      ENDLOOP.
    ENDLOOP.

  ENDLOOP.

  LOOP AT itab.

    CLEAR gs_itab.
    MOVE-CORRESPONDING itab TO gs_itab.
    gs_itab-ebeln = itab-ekkey-ebeln.
    gs_itab-ebelp = itab-ekkey-ebelp.
    gs_itab-etenr = itab-ekkey-etenr.

    SELECT SINGLE matnr INTO gs_itab-matnr  FROM ekpo WHERE ebeln = gs_itab-ebeln AND ebelp =  gs_itab-ebelp.
    CHECK gs_itab-matnr IN sl_matnr.
    APPEND gs_itab TO gt_itab.

  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  LOAD_FORMAT_POANS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM load_format_poans .

  TYPES: BEGIN OF ty_col_h,
           col_heder(50) TYPE c,
         END OF ty_col_h.
  DATA: lt_col_h TYPE STANDARD TABLE OF ty_col_h,
        ls_col_h TYPE ty_col_h.

  DATA: lt_lfieldcat     TYPE  lvc_t_fcat,
        ls_fieldcat      TYPE  lvc_s_fcat,
        lt_lfieldcat_1   TYPE  lvc_t_fcat,
        ls_lfieldcat_1   TYPE  lvc_s_fcat,
        ls_fieldcat_slis TYPE  slis_fieldcat_alv,
        dy_table         TYPE REF TO data,
        dy_line          TYPE REF TO data,


        lt_csv_format    TYPE truxs_t_text_data,
        ls_csv_format    LIKE LINE OF lt_csv_format,
        lv_header(4080)  TYPE c,
        lv_field         TYPE c,
        lv_filename      TYPE string.



*-- Date format settings

  TYPES: BEGIN OF lt_data,
           bukrs     LIKE ekko-bukrs,
           ebeln     LIKE eket-ebeln,
           ebelp     LIKE eket-ebelp,
           etenr     LIKE eket-etenr,
           changenr  LIKE cdhdr-changenr,
           udate(10) TYPE c, "" cdhdr-udate,
           utime     LIKE cdhdr-utime,
           username  LIKE cdhdr-username,
           chngind   LIKE cdshw-chngind,
           ftext     LIKE cdshw-ftext,
           outlen    LIKE cdshw-outlen,
           fname     LIKE cdshw-fname,
           f_old     LIKE cdshw-f_old,
           f_new     LIKE cdshw-f_new,

         END OF lt_data.


  DATA: lwa_data      TYPE lt_data,
        li_data_poans TYPE TABLE OF lt_data.



  CONCATENATE p_file 'PO_Changes_Analysis_' sy-datum sy-uzeit '_' sy-slset '.csv' INTO p_file.

  FIELD-SYMBOLS:<fs_tab> TYPE table.
  FIELD-SYMBOLS:<fs_line> TYPE any.
  FIELD-SYMBOLS:<fs_t> TYPE any.
  FIELD-SYMBOLS:<fs_s> TYPE any.
  FIELD-SYMBOLS:<fs_dt> TYPE char10.

*fieldcatalog_tab
*Move slis fcat to lvc
  LOOP AT i_fieldcatalog INTO ls_fieldcat_slis.
    MOVE-CORRESPONDING ls_fieldcat_slis TO  ls_lfieldcat_1.
    IF ls_lfieldcat_1-fieldname = 'UDATE'.
      ls_lfieldcat_1-datatype = 'CHAR'.
      ls_lfieldcat_1-inttype = 'C'.
    ENDIF.
    APPEND  ls_lfieldcat_1 TO lt_lfieldcat_1.
  ENDLOOP.

  LOOP AT gt_itab INTO gs_itab.
    MOVE-CORRESPONDING gs_itab TO lwa_data.
    APPEND lwa_data TO li_data_poans.
    CLEAR lwa_data.
  ENDLOOP.

*Get var. with lvc fcat
  CALL FUNCTION 'LVC_VARIANT_SELECT'
    EXPORTING
      i_dialog            = ' '
      i_user_specific     = 'X'
      i_default           = 'X'
      it_default_fieldcat = lt_lfieldcat_1
    IMPORTING
      et_fieldcat         = lt_lfieldcat
    CHANGING
      cs_variant          = v_x_variant.

  DELETE lt_lfieldcat WHERE no_out = 'X'.
  DELETE lt_lfieldcat WHERE tech = 'X'.

*Get output with selected layout in to internal table
  CALL METHOD cl_alv_table_create=>create_dynamic_table
    EXPORTING
      it_fieldcatalog = lt_lfieldcat
    IMPORTING
      ep_table        = dy_table.

  ASSIGN dy_table->* TO <fs_tab>.
  IF <fs_tab> IS ASSIGNED.
    CREATE DATA dy_line LIKE LINE OF <fs_tab>.
    ASSIGN dy_line->* TO <fs_line>.
  ENDIF.

*  LOOP AT i_data_mat INTO wa_data.
  LOOP AT li_data_poans INTO lwa_data.
    LOOP AT lt_lfieldcat INTO ls_fieldcat.
      ASSIGN COMPONENT ls_fieldcat-fieldname
                      OF STRUCTURE <fs_line> TO <fs_t>.
      IF sy-subrc = 0.
        ASSIGN COMPONENT ls_fieldcat-fieldname
                    OF STRUCTURE lwa_data TO <fs_s>.
        IF sy-subrc = 0.
*Remove ','
          CLEAR lv_field.
          DESCRIBE FIELD <fs_s> TYPE  lv_field.
          IF lv_field = 'C'. "" Only the Charater filed
            REPLACE ALL  OCCURRENCES OF ','  IN <fs_s>  WITH ''.
          ENDIF.
*--Change Date Format
          IF ls_fieldcat-fieldname = 'UDATE'.
            CONCATENATE <fs_s>+4(2) '/' <fs_s>+6(2) '/' <fs_s>(4) INTO <fs_s>.
          ENDIF.
          <fs_t> = <fs_s>.
        ENDIF.
      ENDIF.
    ENDLOOP.
    APPEND <fs_line> TO <fs_tab>.
  ENDLOOP.


*Get Alv grid col. header description
  SORT i_fieldcatalog  BY fieldname.
  SORT lt_lfieldcat BY col_pos.
  LOOP AT   lt_lfieldcat INTO ls_fieldcat.
    READ TABLE i_fieldcatalog INTO ls_fieldcat_slis  WITH  KEY fieldname  = ls_fieldcat-fieldname BINARY SEARCH.
    IF sy-subrc = 0.
      IF ls_fieldcat_slis-seltext_l IS NOT INITIAL.
        ls_col_h-col_heder = ls_fieldcat_slis-seltext_l.
      ELSE.
        ls_col_h-col_heder = ls_fieldcat_slis-seltext_m.
      ENDIF.
      APPEND ls_col_h TO lt_col_h.
    ENDIF.
  ENDLOOP.


*Header setup in to one col.
  LOOP AT lt_col_h INTO ls_col_h.
    IF sy-tabix = 1.
      MOVE ls_col_h-col_heder TO lv_header.
    ELSE.
      CONCATENATE  lv_header ',' ls_col_h-col_heder   INTO lv_header.
    ENDIF.
  ENDLOOP.


* Converting the output internal table data into Text  format with ','
  CALL FUNCTION 'SAP_CONVERT_TO_TEX_FORMAT'
    EXPORTING
      i_field_seperator    = ','
    TABLES
      i_tab_sap_data       = <fs_tab>
    CHANGING
      i_tab_converted_data = lt_csv_format
    EXCEPTIONS
      conversion_failed    = 1
      OTHERS               = 2.
  IF sy-subrc <> 0.
* Implement suitable error handling here
  ENDIF.

  lv_filename = p_file.

*Transfer data to App. server as as a . csv file
  OPEN DATASET lv_filename  FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
  TRANSFER lv_header TO lv_filename.

  LOOP AT lt_csv_format INTO ls_csv_format.
    TRANSFER ls_csv_format TO lv_filename.
  ENDLOOP.

  WRITE:/ 'The file has been downloaded at: ', lv_filename.
  CLOSE DATASET lv_filename.

ENDFORM.
*BoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
*&---------------------------------------------------------------------*
*&      Form  F_MERGE_POSTATUS_POCOSTPRICE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM f_merge_postatus_pocostprice.

  DATA:lt_final     TYPE STANDARD TABLE OF t_final.

* Import calculated fields from ZMM_COST_VARIANCE only when P_POLAC radio button is selected.
  IMPORT lt_final FROM MEMORY ID 'IT_FINAL'.
  IF lt_final IS NOT INITIAL.
    LOOP AT i_data_mat ASSIGNING FIELD-SYMBOL(<fs_data_mat>).
      READ TABLE lt_final ASSIGNING FIELD-SYMBOL(<fs_final>)
                          WITH KEY ebeln = <fs_data_mat>-ebeln
                                   ebelp = <fs_data_mat>-ebelp.
      IF sy-subrc EQ 0.
        <fs_data_mat>-fob_std        = <fs_final>-fob_std. "FOB XB00 (STD.)
        <fs_data_mat>-freight_po     = <fs_final>-freight_po. "Freight XR01(PO)
        <fs_data_mat>-freight_std    = <fs_final>-freight_std. "Freight XR01(Std.)
        <fs_data_mat>-markup_po      = <fs_final>-markup_po. "Mark-Up,XCOM(PO)
        <fs_data_mat>-markup_std     = <fs_final>-markup_std. "Mark-Up,XCOM(Std.)
        <fs_data_mat>-markup_po_per  = <fs_final>-markup_po_per. "Mark-Up XCOM(PO)%
        <fs_data_mat>-markup_std_per = <fs_final>-markup_std_per. "Mark-Up XCOM(Std.)%
        <fs_data_mat>-duty_po        = <fs_final>-duty_po. "DUTY (PO)
        <fs_data_mat>-duty_std       = <fs_final>-duty_std. "DUTY (Std.)
        <fs_data_mat>-duty_var_svp   = <fs_final>-duty_var_svp. "Duty Var. (Std vs PO)
        <fs_data_mat>-misc_po        = <fs_final>-misc_po. "Miscellaneous (PO)
        <fs_data_mat>-misc_std       = <fs_final>-misc_std. "Miscellaneous (Std.)
        <fs_data_mat>-others_po      = <fs_final>-others_po. "Others XOTH (PO)
        <fs_data_mat>-others_std     = <fs_final>-others_std. "Others XOTH (Std.)
        <fs_data_mat>-drayage_po     = <fs_final>-drayage_po. "Drayage  XDRY (PO)
        <fs_data_mat>-drayage_std    = <fs_final>-drayage_std. "Drayage  XDRY (Std.)
        <fs_data_mat>-tot_po_prc     = <fs_final>-tot_po_prc. "Total PO Price per UOM
        <fs_data_mat>-fob_po         = <fs_final>-fob_po.     "FOB XB00 (PO)
        <fs_data_mat>-tot_stdprc     = <fs_final>-tot_stdprc.   "Total Standard Price
      ENDIF.
    ENDLOOP.
  ENDIF.
  FREE MEMORY ID 'IT_FINAL'.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  build_alvfield
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_0104   text
*      -->P_TEXT_001  text
*      -->P_15     text
*      -->P_0107   text
*      -->P_0108   text
*      -->P_0109   text
*----------------------------------------------------------------------*
FORM build_alvfield  USING    fieldname TYPE any
                              p_text TYPE any
                              outlen TYPE any
                              hotspot TYPE any
                              do_sum TYPE any
                              set_decimals TYPE any.
*                              p_noout TYPE any.


  i_fieldcatalog-fieldname   = fieldname.
  i_fieldcatalog-seltext_l   = p_text.
*  wa_fieldcatalog-col_pos     = gv_pos.
  i_fieldcatalog-outputlen   = outlen.
  i_fieldcatalog-hotspot     = hotspot.
  i_fieldcatalog-do_sum      = do_sum.
*  wa_fieldcatalog-no_out      = p_noout.
  IF set_decimals = '000000'.
    i_fieldcatalog-decimals_out = set_decimals.
  ENDIF.
  APPEND i_fieldcatalog TO i_fieldcatalog.
  CLEAR  i_fieldcatalog.
*  gv_pos = gv_pos + 1.

ENDFORM.                    " build_alvfield
*EoA-CH-3245-ECDK927942-315873-Added Po landed cost logic.
